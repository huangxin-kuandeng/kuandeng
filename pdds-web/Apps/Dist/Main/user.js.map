{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./Apps/Dist/Js/disease_analyse.js","webpack:///./Apps/Dist/Js/disease_centre.js","webpack:///./Apps/Dist/Js/disease_cesium.js","webpack:///./Apps/Dist/Js/disease_data_other.js","webpack:///./Apps/Dist/Js/disease_group.js","webpack:///./Apps/Dist/Js/disease_info.js","webpack:///./Apps/Dist/Js/disease_init.js","webpack:///./Apps/Dist/Js/disease_leaflet.js","webpack:///./Apps/Dist/Js/disease_list.js","webpack:///./Apps/Dist/Js/disease_main_map.js","webpack:///./Apps/Dist/Js/disease_player.js","webpack:///./Apps/Dist/Js/disease_road_analyse.js","webpack:///./Apps/Dist/Js/disease_road_link.js","webpack:///./Apps/Dist/Js/disease_screen.js","webpack:///./Apps/Dist/Js/disease_slide.js","webpack:///./Apps/Dist/Js/disease_swiper.js","webpack:///./Apps/Dist/Js/disease_user.js","webpack:///./Apps/Dist/Js/event_emitter.js","webpack:///./Apps/Dist/Js/get_show_polygon.js","webpack:///./Apps/Dist/Js/leftOrthograph/addLayers.js","webpack:///./Apps/Dist/Js/leftOrthograph/map_init.js","webpack:///./Apps/Dist/Js/map_init.js","webpack:///./Apps/Dist/Js/play_window/cesium_player.js","webpack:///./Apps/Dist/Js/user_config.js"],"names":[],"mappings":";QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAI2B;AAGE;;AAE7B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,IAAI;AACJ,eAAe,QAAQ,eAAe,KAAK,IAAI,OAAO;AACtD;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,eAAe;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA;AACA,kBAAkB,UAAU,EAAE,OAAO,EAAE,WAAW;AAClD;AACA;AACA,QAAQ;AACR;AACA,YAAY,uDAAuD;AACnE;AACA;;AAEA,QAAQ;AACR;AACA,sBAAsB,0BAA0B,EAAE,kCAAkC,mBAAmB,4CAA4C,KAAK,4CAA4C;AACpM,sBAAsB,SAAS,mBAAmB,yDAAyD,IAAI,wDAAwD;AACvK;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAKE;;;;;;;;;;;;;AC3JF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI2B;AAGA;AAGA;AAGA;AAGQ;AAGF;AAGH;AAGD;AAGA;AAGE;;AAE/B;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC,mEAAe;AAChB;AACA;;AAEA;AACA;AACA,GAAG,mEAAe;AAClB,GAAG;AACH,GAAG,6EAAoB;AACvB,GAAG;AACH,GAAG,iEAAU;AACb;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,oBAAoB,UAAU,gEAAgE;;AAE9F;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA,QAAQ,kBAAkB;AAC1B;AACA,KAAK;AACL,6CAA6C,KAAK;AAClD,qBAAqB,KAAK;AAC1B,0CAA0C,OAAO,IAAI,OAAO;AAC5D;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA,uCAAuC,QAAQ;AAC/C,yCAAyC,QAAQ,UAAU,KAAK,eAAe,KAAK,eAAe,QAAQ;AAC3G;AACA,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA,KAAK;AACL,iBAAiB,OAAO;AACxB;AACA,2EAA2E,OAAO;AAClF,gEAAgE,OAAO;AACvE;AACA,eAAe,OAAO;AACtB;AACA;AACA,OAAO;AACP;AACA;AACA,wCAAwC,QAAQ,eAAe,OAAO;AACtE;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,uCAAuC,QAAQ,eAAe,OAAO;AACrE;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,qCAAqC,uBAAuB;AAC5D;AACA,aAAa,uBAAuB;AACpC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,aAAa,kBAAkB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,SAAS;AAC3C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA,kCAAkC,SAAS,WAAW,uBAAuB;AAC7E;AACA,cAAc,uBAAuB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,kBAAkB;AAC/B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG,6EAAoB;AACvB,GAAG;AACH,GAAG,mEAAe;AAClB,GAAG;AACH,GAAG,iEAAU;AACb;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH,GAAG,6EAAoB;AACvB;;AAEA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA,EAAE,mEAAe;;AAEjB,EAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAc,kBAAkB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,GAAG,6EAAoB;AACvB,GAAG;AACH,GAAG,mEAAe;AAClB,GAAG;AACH,GAAG,iEAAU;AACb;;AAEA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA,aAAa,4BAA4B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,6EAA6E;AAC7E;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,oDAAoD;AACpD;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,0BAA0B,UAAU;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA,aAAa,uBAAuB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,cAAc,kBAAkB;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK,6DAAY;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,6DAAY;AACtB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;;AAGA,eAAe,gBAAgB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,gGAAgG;AAChG;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,WAAW;AACzC;AACA,mDAAmD,WAAW;AAC9D;AACA,iDAAiD,YAAY,gBAAgB,YAAY;AACzF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,aAAa,gEAAW;;AAExB,CAAC,iEAAc;AACf;AACA;AACA;AACA,CAAC,6DAAY;;AAEb,CAAC,6DAAY;;AAEb;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,iEAAc;AACf;AACA;AACA,EAAE,iEAAc;AAChB;AACA;AACA;AACA;AACA,CAAC,6DAAY;AACb;AACA;AACA,YAAY,6DAAY;AACxB;;AAEA,yB;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,qBAAqB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA,YAAY,IAAI;AAChB,YAAY,IAAI,OAAO,IAAI;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAIE;;AAEF;;;;;;;;;;;;;ACzkCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI2B;AAGA;AAGC;AAGD;AAGE;AAGE;;AAE/B;;AAEA;AACA,iCAAiC;AACjC,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC,iEAAc;AACf;AACA,CAAC,6DAAY;AACb,CAAC,6DAAY;AACb;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,EAAE;AACF;AACA;AACA,gBAAgB,6DAAY;AAC5B;AACA;AACA,aAAa,6DAAY;;AAEzB;AACA;AACA;AACA;;AAEA;;AAEA,0B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG,EAAE;AACL;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,IAAI;AACJ;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAc,iCAAiC;AAC/C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;;AAEH,cAAc,iCAAiC;AAC/C;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ,GAAG;AACH;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL,IAAI,6DAAY;;AAEhB,IAAI,6DAAY;;AAEhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,2B;AACA;AACA,IAAI;AACJ;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE,qCAAqC;AACvC;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,0EAA0E;AACnF,SAAS,wCAAwC;AACjD,SAAS,mCAAmC;AAC5C;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA,cAAc,iBAAiB;AAC/B;AACA;AACA;AACA;AACA,EAAE;AACF,cAAc,iBAAiB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAc,6DAAY;AAC1B;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,SAAS,6DAAY;AACrB;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA,CAAC,+DAAa;AACd;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI,iDAAiD;AACrD,IAAI,mDAAmD;AACvD,IAAI;AACJ;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,MAAM;AACN,aAAa,mBAAmB,GAAG,iBAAiB,EAAE,OAAO;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,mBAAmB;AACtB;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,iEAAiE,6DAAY;AAC7E,iEAAiE,6DAAY;AAC7E;;AAEA;AACA;AACA;AACA,UAAU,6DAAY;AACtB;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,uCAAuC;;;AAGvC;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;;AAEA,CAAC,gEAAW;AACZ;;AAEA;AACA;AACA;AACA,KAAK,6DAAY,KAAK,6DAAY,oBAAoB,6DAAY;AAClE;AACA;AACA,mBAAmB,6DAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA,8EAA8E;AAC9E,kGAAkG;AAClG;AACA,qFAAqF;AACrF;AACA,mDAAmD;AACnD,2GAA2G;AAC3G,2FAA2F;AAC3F;AACA,GAAG,EAAE;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,EAAE;AACF;AACA,EAAE;;;AAGF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,iEAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,gBAAgB;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;;AAIE;;AAEF;;;;;;;;;;;;;;;;;;;AC/7BA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI2B;AAGE;;AAE7B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,6DAAY;AACjB;AACA;AACA,mBAAmB,6DAAY;AAC/B;AACA;AACA;AACA;AACA,UAAU,iEAAc;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,iEAAc;AAClB,IAAI;AACJ;AACA,IAAI,iEAAc;AAClB;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH,WAAW,iEAAc;;AAEzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE,iEAAc;AAChB,EAAE;AACF;AACA,EAAE,iEAAc;AAChB,EAAE;;AAEF;;;AAKE;;;;;;;;;;;;;;;;;;;AC5JyB;AAGE;;AAE7B;AACA;AACA;AACA;;AAEA,KAAK,6DAAY,gBAAgB,6DAAY;AAC7C;AACA;AACA;AACA;AACA,IAAI,iEAAc;AAClB;AACA;AACA;AACA,cAAc,GAAG,6DAAY,mBAAmB;AAChD,GAAG,6DAAY;AACf;AACA,EAAE;AACF,KAAK;AACL,qBAAqB,6DAAY;AACjC;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,KAAK;AACL,uBAAuB,6DAAY;AACnC;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,uBAAuB,6DAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,0BAA0B;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC,6DAAY,mCAAmC,6DAAY;AAC5D,gC;AACA,EAAE;AACF,CAAC,6DAAY,mCAAmC,6DAAY;AAC5D;AACA;AACA,EAAE;AACF,CAAC,6DAAY,iCAAiC,6DAAY;AAC1D;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA,sBAAsB,6DAAY;AAClC;AACA,cAAc,6DAAY;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,sBAAsB,6DAAY;;AAElC;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,cAAc,6DAAY;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,oBAAoB,6DAAY;;AAEhC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,cAAc,6DAAY;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAIE;;AAEF;;;;;;;;;;;;;;;ACvKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI6B;AAGA;AAGF;AAGG;;AAE9B;;AAEA,iCAAiC;AACjC,8BAA8B;AAC9B,+BAA+B;;AAE/B;AACA;AACA;AACA;AACA,EAAE,iEAAc;AAChB;AACA;;AAEA;AACA;AACA;AACA,GAAG,iEAAc;AACjB,GAAG,iEAAc;AACjB,GAAG;AACH,EAAE;AACF,EAAE,iEAAc;AAChB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,CAAC,6DAAY;AACb,CAAC,mEAAe;AAChB;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA,2DAA2D,WAAW;;AAEtE;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,EAAE,iEAAc;AAChB;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,yBAAyB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ,WAAW,EAAE;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,+BAA+B,kDAAkD;;AAErG;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA,wDAAwD;AACxD;;AAEA;AACA;AACA;AACA,MAAM;AACN,UAAU,EAAE;AACZ;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,iEAAc;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAIE;;AAEF;;;;;;;;;;;;;;;ACtPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI4B;AAGD;AAGE;AAGF;AAGE;AAGA;AACiC;AAGjC;AAGF;AAGE;AAGC;AACY;;AAE1C;;AAEA,8CAA8C;;AAE9C;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,QAAQ,6DAAY;AACpB,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,EAAE,2EAAa;AACf,KAAK;AACL;AACA;AACA;AACA;;AAEA,EAAE,2EAAa;AACf,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,QAAQ,iEAAc;AACtB,KAAK;AACL;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,QAAQ,iEAAc;AACtB,KAAK;AACL;AACA;;AAEA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,QAAQ,iEAAc;AACtB;AACA,mBAAmB,6DAAY;AAC/B,QAAQ,6DAAY;;AAEpB;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE,EAAE;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE,EAAE;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,6BAA6B,6DAAY;;AAEzC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,YAAY,iEAAc;AAC1B,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,iEAAc;AAC1B;AACA;AACA,sBAAsB;AACtB,KAAK;AACL;AACA;AACA;AACA;AACA,QAAQ,iEAAc;AACtB,QAAQ,iEAAc;AACtB,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,6DAAY;AACxB;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA,YAAY,iEAAc;AAC1B,SAAS;AACT;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,QAAQ,2DAAS;AACjB,KAAK;AACL;;AAEA;AACA;AACA;AACA,CAAC,iEAAc;AACf;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,YAAY,iEAAc;AAC1B,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT,QAAQ,iEAAc;AACtB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ,oEAAe;AACvB;AACA,KAAK;AACL,UAAU,iEAAc;AACxB,QAAQ,iEAAc;AACtB,KAAK;AACL;AACA;;AAEA;AACA;AACA,GAAG,2EAAa;AAChB;AACA,QAAQ,2EAAa;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,6DAAY;AAC5B;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2DAAS;AACrB;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,wBAAwB,QAAQ,GAAG,UAAU,UAAU,KAAK,IAAI,OAAO;AACvE;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,uBAAuB;AAC1C;AACA;;AAEA;AACA;AACA,IAAI;AACJ,gBAAgB,KAAK,GAAG,SAAS,GAAG,UAAU,eAAe,KAAK,IAAI,OAAO;AAC7E;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAIE;;AAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACraA;;AAI6B;AAGF;AAGA;;AAEoD;AACF;;AAE7E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ,kFAAa;AACrB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA,aAAa,iEAAc;AAC3B;AACA,WAAW,iEAAc;AACzB,UAAU,6DAAY;AACtB,eAAe,6DAAY;AAC3B,UAAU,iEAAc;AACxB;;;;AAIA,aAAa,iEAAc,gBAAgB,iEAAc;AACzD;AACA;;AAEA,KAAK,6DAAY;AACjB,EAAE,6DAAY;AACd,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,8EAAe;AAChB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAIE;;AAEF;;;;;;;;;;;;;;;ACjGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAG+B;AAGF;AAGF;AAGA;AAGC;AAGC;;AAE7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC,iEAAc;AACf;;AAEA;AACA;AACA;AACA,KAAK,6DAAY;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,6DAAY;AACnB;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;;AAEA;AACA;AACA;AACA;AACA,eAAe,gBAAgB;;AAE/B;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qDAAqD,qCAAqC;AAC1F;AACA,sCAAsC;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,KAAgB,IAAI,KAAa;AAC7D;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,8CAA8C,mBAAmB;AACjE;AACA,uCAAuC,qBAAqB;AAC5D,qCAAqC,WAAW;AAChD,qCAAqC,cAAc;AACnD;AACA;AACA;AACA;AACA,6CAA6C,UAAU,GAAG,aAAa;AACvE;AACA;AACA,sCAAsC,MAAM;AAC5C,kDAAkD,UAAU,IAAI,0FAA0F;AAC1J,kCAAkC,OAAO,GAAG,KAAK;AACjD,iDAAiD,cAAc;AAC/D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,OAAO;AACvB,aAAa,MAAM;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,YAAY,6DAAY;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG,EAAE;;AAEL;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAIE;;AAEF;;;;;;;;;;;;;;;;;;;;AClZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAI2B;AAGA;AAGC;AAGD;AAGE;;AAEsB;;AAEnD;AACA;AACA;AACA,0BAA0B;AAC1B,0BAA0B;AAC1B;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,KAAK;AACL;AACA;AACA,EAAE;AACF,KAAK;AACL;AACA;AACA,EAAE;AACF,KAAK;AACL;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;AACH,SAAS;AACT;AACA;AACA,GAAG;AACH,SAAS;AACT;AACA;AACA,GAAG;AACH,SAAS;AACT;AACA;AACA,GAAG;AACH,SAAS;AACT;AACA;AACA,GAAG;AACH,SAAS;AACT;AACA;AACA,GAAG;AACH,UAAU;AACV;AACA;AACA,GAAG;AACH,UAAU;AACV;AACA;AACA,GAAG;AACH,EAAE;AACF,UAAU;AACV;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF,gBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ;;AAEA;AACA,uGAAuG,EAAE,UAAU,EAAE,UAAU,EAAE;AACjI;AACA,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ;;AAEA;;AAEA;AACA,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ;;AAEA;AACA;AACA,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ,+HAA+H,EAAE,UAAU,EAAE,UAAU,EAAE;AACzJ;;AAEA;AACA;AACA,IAAI,6DAAY;AAChB;AACA,gCAAgC,EAAE,IAAI,EAAE,IAAI,EAAE,qBAAqB,6DAAY;AAC/E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAA0B,6DAAY;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAmC;;AAEnC;AACA;AACA;AACA,sBAAsB,6DAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB,aAAa;AACb;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;;AAET,KAAK;AACL;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAe,+BAA+B,w0CAAw0C,aAAa,sFAAsF;;;AAGz9C;AACA;AACA,EAAE;;;AAGF,CAAC,6DAAY;AACb,CAAC,6DAAY;;;AAGb;;AAEA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;;AAEA;;AAEA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA,mBAAmB,iCAAiC;AACpD;AACA;AACA;AACA;;AAEA,mBAAmB,mCAAmC;AACtD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb;AACA;AACA;AACA;;;AAGA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,mBAAmB,wBAAwB;AAC3C;AACA;AACA;AACA;AACA;AACA,mBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA,mDAAmD,6DAAY,qCAAqC,6DAAY;AAChH;AACA;AACA;AACA,kFAAkF,EAAE,IAAI,EAAE,IAAI,EAAE;AAChG,yGAAyG,EAAE,IAAI,EAAE,IAAI,EAAE;AACvH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;;AAEA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,6DAAY;;AAE/B;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI,6DAAY;AAChB,IAAI,6DAAY;AAChB;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qDAAqD,qCAAqC;AAC1F;AACA,sCAAsC;AACtC;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,aAAa,wBAAwB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;;AAEA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;;;AAGzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,gBAAgB,+BAA+B,w0CAAw0C,aAAa,sFAAsF;;AAE19C;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA,6DAA6D;;AAE7D;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA,SAAS,6CAA6C;AACtD,SAAS,8CAA8C;AACvD,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA,gBAAgB,SAAS;AACzB,WAAW,SAAS,GAAG,UAAU;AACjC,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU,SAAS;AACnB,2CAA2C,iBAAiB,IAAI,YAAY;AAC5E;AACA;AACA;AACA,2CAA2C,QAAQ;AACnD;AACA;AACA;AACA,2CAA2C,SAAS;AACpD;AACA,4CAA4C,UAAU;AACtD,OAAO;AACP;AACA,gCAAgC,SAAS;;AAEzC,OAAO;AACP,2BAA2B,QAAQ,GAAG,UAAU,UAAU,KAAK,IAAI,OAAO;AAC1E;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA,EAAE;;AAEF;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,+DAA+D,uBAAuB,EAAE;AACxF,+DAA+D,wBAAwB,iBAAiB;;AAExG;;AAEA;;AAEA;AACA;;AAEA;AACA,GAAG,iEAAc;AACjB,GAAG,6DAAY;;AAEf;;AAEA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA,cAAc,+DAA+D;AAC7E,cAAc,+DAA+D;AAC7E,cAAc,+DAA+D;AAC7E;AACA,cAAc,iEAAiE;AAC/E;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,oBAAoB,+BAA+B;AACnD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wDAAwD,uBAAuB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;;AAEA;AACA,8BAA8B;AAC9B,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;;AAEA,mDAAmD;AACnD;AACA;;AAEA;AACA;AACA,KAAK,6DAAY,oBAAoB,6DAAY;AACjD;AACA;AACA;AACA;AACA,mBAAmB,6DAAY;AAC/B;AACA,4BAA4B;AAC5B;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,mBAAmB;AAChC;AACA,qDAAqD;AACrD,qF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI,iEAAc;AAClB;AACA,IAAI,6DAAY;AAChB,IAAI,6DAAY;AAChB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA,sBAAsB,6DAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;;AAGA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;;AAEA,uBAAuB,6DAAY;AACnC,kBAAkB,6DAAY,WAAW,6DAAY;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,yDAAU;AACzB;AACA;AACA;AACA,MAAM,6DAAY;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,6DAAY;AAC/B;AACA;AACA,SAAS;AACT;AACA;;;AAGA;AACA;AACA;AACA;AACA,iBAAiB,UAAU,2DAA2D;;AAEtF;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;;AAEA;AACA;AACA,YAAY,iEAAc;AAC1B;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,0EAA0E;AAC5F,kBAAkB,wCAAwC;AAC1D,kBAAkB,mCAAmC;AACrD;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA,KAAK;AACL,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,6DAAY;AAC7B;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,eAAe,6DAAY;AAC3B;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA,IAAI,+DAAa;AACjB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa,iDAAiD;AAC9D,aAAa,mDAAmD;AAChE,aAAa;AACb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,MAAM;AACN,aAAa,mBAAmB,GAAG,iBAAiB,EAAE,OAAO;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,mBAAmB;AAC5B;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA,0BAA0B,iEAAc;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B,kBAAkB;AACjD;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;AAIE;;AAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3gEA;AACA;AACA;;AAI4B;AAGG;AAGJ;AAGA;AAGA;AAGA;AAGG;AAGF;AAGG;AAC+B;;AAE9D;;AAEA;AACA;;AAEA;AACA,kCAAkC;AAClC,kCAAkC;AAClC,kCAAkC;AAClC,iCAAiC;AACjC,oCAAoC;AACpC,oCAAoC;AACpC,oCAAoC;AACpC,8BAA8B;AAC9B,iCAAiC;AACjC,6BAA6B;AAC7B,gCAAgC;AAChC;AACA;AACA;;AAEA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA,4BAA4B;;AAE5B;AACA;AACA;AACA;AACA;;AAEA;AACA,8EAA8E;AAC9E;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,EAAE,EAAE;;AAEJ;AACA;AACA,qDAAqD,+BAA+B;AACpF;AACA,GAAG,6DAAY;AACf;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE,2DAAS;AACX,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE,2DAAS;AACX,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,gEAAW;AACd,GAAG,gEAAW;AACd;AACA,IAAI;AACJ,GAAG;AACH;AACA,GAAG,gEAAW;AACd,GAAG,gEAAW;AACd;AACA,EAAE;AACF;AACA;AACA,EAAE,gEAAW;AACb,EAAE;AACF;AACA;AACA,EAAE,gEAAW;AACb;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA,EAAE,2DAAS;;AAEX;AACA;AACA;;AAEA;AACA,EAAE,6DAAY;AACd,EAAE,gEAAW;AACb,EAAE,6DAAY;AACd,EAAE,gEAAW;;AAEb;AACA;AACA,GAAG;AACH,EAAE,6DAAY;AACd,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE,mEAAe;AACjB;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE,2DAAS;;AAEX;AACA;AACA,GAAG,2EAAa;AAChB;AACA,EAAE,2EAAa;;AAEf,EAAE;AACF;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,CAAC,6DAAY;AACb;AACA;AACA,CAAC,gEAAW;;AAEZ;AACA;AACA,EAAE;AACF,CAAC,6DAAY;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,CAAC,gEAAW;AACZ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,6DAAY;AAC5B;AACA,6DAA6D,MAAM;AACnE,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,MAAM;AACnC,mCAAmC,MAAM;AACzC;AACA;AACA,kDAAkD,MAAM;AACxD;AACA,2DAA2D,kBAAkB,kBAAkB,cAAc;;AAE7G,qDAAqD,mBAAmB;AACxE;AACA;AACA,8BAA8B,kBAAkB;AAChD;;AAEA,uEAAuE,0CAA0C,2EAAa,QAAQ;AACtI;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,6DAAY;AAC3B;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,gEAAW;AACZ,CAAC,gEAAW;;AAEZ;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,eAAe,6DAAY;AAC3B,iBAAiB,6DAAY;;AAE7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,oDAAoD,eAAe;AACnE,qDAAqD,gBAAgB;;AAErE;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;;;AAKA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA,oBAAoB,6DAAY;AAChC;;AAEA;;AAEA;AACA,oBAAoB,6DAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT,EAAE;AACF;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,6DAAY;AAC/B;AACA,IAAI;;AAEJ;AACA,GAAG,6DAAY;AACf,GAAG;;AAEH,EAAE;AACF;;;AAGA;AACA;;AAEA;;AAEA;AACA,aAAa,6BAA6B;AAC1C;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,CAAC,6DAAY;AACb;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,IAAI,6DAAY;AAChB,EAAE,6DAAY;AACd;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,GAAG,gEAAW,oBAAoB;AAC/C,mBAAmB,gEAAW;AAC9B,aAAa,gEAAW;AACxB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc,0BAA0B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC,gEAAW;AACZ;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,aAAa,mBAAmB;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA,aAAa,GAAG,6DAAY,kBAAkB;AAC9C,cAAc,6DAAY;AAC1B,mBAAmB,6DAAY;;AAE/B;;AAEA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,6DAAY;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,6DAAY;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,0B;AACA;AACA,GAAG;AACH;AACA;AACA,0B;AACA;AACA,GAAG;AACH,EAAE;AACF,0B;AACA;AACA,GAAG;AACH,EAAE;AACF;;;;;;AAMA;AACA,IAAI,2EAAa;AACjB,IAAI,2EAAa;AACjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,yBAAyB;AAC1C,oBAAoB,yBAAyB;AAC7C,cAAc;AACd,GAAG;AACH;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA,+DAA+D,6BAA6B;AAC5F;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA,aAAa,6DAAY;AACzB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,CAAC,gEAAW;AACZ,CAAC,6DAAY;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAS,+DAAU;AACnB;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B,gBAAgB;AAC1C;AACA;AACA;AACA;;AAEA;AACA,qBAAqB;AACrB;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAIE;;;;;;;;;;;;;AC7yCF;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI2B;AAGE;;AAE7B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,6DAAY;AACjB;AACA;AACA,mBAAmB,6DAAY;AAC/B;AACA;AACA;AACA;AACA,UAAU,iEAAc;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,GAAG;;AAEH,WAAW,iEAAc;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;;AAQE;;;;;;;;;;;;;;;;;;AC3QF;;AAI2B;;AAE3B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,QAAQ,0BAA0B;AAClC,QAAQ,6CAA6C;AACrD,QAAQ,6CAA6C;AACrD;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA,aAAa,mBAAmB;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN,MAAM;AACN,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,MAAM;AACN,KAAK;AACL;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;;AAEA;AACA;AACA,KAAK,6DAAY,oBAAoB,6DAAY;AACjD;AACA;AACA;;AAEA,0BAA0B,6DAAY;AACtC;AACA;;AAEA;;AAEA,WAAW,6DAAY;AACvB;;AAEA;;AAEA;AACA;AACA,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG,6CAA6C;AAChD,GAAG,iDAAiD;AACpD,GAAG;AACH;;AAEA,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,aAAa,uCAAuC;AACpD;AACA;AACA;;AAEA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,gBAAgB,uCAAuC;AACvD;AACA;AACA;;AAEA;;AAEA;;;AAKE;;;;;;;;;;;;;;;;;;ACpWF;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI2B;AAGA;AAGE;;AAE7B;;AAEA;AACA;AACA;;AAEA;AACA,mBAAmB,6DAAY;AAC/B;AACA,oBAAoB,UAAU,iEAAiE;;AAE/F,CAAC,iEAAc;AACf;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,mBAAmB;AACnC,KAAK,iEAAc;AACnB;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;;AAEA;AACA;;AAEA;AACA,kBAAkB,iEAAc;AAChC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN,mBAAmB,KAAK;AACxB,eAAe,QAAQ;AACvB;AACA,SAAS;AACT,qBAAqB,KAAK,GAAG,KAAK;AAClC;AACA,yCAAyC,KAAK,WAAW,KAAK;AAC9D;AACA,yBAAyB,OAAO,IAAI,OAAO;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,mBAAmB,KAAK,UAAU,OAAO,uBAAuB;AAChE,eAAe,OAAO;AACtB;AACA,SAAS;AACT,qBAAqB,KAAK,GAAG,KAAK;AAClC;AACA,yCAAyC,KAAK,WAAW,KAAK;AAC9D;AACA,yBAAyB,OAAO,IAAI,OAAO;AAC3C;AACA;AACA;AACA;AACA;AACA,wDAAwD,OAAO;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C,+BAA+B,WAAW;AAC1C;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,mBAAmB,KAAK;AACxB,eAAe,QAAQ;AACvB;AACA,SAAS;AACT,qBAAqB,KAAK,GAAG,KAAK;AAClC;AACA,yCAAyC,KAAK,WAAW,KAAK;AAC9D;AACA,yBAAyB,OAAO,IAAI,OAAO;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,sBAAsB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,yCAAyC;AACvD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,oBAAoB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,oBAAoB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,2BAA2B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,CAAC,6DAAY;AACb;;AAIE;;AAEF;;;;;;;;;;;;;AC9WA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;AAI+B;AAGJ;AAGA;;AAE3B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU,6DAAY;AACtB,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,8EAA8E;AAC9E;;AAIE;AACF;;;;;;;;;;;;;;;;;ACxJA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAIE;AACF;;;;;;;;;;;;;;;;;;AChEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;;;AAK6B;AAGA;AAGG;AACoB;;AAEpD;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ,sBAAsB,SAAS,WAAW,kBAAkB,IAAI,OAAO;AACvE;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,6B;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,oDAAoD;AACpD;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,IAAI;;AAEJ;AACA,gBAAgB,kBAAkB;AAClC;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,EAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,sCAAsC;AACnD;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,4B;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAIE;AACF,WAAW;AACX;;;;;;;;;;;;;;;;;AC7RA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,UAAU;AACrC;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;;;;;;;;ACjHA;AACA;AACA;AACA;;AAI6B;;AAE7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;AACA,mCAAmC,SAAS;AAC5C;;AAEA;AACA;AACA;AACA;;AAEA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,IAAI;;AAEJ;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA,iBAAiB,uBAAuB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAU,iEAAc;AACxB,WAAW,iEAAc;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,sCAAsC,SAAS;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;;AAEA;;AAEA;;AAEA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF,gBAAgB,uBAAuB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,cAAc,iEAAc,YAAY,iEAAc;AACtD,iBAAiB,iEAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG,iEAAc,0BAA0B,iEAAc;AACzD,MAAM,iEAAc,uBAAuB,iEAAc;AACzD;AACA;AACA;AACA;;AAIE;;;;;;;;;;;;;;;;;;;;;;ACvR0B;;AAE5B;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA,MAAM;AACN,KAAK;AACL;;AAEA,0BAA0B;AAC1B,0BAA0B;AAC1B,6BAA6B;AAC7B;AACA;;AAEA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,iBAAiB;AACjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,0CAA0C;AACzE,UAAU,6DAAY;AACtB;AACA;;AAEA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;;AAEA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;;;;;;;;;;;;;;;;;ACjO8B;AAGF;;AAE5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB;AACO;AACP,iBAAiB,iEAAc;;AAE/B,aAAa,6DAAY;AACzB;AACA,+EAA+E,oE;;AAE/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ,GAAG;;;AAGH,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,WAAW,EAAE;AACb,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,qCAAqC;AACtF,2B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD,uCAAuC;;AAExF;AACA;AACA;AACA;AACA,EAAE,iEAAc;AAChB,EAAE,6DAAY;AACd;AACA;;;AAGA;AACA;AACA;AACA,aAAa,6DAAY;AACzB;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;AClJA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;;AAEtB;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,eAAe;AACxD,kEAAkE,oEAAoE,yCAAyC,WAAW,wCAAwC,EAAE;AACpO;;;AAGO,4CAA4C;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,gDAAgD;;AAE5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,a;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL,mBAAmB,mBAAmB;AACtC;AACA;;AAEA;;AAEA;AACA,E;;;;;;;;;;;;ACzEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AAI8B;AAGF;AAGA;;AAII;;;;AAIhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,wDAAwD,4BAA4B;AACpF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,6DAAY;AAC5B,mCAAmC,6DAAY;AAC/C;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,6DAAY;AACpC,qBAAqB,iEAAc;AACnC,yBAAyB,iEAAc;AACvC,cAAc,iEAAc;AAC5B;AACA;AACA;AACA;;AAEA,YAAY,+DAAU;;AAEtB;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ,iEAAc;AACtB;AACA;AACA,QAAQ,iEAAc;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,6BAA6B,gBAAgB;AAC7C;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAKE;;;;;;;;;;;;;;;;;;;AC7RyB;;AAE3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA,CAAC,6DAAY;AACb,CAAC;AACD;AACA;AACA;AACA,CAAC;;;;AAID,mDAAmD;AACnD;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,aAAa;AACb,4BAA4B,kBAAkB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH,mBAAmB,SAAS,UAAU,UAAU;AAChD,cAAc;AACd;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA","file":"user.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./Apps/Dist/Js/user_config.js\");\n","/*\r\n * @Author: tao.w\r\n * @Date: 2020-08-13 14:07:23\r\n * @LastEditors: tao.w\r\n * @LastEditTime: 2020-08-15 14:17:11\r\n * @Description: \r\n */\r\n/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_centre\r\n} from './disease_centre.js';\r\n\r\nvar disease_analyse = {};\r\nvar _datas = [];\r\n\r\nfunction loadData(key) {\r\n    let _url = config_url.pdds + Disease.TYPE_LIST.URLS.ANALYSE + key;\r\n    // let _url = config_url.pdds + 'data/pd/analysis?linkCode=' + key;\r\n    return new Promise((resolve, reject) => {\r\n        $.getAjax({\r\n            'url': _url,\r\n            'token': true,\r\n            'callback': function (data) {\r\n\t\t\t\tlet result = [];\r\n                if (data.code == 0) result = data.result;\r\n\t\t\t\t\r\n\t\t\t\tfor(let i=0; i<result.length; i++){\r\n\t\t\t\t\tresult[i].subtypeText = ' ()';\r\n\t\t\t\t\tif(result[i].type == '3'){\r\n\t\t\t\t\t\tresult[i].subtypeText = '/ ()';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n                resolve(result);\r\n            }\r\n        })\r\n    })\r\n\r\n}\r\n\r\ndisease_analyse.findDatas = async function () {\r\n    //ID\r\n\t\r\n\t$('.disease_analyse_body').html('');\r\n\tlet road = $(\".select_disease_analyse span.select_value\")[0].name;\r\n\tif(!road){\r\n\t\treturn;\r\n\t}\r\n    _datas = await loadData(road);\r\n\t\r\n\tlet _type = $('.sort_list b.active').attr('data-type');\r\n    disease_analyse.sortDatas(_type);\r\n}\r\n\r\n// --\r\ndisease_analyse.sortDataDom = function(){\r\n\t\r\n\tvar analysis = Disease.TYPE_LIST.LEFTTABS.find(function(data){\r\n\t\treturn data.ID == \"disease_analyse\";\r\n\t})\r\n\tvar sort_list = analysis.SORT_LIST;\r\n\tvar new_datas = `\r\n\t\t<span></span>\r\n\t\t${sort_list.map(f => `\r\n\t\t\t<b class=\"${f.CLASS}\" data-type=\"${f.ID}\">${f.NAME}</b>\r\n\t\t`).join('')}\r\n\t`;\r\n\t$('.disease_analyse .disease_analyse_head .sort_list').html(new_datas);\r\n\t\r\n}\r\n\r\ndisease_analyse.sortDatas = function(type){\r\n\t\r\n\t// type 1 \r\n\t// type 2 \r\n\t// type 3 \r\n\t\r\n\t_datas.sort(function(data1, data2){\r\n\t\tlet val1 = Number(data1.type) || 0;\r\n\t\tlet val2 = Number(data2.type) || 0;\r\n\t\tif(type == '2'){\r\n\t\t\tval2 = Number(data1.totalArea) || 0;\r\n\t\t\tval1 = Number(data2.totalArea) || 0;\r\n\t\t}else if(type == '3'){\r\n\t\t\tval2 = Number(data1.totalCount) || 0;\r\n\t\t\tval1 = Number(data2.totalCount) || 0;\r\n\t\t}\r\n\t\treturn val1 - val2;\r\n\t});\r\n\tconsole.log(_datas)\r\n\tdisease_analyse.centre_list(_datas);\r\n}\r\n\r\ndisease_analyse.centre_list = function (data) {\r\n    // var data = [1, 3, 4, 5, 6, 7, 8, 9, 2];\r\n\t\r\n\tvar analysis = Disease.TYPE_LIST.LEFTTABS.find(function(data){\r\n\t\treturn data.ID == \"disease_analyse\";\r\n\t})\r\n\t\r\n\tvar typeMapping = Disease.TYPE_LIST.TYPES.VALUES;\r\n\tvar materialMapping = Disease.TYPE_LIST.MATERIAL;\r\n\tvar new_image = './Apps/Dist/Img/' + analysis.IMAGE_URL + '/';\r\n\tvar image_type = '.' + analysis.IMAGE_TYPE;\r\n\tvar buss_id = ( Disease.TYPE_LIST.ID == \"ASSET_INSPECTION\" ) ? true : false;\r\n\tvar new_data = [];\r\n\t\r\n\tfor(let i=0; i<data.length; i++){\r\n\t\tvar new_type = data[i].type;\r\n\t\tif(typeMapping[new_type]){\r\n\t\t\tnew_data.push(\r\n\t\t\t\tdata[i]\r\n\t\t\t)\r\n\t\t}\r\n\t}\r\n\t\r\n    let new_datas = `\r\n\t\t${new_data.map(f => `\r\n\t\t\t<div class='data_child'>\r\n\t\t\t\t<div class='data_child_px'>\r\n\t\t\t\t\t<div class='disease_analyse_image'>\r\n\t\t\t\t\t\t<img src=\"${new_image}${f.type}${image_type}\" />\r\n\t\t\t\t\t\t<!-- <div></div> -->\r\n\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t${materialMapping[f.material] || ' - '}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<b> ${typeMapping[f.type] ? typeMapping[f.type].NAME : ' - '}</b>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t${analysis.VALUES.map(v => `\r\n\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t<span><span>${v.NAME_1 || f.subtypeText}${typeMapping[f.type].COMPANY || \"\"}</span><b title='${ (!v.ID_1 && v.ID_1!=0) ? ' - ' : f[v.ID_1]}'> ${ (!v.ID_1 && v.ID_1!=0) ? ' - ' : f[v.ID_1]}</b></span>\r\n\t\t\t\t\t\t\t\t<span><span>${v.NAME_2}</span><b title='${ ( !v.ID_2 && v.ID_2!=0 || buss_id ) ? ' - ' : f[v.ID_2]}'>${ (!v.ID_2 && v.ID_2!=0 || buss_id ) ? ' - ' : f[v.ID_2]}</b></span>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`).join('')}\r\n\t`;\r\n\t\r\n    $('.disease_analyse_body').html(new_datas);\r\n};\r\n\r\n\r\nexport {\r\n    disease_analyse\r\n};\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\nimport {\r\n    disease_init\r\n} from './disease_init.js';\r\nimport {\r\n    disease_road_analyse\r\n} from './disease_road_analyse.js';\r\nimport {\r\n    data_other\r\n} from './disease_data_other.js';\r\nimport {\r\n    disease_analyse\r\n} from './disease_analyse.js';\r\nimport {\r\n    disease_screen\r\n} from './disease_screen.js';\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\nimport {\r\n    disease_map\r\n} from './disease_main_map.js';\r\n\r\nvar disease_centre = {};\r\nvar materialMapping = window.Disease.TYPE_LIST.MATERIAL;\r\n\r\ndisease_centre.cn_data = Disease.TYPE_LIST;\r\ndisease_centre.link_list = null;\r\ndisease_centre.centre_search_change = function(){\r\n\tvar _this = this;\r\n\tdisease_analyse.sortDataDom();\r\n\t// disease_centre.link_code_query(function(){\r\n\t\t$('.data_center_body').html('');\r\n\t\t\r\n\t\tlet _active = $('.data_center_tab ul li.active').attr('data-name');\r\n\t\tif(_active == 'disease_analyse'){\r\n\t\t\tdisease_analyse.findDatas();\r\n\t\t}else if(_active == 'road_analyse'){\r\n\t\t\tdisease_road_analyse.findDatas();\r\n\t\t}else if(_active == 'data_other'){\r\n\t\t\tdata_other.findDatas();\r\n\t\t}\r\n\t// });\r\n};\r\n\r\n/*  */\r\n/* disease_centre.link_code_query = function(_callback){\r\n\tlet dataVersion = disease_user.current_adcode.dataVersion,\r\n\t\t_url = config_url.pdds + 'data/road/query',\r\n\t\tmap_code_param = { 'ops': [{'k': 'dataVersion','v': dataVersion,'op': 'eq','type': 'string'}] };\r\n\t\r\n\tdisease_centre.link_list = [];\r\n\t$.postAjax({\r\n\t\turl: _url,\r\n\t\tdata: map_code_param,\r\n\t\tcallback: function(data){\r\n\t\t\tlet type_arr = (data.result && data.result.data) ? data.result.data.features : [];\r\n\t\t\tfor(let i=0; i<type_arr.length; i++){\r\n\t\t\t\tdisease_centre.link_list.push({\r\n\t\t\t\t\t'name': type_arr[i].properties.NAME || type_arr[i].properties.LINK_NAME,\r\n\t\t\t\t\t'id': type_arr[i].properties.LINK_CODE\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tdisease_centre.link_code_init(type_arr);\r\n\t\t\tdisease_screen.screen_init();\r\n\t\t\t_callback && _callback();\r\n\t\t}\r\n\t})\r\n} */\r\n\r\n// --\r\ndisease_centre.search_param = function(){\r\n\tvar type_list = Disease.TYPE_LIST,\r\n\t\tsearch_param = type_list.SEARCHPARAM;\r\n\t\r\n\tvar _html = `\r\n\t\t<h3>${search_param.NAME}</h3>\r\n\t\t<div class=\"search_param_1\">\r\n\t\t\t${search_param.VALUES.map(f => `\r\n\t\t\t\t<div class=\"_param select_param select_${f.ID}\">\r\n\t\t\t\t\t<p data-name=\"${f.ID}\">\r\n\t\t\t\t\t\t<span class=\"select_value\" title=\"${f.NAME}\">${f.NAME}</span>\r\n\t\t\t\t\t\t<b class=\"allow_select\"></b>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<span class=\"mouse_span\"></span>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t${f.VALUES.map(v => `\r\n\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t<label class=\"checkbox_label ${v.CLASS}\">\r\n\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" value=\"${v.VALUE}\" name=\"${f.ID}\" data-name=\"${v.ID}\" data-text=\"${v.TITLE}\" checked=\"\">\r\n\t\t\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t\t\t<span>${v.NAME}</span>\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"_param input_param\" style=\"display: none;\">\r\n\t\t\t\t\t<input type=\"input\" class=\"map_code_1\" placeholder=\"\">\r\n\t\t\t\t\t<span>-</span>\r\n\t\t\t\t\t<input type=\"input\" class=\"map_code_2\" placeholder=\"\">\r\n\t\t\t\t</div>\r\n\t\t\t`).join('')}\r\n\t\t</div>\r\n\t`;\r\n\t\r\n\t$('.data_panel .data_center_head').html(_html);\r\n\t\r\n\tlet pdd_s = [];\r\n\tlet pdd_s_html = '';\r\n\t\r\n\t// \r\n\tif(Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS'){\r\n\t\t\r\n\t\tpdd_s = [\r\n\t\t\t{\r\n\t\t\t\t'name': '',\r\n\t\t\t\t'id': 'TYPE',\r\n\t\t\t\t'type': '1',\r\n\t\t\t\t'value': []\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'name': '',\r\n\t\t\t\t'id': 'TYPE',\r\n\t\t\t\t'type': '2',\r\n\t\t\t\t'value': []\r\n\t\t\t}\r\n\t\t]\r\n\t\t\r\n\t\tfor(let type in type_list.TYPES.VALUES){\r\n\t\t\tlet materialIndex = (type_list.TYPES.VALUES[type].MATERIAL == '1') ? 0 : 1;\r\n\t\t\tpdd_s[materialIndex].value.push({\r\n\t\t\t\t'name': type_list.TYPES.VALUES[type].NAME,\r\n\t\t\t\t'value': type\r\n\t\t\t})\r\n\t\t}\r\n\t\t\r\n\t\tpdd_s_html = `\r\n\t\t\t${pdd_s.map(g => `\r\n\t\t\t\t<div name=\"${g.type}\">\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<label class=\"checkbox_label checkbox_label_all checkbox_label_all_${g.type}\">\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" value=\"\" name=\"TYPE\" data-name=\"${g.type}\" checked=\"\">\r\n\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t<span>${g.name}</span>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t${g.value.map(f => `\r\n\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" value=\"${f.value}\" data-text=\"${f.name}\" checked=\"\">\r\n\t\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t\t<span>${f.name}</span>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t`).join('')}\r\n\t\t\t\t</div>\r\n\t\t\t`).join('')}\r\n\t\t`;\r\n\t\t\r\n\t}else{\r\n\t\tfor(let type in type_list.TYPES.VALUES){\r\n\t\t\tpdd_s.push({\r\n\t\t\t\t'name': type_list.TYPES.VALUES[type].NAME,\r\n\t\t\t\t'value': type\r\n\t\t\t})\r\n\t\t}\r\n\t\tpdd_s_html = `\r\n\t\t\t<div name=\"all\">\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<label class=\"checkbox_label checkbox_label_all checkbox_label_all_all\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" value=\"\" name=\"TYPE\" data-name=\"all\" checked=\"\">\r\n\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</li>\r\n\t\t\t\t${pdd_s.map(f => `\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t\t<input type=\"checkbox\" value=\"${f.value}\" data-text=\"${f.name}\" checked=\"\">\r\n\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t<span>${f.name}</span>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t`).join('')}\r\n\t\t\t<div>\r\n\t\t`;\r\n\t}\r\n\t\r\n\tvar new_key = this.cn_data.TYPES.KEY;\r\n\t$('.data_center_head .search_param_1 .select_' + new_key + ' ul').html(pdd_s_html);\r\n\t\r\n}\r\n\r\n\r\n/*----adcode*/\r\ndisease_centre.link_code_init = function(type_arr){\r\n\tlet new_link_html = `\r\n\t\t<li>\r\n\t\t\t<label class=\"checkbox_label checkbox_label_all\">\r\n\t\t\t\t<input type=\"checkbox\" value=\"\" name=\"LINK_CODE\" data-name=\"all\" checked=\"\">\r\n\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t<span></span>\r\n\t\t\t</label>\r\n\t\t</li>\r\n\t\t${type_arr.map(f => `\r\n\t\t\t<li>\r\n\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t<input type=\"checkbox\" value=\"${f.properties.LINK_CODE}\" checked=\"\">\r\n\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t<span>${f.properties.LINK_CODE}</span>\r\n\t\t\t\t</label>\r\n\t\t\t</li>\r\n\t\t`).join('')}\r\n\t`;\r\n\t\r\n\t$('.data_center_head .search_param_1 .select_LINK_CODE ul').html(new_link_html);\r\n\t$('.data_center_head .search_param_1 .select_LINK_CODE p span').html('');\r\n\t\r\n\t$('#data_center .link_code_param p span').html('');\r\n\t\r\n\tvar ul_list = ['road_analyse','disease_analyse','data_other'];\r\n\tfor(var i=0; i<ul_list.length; i++){\r\n\t\tvar ul_class = ul_list[i];\r\n\t\tvar li_all = '';\r\n\t\tif( ul_class == 'road_analyse' && Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS' ){\r\n\t\t\tli_all = `\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t<input type=\"radio\" name=\"${ul_class}\" value=\"\">\r\n\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</li>\r\n\t\t\t`;\r\n\t\t}\r\n\t\t\r\n\t\tvar road_analyse_html = `\r\n\t\t\t${li_all}\r\n\t\t\t${type_arr.map(f => `\r\n\t\t\t\t<li>\r\n\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t<input type=\"radio\" name=\"${ul_class}\" value=\"${f.properties.LINK_CODE}\">\r\n\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t<span>${f.properties.LINK_CODE}</span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</li>\r\n\t\t\t`).join('')}\r\n\t\t`;\r\n\t\t$('#data_center .' + ul_class + ' .link_code_param ul').html(road_analyse_html);\r\n\t\tvar ul_class_check = $('#data_center .' + ul_class + ' .link_code_param ul li .checkbox_label input');\r\n\t\tif( ul_class_check.length ){\r\n\t\t\tul_class_check[0].checked = true;\r\n\t\t}\r\n\t}\r\n\t\r\n\tlet link_ul = $('#data_center .link_code_param'),\r\n\t\t_text = type_arr.length ? type_arr[0].properties.LINK_CODE : '';\r\n\tfor(let i=0; i<link_ul.length; i++){\r\n\t\tlet _span = link_ul[i].getElementsByClassName('select_value'),\r\n\t\t\t_input = link_ul[i].getElementsByTagName('input');\r\n\t\t\r\n\t\tif(_text && _input.length){\r\n\t\t\t_input[0].checked = true;\r\n\t\t\t_span[0].innerText = _text;\r\n\t\t\t_span[0].name = _text;\r\n\t\t\t_span[0].title = _text;\r\n\t\t}\r\n\t}\r\n\tif( Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS' ){\r\n\t\t$('#data_center .link_code_param.select_road_analyse p span')[0].innerText = '';\r\n\t\t$('#data_center .link_code_param.select_road_analyse p span')[0].name = '';\r\n\t\t$('#data_center .link_code_param.select_road_analyse p span')[0].title = '';\r\n\t\t\r\n\t\t$('#data_center .select_statistical_unit p span')[0].name = '1';\r\n\t\t$('#data_center .select_statistical_unit p span')[0].innerText = '';\r\n\t\t$('#data_center .select_statistical_unit p span')[0].title = '';\r\n\t\t$('#data_center .select_statistical_unit ul label input')[0].checked = true;\r\n\t}\r\n}\r\n\r\n/*--*/\r\ndisease_centre.centre_search_init = function(){\r\n\tlet _this = this;\r\n\t\r\n\t/*--tab*/\r\n\t$('.data_center_tab ul li').click(function(e){\r\n\t\tlet tag_dom = e.target;\r\n\t\tif(tag_dom.tagName == 'SPAN'){\r\n\t\t\ttag_dom = tag_dom.parentElement;\r\n\t\t}\r\n\t\t\r\n\t\t$('.data_center_tab ul li').removeClass('active');\r\n\t\ttag_dom.className = 'active';\r\n\t\t\r\n\t\tlet name = tag_dom.getAttribute('data-name');\r\n\t\t$('#data_center .data_center_child').hide();\r\n\t\t$('#data_center .data_center_child.'+name).show();\r\n\t\t\r\n\t\tif(name == 'road_analyse'){\r\n\t\t\tdisease_road_analyse.findDatas();\r\n\t\t}else if(name == 'disease_analyse'){\r\n\t\t\tdisease_analyse.findDatas();\r\n\t\t}else if(name == 'data_other'){\r\n\t\t\tdata_other.findDatas();\r\n\t\t}\r\n\t})\r\n\t/*--*/\r\n\t$('.search_param button').click(function(){\r\n\t\t$('.select_param p b').removeClass('active');\r\n\t\t$('.select_param ul').hide();\r\n\t\tdisease_centre.centre_list();\r\n\t})\r\n\t$('#data_center .data_center_child').on('click', '.page_jump button.page_submit', function (e) {\r\n\t\tlet data_value = e.target.getAttribute('data-value'),\r\n\t\t\tdata_class = e.target.getAttribute('data-class'),\r\n\t\t\ttotalPages = $('.' + data_class + ' table').bootstrapTable(\"getOptions\").totalPages || 0,\r\n\t\t\tpage = $('.' + data_class + ' .page_jump input.data_page').val(),\r\n\t\t\tnew_page = Number(page) || 1;\r\n\t\t\r\n\t\tif( (new_page < 1) || (new_page > totalPages) ){\r\n\t\t\tnew_page = 1;\r\n\t\t}\r\n\t\t\r\n\t\tif(data_value == '1'){\r\n\t\t\tdisease_centre.centre_list(new_page);\r\n\t\t}else if(data_value == '2'){\r\n\t\t\tdisease_road_analyse.centre_list(new_page);\r\n\t\t}\r\n\t\t\r\n\t})\r\n\t/* -- */\r\n\t$('#data_center .disease_analyse').on('click', '.sort_list b', function (e) {\r\n\t\t\r\n\t\t$('#data_center .disease_analyse .sort_list b').removeClass('active')\r\n\t\t$(e.target).addClass('active');\r\n\t\tlet _type = $(e.target).attr('data-type');\r\n\t\tdisease_analyse.sortDatas(_type);\r\n\t\t\r\n\t})\r\n\t\r\n\t\r\n\t/**/\r\n\t$('.data_center_head').on('blur', '.input_param input.map_code_1', function (e) {\r\n\t\tlet max_num = $('.input_param input.map_code_2').val(),\r\n\t\t\tnew_num = parseInt(e.target.value) || '',\r\n\t\t\told_num = parseInt(e.target.name) || '',\r\n\t\t\tvalue = !new_num ? '' : new_num;\r\n\t\tif(max_num && new_num >= max_num){\r\n\t\t\tvalue = old_num;\r\n\t\t}\r\n\t\te.target.value = value;\r\n\t\te.target.name = value;\r\n\t});\r\n\t$('.data_center_head').on('blur', '.input_param input.map_code_2', function (e) {\r\n\t\tlet min_num = $('.input_param input.map_code_1').val(),\r\n\t\t\tnew_num = parseInt(e.target.value) || '',\r\n\t\t\told_num = parseInt(e.target.name) || '',\r\n\t\t\tvalue = !new_num ? '' : new_num;\r\n\t\tif(min_num && new_num <= min_num){\r\n\t\t\tvalue = old_num;\r\n\t\t}\r\n\t\te.target.value = value;\r\n\t\te.target.name = value;\r\n\t});\r\n\t/*-*/\r\n\t$('.data_center_child').on('mouseenter', '.select_param', function (e) {\r\n\t\tlet currentTarget = e.currentTarget,\r\n\t\t\tcurrentP = currentTarget.getElementsByTagName('p')[0],\r\n\t\t\t_name = currentP.getAttribute('data-name') || '',\r\n\t\t\tb_class = '.data_center_child .select_param.select_' + _name + ' p b',\r\n\t\t\tul_class = '.data_center_child .select_param.select_' + _name + ' ul';\r\n\t\t\r\n\t\t$(b_class).addClass('active');\r\n\t\t$(ul_class).show();\r\n\t})\r\n\t$('.data_center_child').on('mouseleave', '.select_param', function (e) {\r\n\t\tlet currentTarget = e.currentTarget,\r\n\t\t\tcurrentP = currentTarget.getElementsByTagName('p')[0],\r\n\t\t\t_name = currentP.getAttribute('data-name') || '',\r\n\t\t\tb_class = '.data_center_child .select_param.select_' + _name + ' p b',\r\n\t\t\tul_class = '.data_center_child .select_param.select_' + _name + ' ul';\r\n\t\t\r\n\t\t$(b_class).removeClass('active');\r\n\t\t$(ul_class).hide();\r\n\t})\r\n\t/*-*/\r\n\t$('.data_center_head').on('click', '.select_param ul label input', function (e) {\r\n\t\tlet _name = e.target.name,\r\n\t\t\t_value = e.target.value,\r\n\t\t\t_check = e.target.checked,\r\n\t\t\tcheckType = e.target.getAttribute('data-name');\r\n\t\t\r\n\t\tif(!_value){\r\n\t\t\tlet _input = $('.select_param.select_'+_name+' ul label input');\r\n\t\t\tif(_name == 'TYPE'){\r\n\t\t\t\t_input = $('.select_param.select_'+_name+' ul div[name=\"' + checkType + '\"] label input');\r\n\t\t\t}\r\n\t\t\tfor(let i=0; i<_input.length; i++){\r\n\t\t\t\t_input[i].checked = _check;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t_this.check_value_change(checkType);\r\n\t\t\r\n\t})\r\n\t/*-*/\r\n\t$('.data_center_child').on('click', '.select_param ul.disease_type label input', function (e) {\r\n\t\tlet _parent = e.target.parentNode.parentNode.parentNode,\r\n\t\t\tdata_name = _parent.getAttribute('data-name'),\r\n\t\t\tul_class = '.data_center_child .select_param.select_' + data_name,\r\n\t\t\tinput_s = _parent.getElementsByTagName('input'),\r\n\t\t\tselect_title = '',\r\n\t\t\tselect_values = [],\r\n\t\t\tselect_names = [];\r\n\t\t\r\n\t\tfor(let s=0; s<input_s.length; s++){\r\n\t\t\tlet _checked = input_s[s].checked,\r\n\t\t\t\t_value = input_s[s].value,\r\n\t\t\t\t_text = input_s[s].getAttribute('data-text') || _value;\r\n\t\t\tif(_value && _checked){\r\n\t\t\t\tselect_values.push(\r\n\t\t\t\t\t_value\r\n\t\t\t\t)\r\n\t\t\t\tselect_names.push(\r\n\t\t\t\t\t_text\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!select_values.length){\r\n\t\t\t$(ul_class + ' span.select_value')[0].innerText = select_title;\r\n\t\t}else{\r\n\t\t\t$(ul_class + ' span.select_value')[0].innerText = select_names.join(',');\r\n\t\t}\r\n\t\t$(ul_class + ' span.select_value')[0].name = select_values.join(',');\r\n\t\t\r\n\t\tif(data_name == 'road_analyse' || data_name == 'statistical_unit'){\r\n\t\t\tdisease_road_analyse.findDatas();\r\n\t\t}else if(data_name == 'disease_analyse'){\r\n\t\t\tdisease_analyse.findDatas();\r\n\t\t}else if(data_name == 'data_other'){\r\n\t\t\tdata_other.findDatas();\r\n\t\t}\r\n\t\t\r\n\t})\r\n\t/**/\r\n\t$('.data_center_child').on('click', 'a.download_list', function (e) {\r\n\t\t\r\n\t\tlet road = $(\".select_road_analyse span.select_value\")[0].name;\r\n\t\t\r\n\t\tif(!road){\r\n\t\t\t$.errorView('');\r\n\t\t\treturn;\r\n\t\t}else if(!window.token){\r\n\t\t\t$.errorView('token');\r\n\t\t\tlet _url = './login.html';\r\n\t\t\twindow.open(_url, '_self');\r\n\t\t}\r\n\t\tlet new_time = new Date().getTime();\r\n\t\tlet _url = config_url.pdds + Disease.TYPE_LIST.URLS.DOWNLOAD + road + '&token=' + window.token + '&t=' + new_time;\r\n\t\twindow.open(_url, '_blank');\r\n\t})\r\n\t\r\n};\r\n\r\n// \r\ndisease_centre.table_columns = function(type){\r\n\t\r\n\tvar road_analyse = Disease.TYPE_LIST.LEFTTABS.find(function(data){\r\n\t\treturn data.ID == type;\r\n\t})\r\n\tvar columns_list = [];\r\n\tfor(var i=0; i<road_analyse.LIST.length; i++){\r\n\t\tlet mapping = road_analyse.LIST[i].MAPPING || null,\r\n\t\t\tcn_mapping = mapping ? Disease.TYPE_LIST[mapping] : null,\r\n\t\t\tname = road_analyse.LIST[i].NAME,\r\n\t\t\ttitle = road_analyse.LIST[i].TITLE,\r\n\t\t\ttofixed = road_analyse.LIST[i].TOFIXED,\r\n\t\t\tformatter = road_analyse.LIST[i].FORMATTER,\r\n\t\t\ttotal_type = road_analyse.LIST[i].TOTAL_TYPE,\r\n\t\t\tclick = road_analyse.LIST[i].CLICK,\r\n\t\t\ttail = road_analyse.LIST[i].TAIL || '',\r\n\t\t\tid = road_analyse.LIST[i].ID,\r\n\t\t\tnew_field = click ? id : 'properties.LINK_CODE',\r\n\t\t\tchild = {\r\n\t\t\t\tfield: new_field,\r\n\t\t\t\ttitle: title,\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet _value = row.properties[id] || '-',\r\n\t\t\t\t\t\tnew_html = '';\r\n\t\t\t\t\tif(id == 'TYPE'){\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t_value = Disease.TYPE_LIST.TYPES.VALUES[_value] ? (Disease.TYPE_LIST.TYPES.VALUES[_value].NAME || '-') : '-';\r\n\t\t\t\t\t}else if(cn_mapping){\r\n\t\t\t\t\t\t_value = cn_mapping[_value] || '-';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnew_html = '<span title=\"' + _value + tail + '\">' + _value + tail + '</span>';\r\n\t\t\t\t\treturn new_html;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\r\n\t\tif(id == 'MP_CODE'){\r\n\t\t\tchild['formatter'] = function (value, row, index) {\r\n\t\t\t\tlet new_value = row.properties[id] || '',\r\n\t\t\t\t\tmap_codes = new_value.split('|') || [],\r\n\t\t\t\t\tmap_code_2 = map_codes[1] ? ('K'+map_codes[1]) : '-',\r\n\t\t\t\t\tmap_code_3 = map_codes[2] ? ('+'+map_codes[2] + '00') : '+000',\r\n\t\t\t\t\tcode_val = map_code_2 + map_code_3;\r\n\t\t\t\treturn code_val;\r\n\t\t\t}\r\n\t\t}else if(id == 'SUBTYPE'){\r\n\t\t\tchild['formatter'] = function (value, row, index) {\r\n\t\t\t\tlet new_value = Disease.TYPE_LIST.TYPES.VALUES[row.properties.TYPE] || {},\r\n\t\t\t\t\tnew_text = new_value.SUBTYPE ? new_value.SUBTYPE[row.properties.SUBTYPE] : ' - ';\r\n\t\t\t\treturn new_text;\r\n\t\t\t}\r\n\t\t}else if(tofixed){\r\n\t\t\tchild['formatter'] = function (value, row, index) {\r\n\t\t\t\tvar cn_name = row.properties[id] ? Number(row.properties[id]) : 0,\r\n\t\t\t\t\tnew_cn_name = Number( cn_name.toFixed(2) );\r\n\t\t\t\treturn (new_cn_name + tail);\r\n\t\t\t}\r\n\t\t}else if(total_type){\r\n\t\t\tchild['formatter'] = function (value, row, index) {\r\n\t\t\t\tlet new_value = row.properties[total_type] || {},\r\n\t\t\t\t\tnew_text = Number(new_value.total) || '-';\r\n\t\t\t\treturn new_text;\r\n\t\t\t}\r\n\t\t}else if(click){\r\n\t\t\tchild['formatter'] = function (value, row, index) {\r\n\t\t\t\tlet cn_name = `\r\n\t\t\t\t\t<a href=\"#\" class=\"${formatter}\"></a>\r\n\t\t\t\t`;\r\n\t\t\t\treturn cn_name;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tcolumns_list.push(child)\r\n\t}\r\n\treturn columns_list;\r\n\t\r\n}\r\n\r\n\r\n/*--*/\r\ndisease_centre.check_value_change = function(checkType){\r\n\t\r\n\tlet select_param = $('.data_center_head .select_param');\r\n\tfor(let i=0; i<select_param.length; i++){\r\n\t\tlet span_s = select_param[i].getElementsByClassName('select_value');\r\n        let p_s = select_param[i].getElementsByTagName('p')[0] || null;\r\n        let p_name = p_s ? p_s.getAttribute('data-name') : null;\r\n\t\tlet input_s = select_param[i].getElementsByTagName('input');\r\n\t\tlet select_type = true;\r\n\t\tlet check_type = true;\r\n\t\tlet select_title = span_s[0].title;\r\n\t\tlet select_values = [];\r\n\t\tlet select_names = [];\r\n\t\tlet check_all = null;\r\n\t\t\r\n\t\tif(input_s.length){\r\n\t\t\t// check_all = select_param[i].getElementsByClassName('checkbox_label_all')[0].getElementsByTagName('input') ;\r\n\t\t\tlet check_all_dom = select_param[i].getElementsByClassName('checkbox_label_all_' + checkType)[0] || select_param[i].getElementsByClassName('checkbox_label_all')[0];\r\n\t\t\tcheck_all = check_all_dom.getElementsByTagName('input') ;\r\n\t\t}\r\n\t\t\r\n\t\tfor(let s=0; s<input_s.length; s++){\r\n\t\t\tlet _checked = input_s[s].checked,\r\n\t\t\t\t_value = input_s[s].value,\r\n\t\t\t\t_all = input_s[s].getAttribute('data-name'),\r\n\t\t\t\t_text = input_s[s].getAttribute('data-text') || _value;\r\n\t\t\t\r\n\t\t\tif(!_checked){\r\n\t\t\t\tcheck_type = !_all ? false : true;\r\n\t\t\t\tif(_value){\r\n\t\t\t\t\tselect_type = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif(_value && _checked){\r\n\t\t\t\tselect_values.push(\r\n\t\t\t\t\t_value\r\n\t\t\t\t)\r\n\t\t\t\tselect_names.push(\r\n\t\t\t\t\t_text\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(select_type || !select_values.length){\r\n\t\t\tspan_s[0].innerText = select_title;\r\n\t\t}else{\r\n\t\t\tspan_s[0].innerText = select_names.join(',');\r\n\t\t}\r\n\t\tspan_s[0].name = select_values.join(',');\r\n\t\tif(input_s.length){\r\n\t\t\t// check_all[0].checked = check_type;\r\n\t\t}\r\n\t}\r\n\t\r\n\tdisease_centre.centre_list();\r\n};\r\n\t\r\ndisease_centre.centre_init = function(type) {\r\n\tvar display = (type == '1') ? 'none' : 'block';\r\n\t$('#data_center').css('display', display);\r\n};\r\n\r\ndisease_centre.centre_list = function(page=false){\r\n\tvar _table = `\r\n\t\t<table id=\"center_table\"></table>\r\n\t`;\r\n\t$('#data_center .data_center_body').html(_table);\r\n\tif(!disease_user.current_adcode){\r\n\t\treturn;\r\n\t}\r\n\tvar _url = config_url.pdds + Disease.TYPE_LIST.URLS.LIST,\r\n\t// var _url = config_url.pdds + 'data/pd/queryPage',\r\n\t\t_h = $('.data_panel').height() - 192 - 56,\r\n\t\t_current = page || 1,\r\n\t\t_this = disease_centre;\r\n\tvar myTable = $('#center_table').bootstrapTable({\r\n\t\turl: _url,\r\n\t\tmethod: 'POST',\r\n//\t        height: _h,\r\n\t\tuniqueId: 'id',                        // ID\r\n\t\tstriped: false,                        //\r\n\t\tcache: false,                          //true*\r\n\t\tsidePagination: 'server',              //clientserver*\r\n\t\tajaxOptions: {\r\n\t\t\theaders: {\r\n\t\t\t\t'Authorization': token\r\n\t\t\t}\r\n\t\t},\r\n\t\tdataField: 'rows',\r\n\t\tundefinedText: \"-\",\r\n\t\tpagination: true,                      //\r\n\t\tpageNumber: _current,\r\n\t\tpageSize: 12,\r\n\t\tdata_local: \"zh-CN\",\r\n\t\tshowPaginationSwitch: false,\r\n\t\tpaginationLoop: false,\r\n\t\t\r\n\t\tonClickRow:function (row,$element,field) {\r\n\t\t\tif( field != 'properties.LINK_CODE' && field != 'point_cloud_map' && field != 'REMARK' ){\r\n\t\t\t\tlet classNames =  $element.prevObject[0].firstElementChild.className;\r\n\t\t\t\tif( classNames.indexOf('button_control') > -1 ){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdisease_centre.open_map(row, field);\r\n\t\t\t}else if(field == 'REMARK'){\r\n\t\t\t\tvar d_coords = row.properties.D_COORDS || '';\r\n\t\t\t\tdisease_centre.copy_infos(d_coords);\r\n\t\t\t}\r\n\t\t},\r\n\t\tqueryParams : function (params) {\r\n\t\t\tvar _page = (params.offset / params.limit) + 1;\r\n\t\t\tvar temp = {\r\n\t\t\t\t\"sort\": [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t  \"k\": \"properties.TASK_ID\",\r\n\t\t\t\t\t  \"order\": \"desc\"\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t\"ops\": [{\r\n\t\t\t\t\t'k': 'DATA_VERSION',\r\n\t\t\t\t\t'v': disease_user.current_adcode.dataVersion,\r\n\t\t\t\t\t'op': 'eq'\r\n\t\t\t\t}],\r\n\t\t\t\t\"page\": {\r\n\t\t\t\t\t\"totalPages\": 0,\r\n\t\t\t\t\t\"count\": 10000000,\r\n\t\t\t\t\t\"pageNo\": _page,\r\n\t\t\t\t\t\"pageSize\": 12\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tlet dom_p = $('.search_param_1 .select_param p'),\r\n\t\t\t\tdom_span = $('.search_param_1 .select_param .select_value'),\r\n\t\t\t\tmap_code_1 = $('.search_param_1 .input_param .map_code_1'),\r\n\t\t\t\tmap_code_2 = $('.search_param_1 .input_param .map_code_2');\r\n\t\t\t\r\n//\t\t\t\tif(map_code_1){\r\n//\t\t\t\t\ttemp.ops.push({\r\n//\t\t\t\t    \t'k': type,\r\n//\t\t\t\t    \t'v': value,\r\n//\t\t\t\t    \t'op': 'in'\r\n//\t\t\t\t\t})\r\n//\t\t\t\t}\r\n//\t\t\t\tif(map_code_2){\r\n//\t\t\t\t\ttemp.ops.push({\r\n//\t\t\t\t    \t'k': type,\r\n//\t\t\t\t    \t'v': value,\r\n//\t\t\t\t    \t'op': 'in'\r\n//\t\t\t\t\t})\r\n//\t\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tfor(let i=0; i<dom_p.length; i++){\r\n\t\t\t\tlet type = dom_p[i].getAttribute('data-name'),\r\n\t\t\t\t\tdisplay = $('.search_param_1 .select_param').eq(i).css('display'),\r\n\t\t\t\t\tvalue = dom_span[i].name;\r\n\t\t\t\tif(display == 'none'){\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif(type == 'LINK_CODE' && value){\r\n\t\t\t\t\ttemp.ops.push({\r\n\t\t\t\t\t\t'k': type,\r\n\t\t\t\t\t\t'v': value,\r\n\t\t\t\t\t\t'op': 'in'\r\n\t\t\t\t\t})\r\n\t\t\t\t}else if(value && type){\r\n\t\t\t\t\ttemp.ops.push({\r\n\t\t\t\t\t\t'k': type,\r\n\t\t\t\t\t\t'v': value,\r\n\t\t\t\t\t\t'op': 'in'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn JSON.stringify(temp);\r\n\t\t},\r\n\t\tcolumns: disease_centre.table_columns('data_panel'),\r\n\t\t/* columns: [\r\n\t\t\t{\r\n\t\t\t\tfield: 'properties.MP_CODE',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value='', row, index) {\r\n\t\t\t\t\tlet map_codes = value.split('|') || [];\r\n\t\t\t\t\treturn (map_codes[0] || '-');\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.MP_CODE',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value='', row, index) {\r\n\t\t\t\t\tlet map_codes = value.split('|') || [],\r\n\t\t\t\t\t\tcode_val = map_codes[1] ? ('K'+map_codes[1]) : '-';\r\n\t\t\t\t\treturn code_val;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.UP_DOWN',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tvar cn_name = _this.cn_data.UP_DOWM[value] || '-';\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n                field: 'properties.MATERIAL',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = value ? materialMapping[value] : '-';\r\n\t\t\t\t\treturn (new_value || '-');\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.TYPE',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tvar new_key = _this.cn_data.TYPES.KEY,\r\n\t\t\t\t\t\tnew_value = row[new_key],\r\n\t\t\t\t\t\tcn_name = _this.cn_data.TYPES.VALUES[new_value] ? _this.cn_data.TYPES.VALUES[new_value].NAME : '-';\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.SUBTYPE',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tvar type = row.properties.TYPE || '',\r\n\t\t\t\t\t\tsubtype = _this.cn_data.TYPES.VALUES[type] ? _this.cn_data.TYPES.VALUES[type].SUBTYPE : {},\r\n\t\t\t\t\t\tcn_name = subtype[value] || '-';\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.AREA',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tvar cn_name = value ? Number(value) : 0;\r\n\t\t\t\t\treturn cn_name.toFixed(2);\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.MPS_CODE',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tevents: {\r\n\t\t\t\t\t'click .measurements' : function(e,value,row,index){\r\n\t\t\t\t\t\t_this.open_map(row, 'visua_up_map');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet cn_name = `\r\n\t\t\t\t\t\t<a href=\"#\" class=\"measurements\"></a>\r\n\t\t\t\t\t`;\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.ID',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tevents: {\r\n\t\t\t\t\t'click .remarks' : function(e,value,row,index){\r\n\t\t\t\t\t\tlet remark = row.properties.REMARK || '';\r\n\t\t\t\t\t\t$.errorView(remark, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet cn_name = '-';\r\n\t\t\t\t\tif(row.properties.REMARK){\r\n\t\t\t\t\t\tcn_name = `\r\n\t\t\t\t\t\t\t<a href=\"#\" class=\"remarks\"></a>\r\n\t\t\t\t\t\t`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.T_POINT_ID',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tevents: {\r\n\t\t\t\t\t'click .open_map_up' : function(e,value,row,index){\r\n\t\t\t\t\t\t_this.open_map(row, 'visua_up_map');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet cn_name = `\r\n\t\t\t\t\t\t<a href=\"#\" class=\"open_map_up\"></a>\r\n\t\t\t\t\t`;\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.TRACK_ID',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tevents: {\r\n\t\t\t\t\t'click .open_map_survey' : function(e,value,row,index){\r\n\t\t\t\t\t\t_this.open_map(row, 'collect_map');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet cn_name = `\r\n\t\t\t\t\t\t<a href=\"#\" class=\"open_map_survey\"></a>\r\n\t\t\t\t\t`;\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.S_TASK_ID',\r\n\t\t\t\ttitle: '3D',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tevents: {\r\n\t\t\t\t\t'click .open_map_3D' : function(e,value,row,index){\r\n\t\t\t\t\t\t$.errorView('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t_this.open_map(row, 'point_cloud_map');\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet cn_name = `\r\n\t\t\t\t\t\t<a href=\"#\" class=\"open_map_3D read_only\"></a>\r\n\t\t\t\t\t`;\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t], */\r\n\t\tresponseHandler: function (data) {\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView('');\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t\tvar _data = data.result.data.features || [],\r\n\t\t\t\tres = {\r\n\t\t\t\t\trows: _data,\r\n\t\t\t\t\ttotal: data.result.page.count\r\n\t\t\t\t};\r\n\t\t\treturn res;\r\n\t\t},\r\n\t\tformatLoadingMessage: function(data){\r\n\t\t\treturn \"...\";\r\n\t\t},\r\n\t\tformatNoMatches: function(data){\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tonLoadError: function (data) {\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tonLoadSuccess: function (data) {\r\n\t\t\tif(data.total){\r\n\t\t\t\t_this.table_pagination_init({\r\n\t\t\t\t\t'data': data,\r\n\t\t\t\t\t'page': page,\r\n\t\t\t\t\t'id': 'center_table',\r\n\t\t\t\t\t'type': true,\r\n\t\t\t\t\t'class': 'data_center_body',\r\n\t\t\t\t\t'value': 1\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\tmyTable.bootstrapTable('hideLoading');\r\n\t/*$.postAjax({\r\n\t\turl: _url,\r\n\t\tdata: data,\r\n\t\tcallback: function(data){\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView(data.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar _data = data.result.data.features || [];\r\n\t\t\tconsole.log(_data);\r\n\t\t}\r\n\t})*/\r\n\t\r\n\t$('#center_table').on('mouseover', 'a.remarks', function (e) {\r\n\t\tvar row_index = e.target.parentElement.parentElement.sectionRowIndex;\r\n\t\tvar row = $(\"#center_table\").bootstrapTable(\"getData\")[row_index];\r\n\t\tdisease_centre.open_remark(row, e.target);\r\n\t})\r\n\t$('#center_table').on('mouseout', 'a.remarks', function (e) {\r\n\t\tdisease_centre.close_remark();\r\n\t})\r\n\t\r\n};\r\n\r\n/**/\r\ndisease_centre.table_pagination_init = function( param ){\r\n\tif( !$('.fixed-table-pagination').length ){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\tlet totalPages = $('#' + param.id).bootstrapTable(\"getOptions\").totalPages || 0;\r\n\tlet html = `\r\n\t\t<div class=\"page_jump\">\r\n\t\t\t<span></span>\r\n\t\t\t<span class=\"data_count\">${totalPages}</span>\r\n\t\t\t<span></span>\r\n\t\t\t<input type=\"number\" class=\"data_page\" value=\"${param.page}\" />\r\n\t\t\t<span></span>\r\n\t\t\t<button class=\"btn page_submit\" data-value=\"${param.value}\" data-class=\"${param.class}\"></button>\r\n\t\t</div>\r\n\t`;\r\n\t$('.' + param.class + '.page_jump').remove();\r\n\t$('.' + param.class + ' .fixed-table-pagination').append(html);\r\n\t\r\n\tif(param.type){\r\n\t\tlet row_length = param.data.rows ? param.data.rows.length : 0,\r\n\t\t\tnew_height = row_length * 40 + 340,\r\n\t\t\theights = [731, new_height];\r\n\t\theights.sort(function(a,b) {\r\n\t\t\treturn b - a;\r\n\t\t});\r\n\t\tlet data_height = heights[0] + 'px';\r\n\t\t$('#data_center').css('min-height', '627px');\r\n\t\tdocument.body.scrollTop = document.documentElement.scrollTop = 0;\r\n\t}\r\n\t\r\n};\r\n\r\n/*a*/\r\ndisease_centre.open_map = function(row, type){\r\n\t\r\n\tlet _id = row.properties.ID;\r\n\tlet _data = disease_map.formatProperties(row);\r\n\t\r\n\tdisease_player.click_types = true;\r\n\t$('#hourlist li').removeClass('active');\r\n\t$('#hourlist li[type=\"1\"]').addClass('active');\r\n\tthis.centre_init(1);\r\n\tdisease_init.player_mode_init(type);\r\n\t\r\n\tdisease_info.come_to_info(_data,true,true);\r\n\t\r\n};\r\n\r\n/*a--*/\r\ndisease_centre.cesium_map = function(row){\r\n\t\r\n\tlet d_coords = row.properties.D_COORDS || '';\r\n\tlet _display = $('.disease_info').css('display');\r\n\tif(!d_coords.length){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tdisease_player.click_types = true;\r\n\tif(_display == 'block'){\r\n\t\t$('.disease_info').fadeOut(0);\r\n\t\tdisease_player.player_close();\r\n\t}\r\n\t$('#hourlist li').removeClass('active');\r\n\t$('#hourlist li[type=\"1\"]').addClass('active');\r\n\tthis.centre_init(1);\r\n\tdisease_init.left_list_close();\r\n\tlet d_coords_arr = d_coords.split(','),\r\n\t\td_coords_start = d_coords_arr[0].split(' '),\r\n\t\t_height = disease_user.zoomToAltitude(18),\r\n\t\tcenter =  Cesium.Cartesian3.fromDegrees(d_coords_start[0], d_coords_start[1], _height);\r\n\t\r\n\t_viewer.camera.setView({  \r\n\t\tdestination: center\r\n\t})\r\n\t\r\n};\r\n\r\n/*a*/\r\ndisease_centre.open_remark = function(row, dom){\r\n\tvar datas = [],\r\n\t\tclient_rect = dom.getBoundingClientRect(),\r\n\t\tcoords = row.properties.D_COORDS || '',\r\n\t\tnew_coords = coords.split(','),\r\n\t\tp_top = client_rect.top - 49 + 14 + 5,\r\n\t\tp_right = $(window).width() - client_rect.left - 60,\r\n\t\tcoords_cn = ['', ''];\r\n\tif(new_coords.length == 1){\r\n\t\tcoords_cn = [''];\r\n\t}\r\n\tfor(var i=0; i<new_coords.length; i++){\r\n\t\tlet point = new_coords[i].split(' '),\r\n\t\t\tpoint_cn = coords_cn[i];\r\n\t\tif(point_cn){\r\n\t\t\tdatas.push({\r\n\t\t\t\t'x': point[0],\r\n\t\t\t\t'y': point[1],\r\n\t\t\t\t'z': point[2],\r\n\t\t\t\t't': point_cn\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\tvar htmls = `\r\n\t\t${datas.map(d => `\r\n\t\t\t<p>\r\n\t\t\t\t<span>${d.t}</span>\r\n\t\t\t\t<b> ${d.x}  ${d.y}</b>\r\n\t\t\t</p>\r\n\t\t`).join('')}\r\n\t`;\r\n\tif(!coords){\r\n\t\thtmls = `<p></p>`;\r\n\t}\r\n\t$('#data_center .coordinate_info').css({\r\n\t\t'right': (p_right + 'px'),\r\n\t\t'top': (p_top + 'px')\r\n\t})\r\n\t$('#data_center .coordinate_info').html(htmls);\r\n\t$('#data_center .coordinate_info').show();\r\n}\r\n\r\n/*  */\r\ndisease_centre.copy_infos = function(text){\r\n\tvar copyInput = document.createElement('input');\r\n\tcopyInput.value = text;\r\n\tdocument.body.appendChild(copyInput);\r\n\tcopyInput.select();\r\n\tdocument.execCommand(\"Copy\");\r\n\tcopyInput.className = 'copyInput';\r\n\tcopyInput.style.display='none';\r\n\tcopyInput.remove();\r\n}\r\n\r\ndisease_centre.close_remark = function(){\r\n\t$('#data_center .coordinate_info').hide();\r\n}\r\n\r\nexport {\r\n    disease_centre\r\n};\r\n\r\n// module.exports = disease_centre;\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_init\r\n} from './disease_init.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\nimport {\r\n    disease_group\r\n} from './disease_group.js';\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\nimport {\r\n    disease_map\r\n} from './disease_main_map.js';\r\n\r\nvar disease_cesium = {};\r\n\r\ndisease_cesium.right_point = null;\r\ndisease_cesium.last_point = null;\t\t\t//---\r\ndisease_cesium.last_info_point = null;\t\t//---\r\ndisease_cesium.load_image = null;;;\r\ndisease_cesium.time_spac = 300;;\r\ndisease_cesium.minZoom = 9;\r\ndisease_cesium.maxZoom = 27;\r\ndisease_cesium.camera_zoom = null;\r\ndisease_cesium.layer_type = '2';\r\n\r\ndisease_cesium.point_to_info = function(type){\r\n\tif(!this.last_point){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\tdisease_player.click_types = true;\r\n\t$(\".cesium_popup\").hide();\r\n\tdisease_init.player_mode_init(type);\r\n\tdisease_info.come_to_info(this.last_point.datas.index,true,true);\r\n};\r\n\r\ndisease_cesium.maps_init = function() {\r\n\t\r\n\tvar _this = this;\r\n\t\r\n\t/*cesium-pop*/\r\n\t/*$('#cesium_map_parent .cesium_popup_mark').mouseout(function(){\r\n\t\t$('#cesium_map_parent .cesium_popup_mark').hide();\r\n\t})*/\r\n\t/*cesium-*/\r\n\t$('.cesium_popup .popup_content .image_buttons').on('click', 'button', function () {\r\n\t\tlet name = this.name;\r\n\t\t_this.point_to_info(name);\r\n\t})\r\n\t// $('.cesium_popup .popup_content .image_buttons button.image_buttons_up').click(function(){\r\n\t// \tlet name = this.name;\r\n\t// \t_this.point_to_info(name);\r\n\t// })\r\n\t// $('.cesium_popup .popup_content .image_buttons button.image_buttons_survey').click(function(){\r\n\t// \tlet name = this.name;\r\n\t// \t_this.point_to_info(name);\r\n\t// })\r\n\t// $('.cesium_popup .popup_content .image_buttons button.image_buttons_point').click(function(){\r\n\t// \tlet name = this.name;\r\n\t// \t_this.point_to_info(name);\r\n\t// })\r\n\t\r\n\t/*cesium*/\r\n\t$('.cesium_control .zoom_in a').click(function(){\r\n\t\tvar level = $('.cesium_control .zoom_level a').html(),\r\n\t\t\tnew_level = Number(level) + 1;\r\n\t\t_this.zoomInOut(new_level);\r\n\t})\r\n\t$('.cesium_control .zoom_out a').click(function(){\r\n\t\tvar level = $('.cesium_control .zoom_level a').html() - 1;\r\n\t\t_this.zoomInOut(level);\r\n\t})\r\n\t/*cesium*/\r\n\t$('.cesium_control .cesium_move span').click(function(){\r\n\t\tvar data_type = this.getAttribute('data-type'),\r\n\t\t\tviewer_height = _viewer.camera.positionCartographic.height;\r\n\t\tif(data_type){\r\n\t\t\t_viewer.camera[data_type](viewer_height);\r\n\t\t}\r\n\t})\r\n\t/*cesium*/\r\n\t$('.cesium_control .layer_list').mouseleave(function(){\r\n\t\t$('.cesium_control .cesium_layers').removeClass('active');\r\n\t\t$('.cesium_control .layer_list').hide();\r\n\t})\r\n\t$('.cesium_control .cesium_layers a').click(function(){\r\n\t\t$('.cesium_control .cesium_layers').toggleClass('active');\r\n\t\t$('.cesium_control .layer_list').toggle();\r\n\t})\r\n\t$('.layer_list li label input').click(function(e){\r\n\t\tlet val = e.target.value,\r\n\t\t\tchecked = e.target.checked;\r\n\t\t_this.layers_changed({\r\n\t\t\t'value': val,\r\n\t\t\t'checked': checked\r\n\t\t});\r\n\t})\r\n\t$('.layer_list li span.radio_label').click(function(e){\r\n\t\tlet _type = $('.layer_list .checkbox_label input[value=\"1\"]')[0].checked;\r\n\t\tif(!_type){\r\n\t\t\t$.errorView('');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet dom = (e.target.localName == 'b') ? e.target.parentNode : e.target;\r\n\t\t$('.layer_list li span.radio_label').removeClass('active');\r\n\t\t$(dom).addClass('active');\r\n\t\t\r\n\t\tlet val = dom.getAttribute('name'),\r\n\t\t\tchecked = true;\r\n\t\t_this.layers_changed({\r\n\t\t\t'value': val,\r\n\t\t\t'checked': checked\r\n\t\t});\r\n\t\tdisease_cesium.layer_type = val;\r\n\t})\r\n\t/*cesium*/\r\n\t$('.cesium_control .full_screen a').click(function(){\r\n\t\tvar _center = disease_user.current_adcode.center,\r\n\t\t\tnew_center = _center ? _center.split(',') : null,\r\n\t\t\t_zoom = config_url.nantong.zoom,\r\n\t\t\t_height = disease_user.zoomToAltitude(_zoom);\r\n\t\t\r\n\t\tif(!new_center){\r\n\t\t\t$.errorView('');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tvar center =  Cesium.Cartesian3.fromDegrees(new_center[0], new_center[1], _height);\r\n\t\t\r\n\t\t_viewer.camera.setView({  \r\n\t\t\tdestination: center\r\n\t\t})\r\n\t\t/*var _bounds = config_url.nantong.info_bounds;\r\n\t\t_viewer.camera.setView({\r\n\t\t\tdestination: Cesium.Rectangle.fromDegrees(_bounds.west, _bounds.south, _bounds.east, _bounds.north)\r\n\t\t});*/\r\n//\t\tzoom_level();\r\n\t})\r\n\t/*cesium*/\r\n\t$('.cesium_control .cesium_search a').mouseover(function(){\r\n\t\t$('.cesium_control .cesium_search input').css('display', 'block');\r\n\t\t$('.cesium_control .cesium_search input').animate({\r\n\t\t\t'width': '178px'\r\n\t\t},200);\r\n\t})\r\n\t$('.cesium_control .cesium_search').mouseleave(function(){\r\n\t\t$('.cesium_control .cesium_search input').animate({\r\n\t\t\t'width': '0px'\r\n\t\t},200,'swing',function(){\r\n\t\t\t$('.cesium_control .cesium_search input').css('display', 'none');\r\n\t\t});\r\n\t})\r\n\t$('.cesium_control .cesium_search input').keydown(function(e){\r\n\t\tvar value = e.target.value,\r\n\t\t\tcode = e.keyCode;\r\n\t\t\r\n\t\tif(code == 13 && value){\r\n\t\t\tvar _url = 'https://nominatim.openstreetmap.org/search?format=json&q='+value;\r\n\t\t\t$.getAjax({\r\n\t\t\t\t'url': _url,\r\n\t\t\t\t'token': true,\r\n\t\t\t\t'callback': function(data){\r\n\t\t\t\t\tvar result = (data && data[0]) ? data[0] : {},\r\n\t\t\t\t\t\tboundingbox = result.boundingbox || null;\r\n\t\t\t\t\tif(!boundingbox){\r\n\t\t\t\t\t\t$.errorView('');\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_viewer.camera.setView({\r\n\t\t\t\t\t\tdestination: Cesium.Rectangle.fromDegrees(\r\n\t\t\t\t\t\t\tboundingbox[2],\r\n\t\t\t\t\t\t\tboundingbox[0],\r\n\t\t\t\t\t\t\tboundingbox[3],\r\n\t\t\t\t\t\t\tboundingbox[1]\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\t\r\n\tvar handler3D = new Cesium.ScreenSpaceEventHandler(_viewer.canvas),\r\n\t\tscene = _viewer.scene,\r\n\t\t_id = null;\r\n\t//\r\n\thandler3D.setInputAction(function (movement) {\r\n\t\tvar picked = scene.pick(movement.endPosition);\r\n\t\t$(\".cesium_popup\").hide();\r\n\t\tif(_this.last_point){\r\n\t\t\tif(_this.last_info_point && (_this.last_point._id == _this.last_info_point._id)){\r\n\t\t\t\r\n\t\t\t}else if(_this.last_point._billboard && _this.last_point._billboard._image._value){\r\n\t\t\t\t_this.last_point._billboard._image._value = _this.last_point._default_url;\r\n//\t\t        \t_this.last_point._billboard.disableDepthTestDistance._value = 0;\r\n\t\t\t\t_this.last_point = null;\r\n\t\t\t}else if( _this.last_point.datas && _this.last_point.datas.TYPE == '703' ){\r\n\t\t\t\t_this.last_point.polygon.material.color.setValue( Cesium.Color.RED.withAlpha(0.01) );\r\n\t\t\t\t_this.last_point.polygon.outlineColor.setValue( Cesium.Color.RED.withAlpha(0.01) );\r\n\t\t\t}else if(_this.last_point._pickPrimitive && _this.last_point.datas){\r\n\t\t\t\t_this.last_point._pickPrimitive.image = _this.last_point.default_url;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tif(picked && picked.id && picked.id.datas && picked.id.datas.TYPE == '703'){\r\n\t\t\tpicked.id.polygon.material.color.setValue( Cesium.Color.RED.withAlpha(0.4) );\r\n\t\t\tpicked.id.polygon.outlineColor.setValue( Cesium.Color.RED.withAlpha(0.4) );\r\n\t\t\t_this.last_point = picked.id;\r\n\t\t}\r\n\t\t\r\n\t\tif (picked && picked.id && picked.id.data_id && !picked.id.mark_type && (picked.id._billboard || picked.id.datas.TYPE == '703')) {\r\n\t\t\tvar obj = { position: movement.endPosition },\r\n\t\t\t\t_id = _this.last_point ? _this.last_point._id : null;\r\n\t\t\tif (picked.id._billboard && picked.id._billboard._image._value) {\r\n\t\t\t\t\r\n\t\t\t\tpicked.id._billboard._image._value = picked.id._active_url;\r\n\t\t\t\tpicked.id._billboard.disableDepthTestDistance._value = Number.POSITIVE_INFINITY;\r\n\t\t\t\t_this.last_point = picked.id;\r\n\t\t\t}\r\n\t\t\t_this.cesium_popup_html({\r\n\t\t\t\t'obj': obj,\r\n\t\t\t\t'_id': _id,\r\n\t\t\t\t'scene': scene,\r\n\t\t\t\t'picked': picked\r\n\t\t\t});\r\n\t\t}else if(picked && picked.primitive && picked.primitive._billboardCollection && picked.primitive.datas){\r\n\t\t\t\r\n\t\t\tvar obj = { position: movement.endPosition },\r\n\t\t\t\t_id = _this.last_point ? _this.last_point._id : null;\r\n\t\t\t\r\n\t\t\tif(!_id){\r\n\t\t\t\t_id = _this.last_point ? _this.last_point.datas.ID : null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tpicked.primitive._pickPrimitive.image = picked.primitive.active_url;\r\n\t\t\t\r\n\t\t\t_this.last_point = picked.primitive;\r\n\t\t\t_this.cesium_popup_html({\r\n\t\t\t\t'obj': obj,\r\n\t\t\t\t'_id': _id,\r\n\t\t\t\t'scene': scene,\r\n\t\t\t\t'picked': picked\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}else {\r\n\t\t\t$(\".cesium_popup\").hide();\r\n\t\t}\r\n\t\t$.cesium_refresh();\r\n\t}, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\t\r\n\t//\r\n\thandler3D.setInputAction(function (movement) {\r\n\t\t\r\n//\t\t$('.disease_info').fadeIn(200);\r\n\t\tvar picked = scene.pick(movement.position);\r\n\t\tif(picked && picked.id && picked.id._datas && !picked.id.mark_type){\r\n\t\t\t\r\n\t\t\tconsole.log(picked);\r\n\t\t\t\r\n\t\t\tvar index = picked.id._datas.index;\r\n\t\t\tif( (picked.id._billboard || picked.id.datas.TYPE == '703') && index != undefined){\r\n\t\t\t\t\r\n\t\t\t\tvar active = Disease.TYPE_LIST.FUNBUTTON.find(function (data) {\r\n\t\t\t\t\treturn data.ACTIVE == 'active';\r\n\t\t\t\t})\r\n\t\t\t\tdisease_init.player_mode_init(active.ID);\r\n\t\t\t\t\r\n\t\t\t\tdisease_info.come_to_info(index,true,true);\r\n\t\t\t\t\r\n//\t\t\t\t\tdisease_info.info_init(index,true,true);\r\n//\t\t\t\t\t_this.change_last_point(picked.id);\r\n//\t\t\t\t\t_this.listen_cesium_body('disease_info', true);\r\n//\t\t\t\t\tif(display == 'none'){\r\n//\t\t\t\t\t\t$('.disease_info').css('display', 'block');\r\n//\t\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$(\".cesium_popup\").hide();\r\n\t\t}else if(picked && picked.id && picked.id.point_length && !picked.id.mark_type){\r\n\t\t\tvar center = picked.id._center,\r\n\t\t\t\tz_height = _viewer.camera.positionCartographic.height,\r\n\t\t\t\tzoom_height = 300;\r\n\t\t\t\r\n\t\t\t// if(disease_user.current_adcode && disease_user.current_adcode.adcode && disease_user.current_adcode.adcode == '441400'){\r\n\t\t\t// \tzoom_height = 450;\r\n\t\t\t// }else if(disease_user.current_adcode && disease_user.current_adcode.adcode && disease_user.current_adcode.adcode == '522700'){\r\n\t\t\t// \tzoom_height = 1300;\r\n\t\t\t// }\r\n\t\t\t\r\n\t\t\tvar lng_lat = Cesium.Cartesian3.fromDegrees(center[0], center[1], zoom_height);\r\n\t\t\t_viewer.camera.setView({  \r\n\t\t\t\tdestination: lng_lat\r\n\t\t\t})\r\n\t\t\t_this.zoom_level();\r\n\t\t}\r\n\t\t\r\n\t}, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\t//\r\n\thandler3D.setInputAction(function (movement) {\r\n\t\t$('#cesium_popup').hide();\r\n\t\t$('.cesium_popup_mark').hide();\r\n\t}, Cesium.ScreenSpaceEventType.LEFT_DOWN);\r\n\t//\r\n\t/*handler3D.setInputAction(function (movement) {\r\n\t\tzoom_level();\r\n\t}, Cesium.ScreenSpaceEventType.WHEEL);*/\r\n\t//\r\n\thandler3D.setInputAction(function (movement) {\r\n\t\t$('#cesium_popup').hide();\r\n\t}, Cesium.ScreenSpaceEventType.MIDDLE_DOWN);\r\n\t\r\n\t/*-*/\r\n\thandler3D.setInputAction(function (event) {\r\n\t\t_this.cesium_popup_mark(event);\r\n\t}, Cesium.ScreenSpaceEventType.RIGHT_CLICK);\r\n};\r\n\r\n/**/\r\ndisease_cesium.cesium_popup_mark = function(event){\r\n\t\r\n\t$('.cesium_popup_mark').hide();\r\n\tlet map_width = $('#cesium_map').width() || 0,\r\n\t\tmap_height = $('#cesium_map').height() || 0,\r\n\t\tdom_width = $('#cesium_map_parent').width() || 0,\r\n\t\tdom_height = $('#cesium_map_parent').height() || 0,\r\n\t\tleft_width = dom_width - map_width,\r\n\t\ttop_height = dom_height - map_height,\r\n\t\tnew_left = event.position.x + left_width + 5,\r\n\t\tnew_top = event.position.y + top_height + 52,\r\n\t\tpicked = _viewer.scene.pick(event.position);\r\n\t\r\n\t$('.cesium_popup_mark').css({\r\n\t\t'top': new_top,\r\n\t\t'left': new_left\r\n\t});\r\n\t\r\n\tif(picked && picked.id && picked.id.mark_type == 'position_label'){\r\n\t\t$('.cesium_popup_mark.remove_mark').show();\r\n\t\tthis.right_point = picked.id.id;\r\n\t}else{\r\n\t\t$('.cesium_popup_mark.add_mark').show();\r\n\t\tthis.right_point = $.get_cesium_xy(event);\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_cesium.layers_changed = function(param){\r\n\tlet show = param.checked,\r\n\t\tparam_val = param.value,\r\n\t\tlayers = _viewer.imageryLayers._layers || [],\r\n\t\tvalues = _viewer.entities.values || [],\r\n\t\tparam_l = {\r\n\t\t\t'1': { 'tdtImg_c': true, 'tdtCva': true, 'tdtAdcode': true, 'tdtAdcodeM': true },\r\n\t\t\t'2': { 'tdtAdcode': true, 'tdtAdcodeM': true },\r\n\t\t\t'3': { 'tdtImg_c': true, 'tdtCva': true },\r\n\t\t\t'4': null\r\n\t\t};\r\n\t\r\n\tif(show && param.value == '1'){\r\n\t\t$('.radio_label').removeClass('active');\r\n\t\t$('.radio_label[name=\"2\"]').addClass('active');\r\n\t\tparam_val = $('.radio_label.active').attr('name');\r\n\t}else if(param.value == '1'){\r\n\t\t$('.radio_label').removeClass('active');\r\n\t}\r\n\t\r\n\tif(param.value == '4'){\r\n\t\tfor(let i=0; i<values.length; i++){\r\n\t\t\tif(values[i].mark_type == 'position_label'){\r\n\t\t\t\tvalues[i].show = show;\r\n\t\t\t}\r\n\t\t}\r\n\t}else{\r\n\t\tfor(let i=0; i<layers.length; i++){\r\n\t\t\tlet layer_name = layers[i].imageryProvider._layer,\r\n\t\t\t\tcreateid = layers[i].imageryProvider._credit;\r\n\t\t\tif( createid && createid._html == 'tile2d' ){\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif(param.value == '5'){\r\n\t\t\t\tlayers[i].show = show;\r\n\t\t\t}else if( param_l[param_val][layer_name] ){\r\n\t\t\t\tlayers[i].show = show;\r\n\t\t\t}else{\r\n\t\t\t\tlayers[i].show = !show;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t$.cesium_refresh();\r\n};\r\n\r\n//\r\ndisease_cesium.change_last_point = function(layer){\r\n\tif(this.last_info_point){\r\n\t\t\r\n\t\tthis.last_info_point._billboard._image._value = this.last_info_point._default_url;\r\n\t\tthis.last_info_point._billboard.disableDepthTestDistance._value = Number.POSITIVE_INFINITY;\r\n\t\tthis.last_info_point = null;\r\n\t}\r\n\tif(layer && layer._billboard){\r\n\t\t\r\n\t\tlayer._billboard._image._valu = layer._active_url;\r\n\t\tlayer._billboard.disableDepthTestDistance._value = Number.POSITIVE_INFINITY;\r\n\t\tthis.last_info_point = layer;\r\n\t}\r\n\t$.cesium_refresh();\r\n};\r\n\r\n/*---*/\r\ndisease_cesium.zoomInOut = function(zoom){\r\n\tvar height = disease_user.zoomToAltitude(zoom);\r\n\tif(height){\r\n\t\tvar center = $.getCenterPoint();\r\n\t\t_viewer.camera.setView({\r\n\t\t\tdestination: Cesium.Cartesian3.fromDegrees(center[0], center[1], height)\r\n\t\t})\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_cesium.zoom_level = function(){\r\n\tvar height = _viewer.camera.positionCartographic.height,\r\n\t\tzoom = disease_user.altitudeToZoom(height),\r\n\t\tmath_zoom = Math.round(zoom);\r\n\t_viewer.camera.mathZoom = math_zoom;\r\n\t$('.cesium_control .zoom_level a').html(math_zoom);\r\n\t\r\n\tif( (math_zoom > 15) && !window.tile2d.show ){\r\n\t\twindow.tile2d.show = true;\r\n\t}else if( (math_zoom < 16) && window.tile2d.show ){\r\n\t\twindow.tile2d.show = false;\r\n\t}\r\n\t\r\n\tif( math_zoom > 19  ){\r\n\t\t$('.layer_list .checkbox_label input[value=\"1\"]')[0].checked = false;\r\n\t\t$('.layer_list li span.radio_label').removeClass('active');\r\n\t\tdisease_cesium.layers_changed({\r\n\t\t\t'value': 5,\r\n\t\t\t'checked': false\r\n\t\t});\r\n\t}else if( math_zoom < 20 ){\r\n\t\t$('.layer_list .checkbox_label input[value=\"1\"]')[0].checked = true;\r\n\t\tvar  _active = $('.layer_list li span.radio_label.active');\r\n\t\tif(!_active.length){\r\n\t\t\t$('.layer_list li span.radio_label[name=\"' + disease_cesium.layer_type + '\"]').addClass('active');\r\n\t\t\tdisease_cesium.layers_changed({\r\n\t\t\t\t'value': disease_cesium.layer_type,\r\n\t\t\t\t'checked': true\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\tdisease_group.point_group();\r\n};\r\n\r\n/**/\r\ndisease_cesium.cesium_popup = function(param = null){\r\n\tif (param && Cesium.defined(param.picked)) {\r\n\t\tvar center = param.picked.id ? param.picked.id._datas.center_xy : param.picked.primitive.datas.center_xy,\r\n\t\t\t_id = param.picked.id ? param.picked.id._id : param.picked.primitive.datas.ID,\r\n\t\t\tid = Cesium.defaultValue(param.picked.id, param.picked.primitive.id),\r\n\t\t\tproperties = param.picked.id ? param.picked.id._datas : param.picked.primitive.datas,\r\n\t\t\tpositions = Cesium.Cartesian3.fromDegrees(center[0], center[1], center[2]),\r\n\t\t\tposition_popup = Cesium.SceneTransforms.wgs84ToWindowCoordinates(param.scene, positions);\r\n\t\t\r\n\t\tvar _this = disease_cesium;\r\n\t\tvar _cns = [\r\n\t\t\t{ 'id': 'WIDTH', 'name': 'WIDTH_CN', 'unit': 'm' },\r\n\t\t\t{ 'id': 'RADIUS', 'name': 'RADIUS_CN', 'unit': 'm' },\r\n\t\t\t{ 'id': 'SLOPE', 'name': 'SLOPE_CN', 'unit': '' }\r\n\t\t]\r\n\t\t// RADIUS: \"Infinity\"    m\r\n\t\t// SLOPE: \"-0.017119\"\t\t\r\n\t\t// WITH: \"3.75\",            m\r\n\t\t\r\n\t\tif(properties.WIDTH_CN || properties.SLOPE_CN){\r\n\t\t\t\r\n\t\t\t$('.cesium_popup .popup_content .image_buttons').css('display', 'none');\r\n\t\t\t$('.cesium_popup .popup_content .image_texts').css('display', 'block');\r\n\t\t\t\r\n\t\t\tlet _html = `\r\n\t\t\t\t${_cns.map(c => `\r\n\t\t\t\t\t<span>${properties[c.name]} ${properties[c.id]}${c.unit}</span>\r\n\t\t\t\t`).join('')}\r\n\t\t\t`;\r\n\t\t\t$('.cesium_popup .popup_content .image_texts').html(_html);\r\n\t\t\tif(properties.LINK_CODE){\r\n\t\t\t\t$('.cesium_popup .popup_content .image_buttons').css('display', 'block');\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t$('.cesium_popup .popup_content .image_buttons').css('display', 'block');\r\n\t\t\t$('.cesium_popup .popup_content .image_texts').css('display', 'none');\r\n\t\t}\r\n\t\t\r\n\t\tif ( (id instanceof Cesium.Entity) || (param.picked.primitive && param.picked.primitive.datas) ) {\r\n\t\t\tfunction positionPopUp(c) {\r\n\t\t\t\tvar _x = 0,\r\n\t\t\t\t\t_y = -123,\r\n\t\t\t\t\tmap_width = $('#cesium_map').width(),\r\n\t\t\t\t\tleft_width = $('.cesium_map_left').width(),\r\n\t\t\t\t\tmap_height = $('#cesium_map').height(),\r\n\t\t\t\t\ttype_width = map_width - position_popup.x,\r\n\t\t\t\t\ttype_height = map_height - position_popup.y;\r\n\t\t\t\tif(type_width < 289){\r\n\t\t\t\t\t_x = -289;\r\n\t\t\t\t}\r\n\t\t\t\tif(position_popup.y < 115){\r\n\t\t\t\t\t_y = 8;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar x = position_popup.x + _x + left_width,\r\n\t\t\t\t\ty = position_popup.y + _y;\r\n\t\t\t\t$(\".cesium_popup\").css('transform', 'translate3d(' + x + 'px, ' + y + 'px, 0)');\r\n\t\t\t}\r\n\t\t\t$(\".cesium_popup\").show();\r\n//\t        \tif(param._id != _id){\r\n\t\t\t\tpositionPopUp();\r\n//\t       \t\t}\r\n\t\t\t$('.leaflet-popup-close-button').click(function () {\r\n\t\t\t\t$(\".cesium_popup\").hide();\r\n\t\t\t\treturn false;\r\n\t\t\t});\r\n\t\t\treturn id;\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_cesium.cesium_popup_html = function(param){\r\n\tvar param_id = param.picked.id ? param.picked.id._id : param.picked.primitive.datas.ID,\r\n\t\tdatas = param.picked.id ? param.picked.id.datas : param.picked.primitive.datas,\r\n\t\tupdate_time = datas.update_time ? datas.update_time.split('/').join('.') : '',\r\n\t\tcreate_time = new Date(datas.create_time),\r\n\t\tnew_create_time = $.timeConvert(create_time, true),\r\n\t\tclass_name = 'child_body_grade_value grade_' + datas.subtype,\r\n\t\tinfo_view_type_2 = datas.mp_codes_0 + ' ' + datas.mp_codes_1 + datas.mp_codes_2 + ' ' + datas.cn_up_down,\r\n\t\ttrack_point_id = datas.T_POINT_ID,\r\n\t\tplace_value = datas.cn_mark + ' ' + datas.cn_up_down,\r\n\t\ttrack_image_url = config_url.krs + 'image/get?trackPointId=' + track_point_id + '&type=00&seq=005&imageType=jpg';\r\n\t\r\n\tif( param._id != param_id || datas.TYPE == '703' ){\r\n\t\t$('.cesium_popup .popup_content_head b').html(datas._cn_type || '');\r\n\t\t$('.cesium_popup .popup_content_head .child_body_grade_value').html(datas._cn_subtype || '');\r\n\t\t$('.cesium_popup .popup_content_head .child_body_grade_value').attr('class', class_name);\r\n\t\t\r\n\t\t$('.cesium_popup .child_body_place .child_body_place_type').html(info_view_type_2);\r\n\t\t$('.cesium_popup .child_body_grade .child_body_grade_time').html(datas.update_time);\r\n\t\t\r\n\t\t\r\n\t\t/*this.load_image && clearTimeout(this.load_image);\r\n\t\tthis.load_image = setTimeout(function(){\r\n\t\t\t$.getImageToken(\r\n\t\t\t\t$('.cesium_popup .popup_img img'),\r\n\t\t\t\ttrack_image_url\r\n\t\t\t);\r\n\t\t}, this.time_space);*/\r\n\t}\r\n\t\r\n\tthis.cesium_popup(param);\r\n};\r\n\r\n/*cesium-60~~45000000-*/\r\ndisease_cesium.cesium_zoom = function(){\r\n\t\r\n\tvar _this = this;\r\n\t\r\n\t_viewer.scene.screenSpaceCameraController.minimumZoomDistance = disease_user.zoomToAltitude(_this.maxZoom);\r\n\t_viewer.scene.screenSpaceCameraController.maximumZoomDistance = disease_user.zoomToAltitude(_this.minZoom);\r\n\t_viewer.camera.percentageChanged = 0;\r\n\t\r\n\tconst listener = () => {\r\n\t\tvar camera_height = _viewer.camera.positionCartographic.height,\r\n//\t\t\tcenter = $.getCenterPoint(),\r\n\t\t\tzoom = disease_user.altitudeToZoom(camera_height),\r\n\t\t\tmath_zoom = Math.round(zoom);\r\n\t\t\r\n\t\t/*center.push(camera_height);\r\n\t\tvar positions = Cesium.Cartesian3.fromDegrees(center[0], center[1], center[2]),\r\n\t\t\t_position = new Cesium.Cartesian3(positions.x, positions.y, positions.z);\r\n\t\t\r\n\t\t_viewer.camera.position = _position;\r\n\t\t\r\n\t\tconsole.log(_position);\r\n\t\tconsole.log(_viewer.camera.position);*/\r\n\t\t\r\n\t\t\r\n\t\tif(math_zoom && (math_zoom != _this.camera_zoom)){\r\n\t\t\t_this.camera_zoom = Math.round(zoom);\r\n\t\t\t_this.zoom_level();\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t/*var camHeight = _viewer.camera.positionCartographic.height,\r\n\t\t\tisOutsideZoomLimits = false,\r\n\t\t\tdestHeight;\r\n\t\tif(camHeight < _this.minZoom){\r\n\t\t\tisOutsideZoomLimits = true;\r\n\t\t\tdestHeight = _this.minZoom;\r\n\t\t}else if(camHeight > _this.maxZoom){\r\n\t\t\tisOutsideZoomLimits = true;\r\n\t\t\tdestHeight = _this.maxZoom;\r\n\t\t}\r\n\t\tif(isOutsideZoomLimits){\r\n\t\t\tconst dest = Cesium.Cartesian3.fromRadians(\r\n\t\t\t\t_viewer.camera.positionCartographic.longitude,\r\n\t\t\t\t_viewer.camera.positionCartographic.latitude,\r\n\t\t\t\tdestHeight\r\n\t\t\t);\r\n\t\t\t_viewer.camera.position = dest;\r\n\t\t}*/\r\n\t};\r\n\tconst removeListener = _viewer.camera.changed.addEventListener(listener);\r\n\t_this.zoom_level();\r\n};\r\n\r\n/**/\r\ndisease_cesium.listen_cesium_body = function(dom, type){\r\n\tvar class_obj = {\r\n\t\t'disease_list': true,\r\n\t\t'disease_info': true,\r\n//\t\t\t'disease_player': false\r\n\t};\r\n\tvar width_arr = [],\r\n\t\tdom_width = 0;\r\n\tfor(var class_name in class_obj){\r\n\t\tvar bound_rect = $('#highway_disease .'+class_name)[0].getBoundingClientRect(),\r\n\t\t\tdisplay_type = $('#highway_disease .'+class_name).css('display'),\r\n\t\t\tbound_rect_type = ( bound_rect && bound_rect.left < -1 ) ? false : true,\r\n\t\t\twidth = $('#highway_disease .'+class_name)[0].offsetWidth - 10;\r\n\t\t\r\n\t\tif(class_name != dom && display_type == 'block' && bound_rect_type){\r\n\t\t\tif( class_name == 'screen_model' ){\r\n\t\t\t\twidth += 344;\r\n\t\t\t}\r\n\t\t\twidth_arr.push(width);\r\n\t\t}\r\n\t}\r\n\tif(type && class_obj[dom] ){\r\n\t\tdom_width = $('#highway_disease .'+dom)[0].offsetWidth - 10;\r\n\t}\r\n\t\r\n\twidth_arr.push(dom_width);\r\n\twidth_arr.sort(function(a,b) {\r\n\t\treturn b - a;\r\n\t});\r\n\t\r\n\tvar max_width = width_arr[0],\r\n\t\tmap_width = 'calc(100% - ' + max_width + 'px)';\r\n\t\r\n\t$('#cesium_map_parent .cesium_map_left').width(max_width);\r\n\t$('#cesium_map_parent #cesium_map').width(map_width);\r\n\t\r\n\tdisease_map.setResize();\r\n};\r\n\r\n/*3D tile*/\r\ndisease_cesium.add_3d_tile = function(){\r\n\treturn;\r\n\tif(!disease_user || !disease_user.current_adcode || !disease_user.current_adcode.dataVersion){\r\n\t\treturn false;\r\n\t}\r\n\tlet dataVersion = disease_user.current_adcode.dataVersion;\r\n\tlet _this = this;\r\n\twindow.tileset2 = _viewer.scene.primitives.add(new Cesium.Cesium3DTileset({\r\n\t\turl: config_url.datasets_adcode + dataVersion + '/tileset.json',\r\n\t\tskipLevelOfDetail: true,\r\n\t\tmaximumMemoryUsage: 1024,\r\n\t\t// preferLeaves: true,\r\n\t\t// dynamicScreenSpaceError: true,\r\n\t\t// foveatedTimeDelay: 1,\r\n\t\t// baseScreenSpaceError: 500,\r\n\t\t// immediatelyLoadDesiredLevelOfDetail: true\r\n\t}));\r\n\ttileset2.readyPromise.then(function () {\r\n\t\tconsole.log('Loaded tileset2');\r\n\t\t\r\n\t\t/*var boundingSphere = tileset2.boundingSphere;\r\n\t\tvar cartographic = Cesium.Cartographic.fromCartesian(boundingSphere.center);//\r\n\t\tvar surface = Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, 0.0);//      \r\n\t\tvar positions = [Cesium.Cartographic.fromDegrees(cartographic.longitude,cartographic.latitude)];\r\n\t\tvar promise = Cesium.sampleTerrainMostDetailed(_viewer.terrainProvider, positions);//terrainProviderProvider\r\n\t\tCesium.when(promise, function(updatedPositions) {\r\n\t\t\t var terrainHeight = updatedPositions[0].height;\t//\r\n\t\t\t var offset=Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, terrainHeight);\t//\r\n\t\t\t var translation = Cesium.Cartesian3.subtract(offset, surface, new Cesium.Cartesian3());\t//\r\n\t\t\t tileset2.modelMatrix = Cesium.Matrix4.fromTranslation(translation);\r\n\t\t});*/\r\n\t\t\r\n\t\t/*\r\n\t\tvar heightOffset = -35;\r\n\t\tvar boundingSphere = tileset2.boundingSphere;\r\n\t\tvar cartographic = Cesium.Cartographic.fromCartesian(boundingSphere.center);\r\n\t\tvar surface = Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, 0.0);\r\n\t\tvar offset = Cesium.Cartesian3.fromRadians(cartographic.longitude, cartographic.latitude, heightOffset);\r\n\t\tvar translation = Cesium.Cartesian3.subtract(offset, surface, new Cesium.Cartesian3());\r\n\t\ttileset2.modelMatrix = Cesium.Matrix4.fromTranslation(translation);\r\n\t\t*/\r\n\t\t\r\n\t}).otherwise(function (error) {\r\n\t\tconsole.log(error)\r\n\t});\r\n\t\r\n\t\r\n\t// HTML overlay for showing feature name on mouseover\r\n\tvar nameOverlay = document.createElement('div');\r\n\t_viewer.container.appendChild(nameOverlay);\r\n\tnameOverlay.className = 'backdrop';\r\n\tnameOverlay.style.display = 'none';\r\n\tnameOverlay.style.position = 'absolute';\r\n\tnameOverlay.style.bottom = '0';\r\n\tnameOverlay.style.left = '0';\r\n\tnameOverlay.style['pointer-events'] = 'none';\r\n\tnameOverlay.style.padding = '4px';\r\n\tnameOverlay.style.backgroundColor = 'black';\r\n\tnameOverlay.style.color = 'white';\r\n\t// Information about the currently selected feature\r\n\tvar selected = {\r\n\t\tfeature: undefined,\r\n\t\toriginalColor: new Cesium.Color()\r\n\t};\r\n\r\n\t// An entity object which will hold info about the currently selected feature for infobox display\r\n\tvar selectedEntity = new Cesium.Entity();\r\n\r\n\t// Get default left click handler for when a feature is not picked on left click\r\n\tvar clickHandler = _viewer.screenSpaceEventHandler.getInputAction(Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\r\n\t// If silhouettes are supported, silhouette features in blue on mouse over and silhouette green on mouse click.\r\n\t// If silhouettes are not supported, change the feature color to yellow on mouse over and green on mouse click.\r\n\tif (Cesium.PostProcessStageLibrary.isSilhouetteSupported(_viewer.scene)) {\r\n\t\t// Silhouettes are supported\r\n\t\tvar silhouetteBlue = Cesium.PostProcessStageLibrary.createEdgeDetectionStage();\r\n\t\tsilhouetteBlue.uniforms.color = Cesium.Color.BLUE;\r\n\t\tsilhouetteBlue.uniforms.length = 0.01;\r\n\t\tsilhouetteBlue.selected = [];\r\n\r\n\t\tvar silhouetteGreen = Cesium.PostProcessStageLibrary.createEdgeDetectionStage();\r\n\t\tsilhouetteGreen.uniforms.color = Cesium.Color.LIME;\r\n\t\tsilhouetteGreen.uniforms.length = 0.01;\r\n\t\tsilhouetteGreen.selected = [];\r\n\r\n\t\t_viewer.scene.postProcessStages.add(Cesium.PostProcessStageLibrary.createSilhouetteStage([silhouetteBlue, silhouetteGreen]));\r\n\r\n\t\t// Silhouette a feature blue on hover.\r\n\t\t_viewer.screenSpaceEventHandler.setInputAction(function onMouseMove(movement) {\r\n\t\t\t// If a feature was previously highlighted, undo the highlight\r\n\t\t\tsilhouetteBlue.selected = [];\r\n\r\n\t\t\t// Pick a new feature\r\n\t\t\tvar pickedFeature = _viewer.scene.pick(movement.endPosition);\r\n\t\t\tvar cesium_map_left = $('.cesium_map_left').width();\r\n\t\t\tif (!Cesium.defined(pickedFeature)) {\r\n\t\t\t\tnameOverlay.textContent='';\r\n\t\t\t\tnameOverlay.style.display = 'none';\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pickedFeature instanceof Cesium.Cesium3DTileFeature) {\r\n\t\t\t\t// A feature was picked, so show it's overlay content\r\n\t\t\t\tif (pickedFeature.hasProperty('road_name')) {\r\n\t\t\t\t\tnameOverlay.style.display = 'block';\r\n\t\t\t\t\tnameOverlay.style.bottom = _viewer.canvas.clientHeight - movement.endPosition.y + 'px';\r\n\t\t\t\t\tnameOverlay.style.left = movement.endPosition.x + cesium_map_left + 'px';\r\n\t\t\t\t\tvar name = pickedFeature.getProperty('road_name');\r\n\t\t\t\t\tif (!Cesium.defined(name)) {\r\n\t\t\t\t\t\tname = pickedFeature.getProperty('id');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar type = pickedFeature.getProperty('type');\r\n\t\t\t\t\tvar type_name = '';\r\n\t\t\t\t\tif (type == 16) {\r\n\t\t\t\t\t\ttype_name = '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar detail = '';\r\n\t\t\t\t\tif (type == 15) {\r\n\t\t\t\t\t\tdetail = pickedFeature.getProperty('kilometre') + '';\r\n\t\t\t\t\t} else if (type == 16) {\r\n\t\t\t\t\t\tdetail = pickedFeature.getProperty('kilometre') + \".\" + pickedFeature.getProperty('hectometre') + '';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tnameOverlay.textContent = type_name + name + \"-\" + detail;\r\n\r\n\t\t\t\t\t// Highlight the feature if it's not already selected.\r\n\t\t\t\t\tif (pickedFeature !== selected.feature) {\r\n\t\t\t\t\t\tsilhouetteBlue.selected = [pickedFeature];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n\t\t// Silhouette a feature on selection and show metadata in the InfoBox.\r\n\t\t_viewer.screenSpaceEventHandler.setInputAction(function onLeftClick(movement) {\r\n\t\t\t// If a feature was previously selected, undo the highlight\r\n\t\t\tsilhouetteGreen.selected = [];\r\n\r\n\t\t\t// Pick a new feature\r\n\t\t\tvar pickedFeature = _viewer.scene.pick(movement.position);\r\n\t\t\tif (!Cesium.defined(pickedFeature)) {\r\n\t\t\t\tclickHandler(movement);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (pickedFeature instanceof Cesium.Cesium3DTileFeature) {\r\n\t\t\t\t// A feature was picked, so show it's overlay content\r\n\t\t\t\tif (pickedFeature.hasProperty('road_name')) {\r\n\t\t\t\t\t// Select the feature if it's not already selected\r\n\t\t\t\t\tif (silhouetteGreen.selected[0] === pickedFeature) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Save the selected feature's original color\r\n\t\t\t\t\tvar highlightedFeature = silhouetteBlue.selected[0];\r\n\t\t\t\t\tif (pickedFeature === highlightedFeature) {\r\n\t\t\t\t\t\tsilhouetteBlue.selected = [];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Highlight newly selected feature\r\n\t\t\t\t\tsilhouetteGreen.selected = [pickedFeature];\r\n\r\n\t\t\t\t\t// Set feature infobox description\r\n\t\t\t\t\tvar featureName = pickedFeature.getProperty('road_name');\r\n\t\t\t\t\tselectedEntity.name = featureName;\r\n\t\t\t\t\tselectedEntity.description = 'Loading <div class=\"cesium-infoBox-loading\"></div>';\r\n\t\t\t\t\t_viewer.selectedEntity = selectedEntity;\r\n\t\t\t\t\tselectedEntity.description = '<table class=\"cesium-infoBox-defaultTable\"><tbody>' +\r\n\t\t\t\t\t\t'<tr><th></th><td>' + pickedFeature.getProperty('road_name') + '</td></tr>' +\r\n\t\t\t\t\t\t'<tr><th></th><td>' + pickedFeature.getProperty('kilometre') + '</td></tr>' +\r\n\t\t\t\t\t\t'<tr><th></th><td>' + pickedFeature.getProperty('hectometre') + '</td></tr>' +\r\n\t\t\t\t\t\t'</tbody></table>';\r\n\t\t\t\t\t//alert(selectedEntity.description);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\t\t/*-*/\r\n\t\t_viewer.screenSpaceEventHandler.setInputAction(function onRightClick(movement) {\r\n\t\t\t_this.cesium_popup_mark(movement);\r\n\t\t}, Cesium.ScreenSpaceEventType.RIGHT_CLICK);\r\n\t} else {\r\n\t\t// Silhouettes are not supported. Instead, change the feature color.\r\n\r\n\t\t// Information about the currently highlighted feature\r\n\t\tvar highlighted = {\r\n\t\t\tfeature: undefined,\r\n\t\t\toriginalColor: new Cesium.Color()\r\n\t\t};\r\n\r\n\t\t// Color a feature yellow on hover.\r\n\t\t_viewer.screenSpaceEventHandler.setInputAction(function onMouseMove(movement) {\r\n\t\t\t// If a feature was previously highlighted, undo the highlight\r\n\t\t\tif (Cesium.defined(highlighted.feature)) {\r\n\t\t\t\thighlighted.feature.color = highlighted.originalColor;\r\n\t\t\t\thighlighted.feature = undefined;\r\n\t\t\t}\r\n\t\t\t// Pick a new feature\r\n\t\t\tvar pickedFeature = _viewer.scene.pick(movement.endPosition);\r\n\t\t\tvar cesium_map_left = $('.cesium_map_left').width();\r\n\t\t\tif (!Cesium.defined(pickedFeature)) {\r\n\t\t\t\tnameOverlay.style.display = 'none';\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// A feature was picked, so show it's overlay content\r\n\t\t\tnameOverlay.style.display = 'block';\r\n\t\t\tnameOverlay.style.bottom = _viewer.canvas.clientHeight - movement.endPosition.y + 'px';\r\n\t\t\tnameOverlay.style.left = movement.endPosition.x + cesium_map_left + 'px';\r\n\t\t\tvar name = pickedFeature.getProperty('name');\r\n\t\t\tif (!Cesium.defined(name)) {\r\n\t\t\t\tname = pickedFeature.getProperty('id');\r\n\t\t\t}\r\n\t\t\tnameOverlay.textContent = name;\r\n\t\t\t// Highlight the feature if it's not already selected.\r\n\t\t\tif (pickedFeature !== selected.feature) {\r\n\t\t\t\thighlighted.feature = pickedFeature;\r\n\t\t\t\tCesium.Color.clone(pickedFeature.color, highlighted.originalColor);\r\n\t\t\t\tpickedFeature.color = Cesium.Color.YELLOW;\r\n\t\t\t}\r\n\t\t}, Cesium.ScreenSpaceEventType.MOUSE_MOVE);\r\n\r\n\t\t// Color a feature on selection and show metadata in the InfoBox.\r\n\t\t_viewer.screenSpaceEventHandler.setInputAction(function onLeftClick(movement) {\r\n\t\t\t// If a feature was previously selected, undo the highlight\r\n\t\t\tif (Cesium.defined(selected.feature)) {\r\n\t\t\t\tselected.feature.color = selected.originalColor;\r\n\t\t\t\tselected.feature = undefined;\r\n\t\t\t}\r\n\t\t\t// Pick a new feature\r\n\t\t\tvar pickedFeature = _viewer.scene.pick(movement.position);\r\n\t\t\tif (!Cesium.defined(pickedFeature)) {\r\n\t\t\t\tclickHandler(movement);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Select the feature if it's not already selected\r\n\t\t\tif (selected.feature === pickedFeature) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tselected.feature = pickedFeature;\r\n\t\t\t// Save the selected feature's original color\r\n\t\t\tif (pickedFeature === highlighted.feature) {\r\n\t\t\t\tCesium.Color.clone(highlighted.originalColor, selected.originalColor);\r\n\t\t\t\thighlighted.feature = undefined;\r\n\t\t\t} else {\r\n\t\t\t\tCesium.Color.clone(pickedFeature.color, selected.originalColor);\r\n\t\t\t}\r\n\t\t\t// Highlight newly selected feature\r\n\t\t\tpickedFeature.color = Cesium.Color.LIME;\r\n\t\t\t// Set feature infobox description\r\n\t\t\tvar featureName = pickedFeature.getProperty('name');\r\n\t\t\tselectedEntity.name = featureName;\r\n\t\t\tselectedEntity.description = 'Loading <div class=\"cesium-infoBox-loading\"></div>';\r\n\t\t\t_viewer.selectedEntity = selectedEntity;\r\n\t\t\tselectedEntity.description = '<table class=\"cesium-infoBox-defaultTable\"><tbody>' +\r\n\t\t\t\t'<tr><th>BIN</th><td>' + pickedFeature.getProperty('BIN') + '</td></tr>' +\r\n\t\t\t\t'<tr><th>DOITT ID</th><td>' + pickedFeature.getProperty('DOITT_ID') + '</td></tr>' +\r\n\t\t\t\t'<tr><th>SOURCE ID</th><td>' + pickedFeature.getProperty('SOURCE_ID') + '</td></tr>' +\r\n\t\t\t\t'<tr><th>Longitude</th><td>' + pickedFeature.getProperty('longitude') + '</td></tr>' +\r\n\t\t\t\t'<tr><th>Latitude</th><td>' + pickedFeature.getProperty('latitude') + '</td></tr>' +\r\n\t\t\t\t'<tr><th>Height</th><td>' + pickedFeature.getProperty('height') + '</td></tr>' +\r\n\t\t\t\t'<tr><th>Terrain Height (Ellipsoid)</th><td>' + pickedFeature.getProperty('TerrainHeight') + '</td></tr>' +\r\n\t\t\t\t'</tbody></table>';\r\n\t\t}, Cesium.ScreenSpaceEventType.LEFT_CLICK);\r\n\t\t/*-*/\r\n\t\t_viewer.screenSpaceEventHandler.setInputAction(function onRightClick(movement) {\r\n\t\t\t_this.cesium_popup_mark(movement);\r\n\t\t}, Cesium.ScreenSpaceEventType.RIGHT_CLICK);\r\n\t}\r\n//\t    this.postRender();\r\n};\r\n\r\n/*postrender,*/\r\ndisease_cesium.postRender = function(){\r\n   _viewer.scene.postRender.addEventListener(function() {\r\n\t\tif(disease_cesium.camera_zoom > 17){\r\n\t\t\tvar entitys = disease_player.current_disease || {};\r\n\t\t\tfor(var id in entitys){\r\n\t\t\t\tvar _entity = entitys[id],\r\n\t\t\t\t\t_show = _entity.show,\r\n\t\t\t\t\tnodes = _entity._nodes,\r\n\t\t\t\t\tnew_nodes = [],\r\n\t\t\t\t\tpoints_center = $.getPointsCenter(nodes, true);\r\n\t\t\t\t\r\n\t\t\t\tfor(var i=0; i<nodes.length; i++){\r\n\t\t\t\t\tvar positions = Cesium.Cartesian3.fromDegrees(nodes[i][0], nodes[i][1], nodes[i][2]);\r\n//\t\t    \t\t\t\tnew_positions = _viewer.scene.clampToHeight(positions, [_entity]);\r\n\t\t\t\t\tconsole.log(positions)\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n   });\r\n};\r\n\r\nexport {\r\n    disease_cesium\r\n};\r\n\r\n// module.exports = disease_cesium;\r\n\r\n\r\n\r\n\r\n\r\n\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_centre\r\n} from './disease_centre.js';\r\n\r\nvar data_other = {};\r\n\r\ndata_other.findDatas = function(){\r\n\tdata_other.centre_list()\r\n}\r\n\r\ndata_other.centre_list = function(page=false){\r\n\tlet road = $(\".select_data_other span.select_value\")[0].name;\r\n\tvar _table = `\r\n\t\t<table id=\"data_other_table\"></table>\r\n\t`;\r\n\t$('#data_center .data_other_body').html(_table);\r\n\tif(!disease_user.current_adcode || !road){\r\n\t\treturn;\r\n\t}\r\n\tvar dataVersion = disease_user.current_adcode.dataVersion;\r\n\tvar _url = config_url.pdds + Disease.TYPE_LIST.URLS.ROAD_WIDTH,\r\n\t// var _url = config_url.pdds + 'data/road_maintenance/queryPage',\r\n\t\t_h = $('.data_other').height() - 192 - 56,\r\n\t\t_current = page || 1,\r\n\t\t_this = disease_centre;\r\n\tvar myTable = $('#data_other_table').bootstrapTable({\r\n\t\turl: _url,\r\n\t\tmethod: 'POST',\r\n//\t        height: _h,\r\n\t\tuniqueId: 'id',                        // ID\r\n\t\tstriped: false,                        //\r\n\t\tcache: false,                          //true*\r\n\t\tsidePagination: 'server',              //clientserver*\r\n\t\tajaxOptions: {\r\n\t\t\theaders: {\r\n\t\t\t\t'Authorization': token\r\n\t\t\t}\r\n\t\t},\r\n\t\tdataField: 'rows',\r\n\t\tundefinedText: \"-\",\r\n\t\tpagination: true,                      //\r\n\t\tpageNumber: _current,\r\n\t\tpageSize: 12,\r\n\t\tdata_local: \"zh-CN\",\r\n\t\tshowPaginationSwitch: false,\r\n\t\tpaginationLoop: false,\r\n\t\t\r\n\r\n\t\tonClickRow:function (row,$element,field) {\r\n\t\t\tif( field == 'cesium_map' ){\r\n\t\t\t\tlet classNames =  $element.prevObject[0].firstElementChild.className;\r\n\t\t\t\tif( classNames.indexOf('button_control') > -1 ){\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tdisease_centre.cesium_map(row);\r\n\t\t\t}else if(field == 'REMARK'){\r\n\t\t\t\tvar d_coords = row.properties.D_COORDS || '';\r\n\t\t\t\tdisease_centre.copy_infos(d_coords);\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\tqueryParams : function (params) {\r\n\t\t\tvar _page = (params.offset / params.limit) + 1;\r\n\t\t\tvar temp = {\r\n\t\t\t\t\"sort\": [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t  \"k\": \"MP_CODE\",\r\n\t\t\t\t\t  \"order\": \"asc\"\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t\"ops\": [{\r\n\t\t\t\t\t\"k\": \"LINK_CODE\",\r\n\t\t\t\t\t\"type\": \"string\",\r\n\t\t\t\t\t\"v\": road,\r\n\t\t\t\t\t\"op\": \"eq\"\r\n\t\t\t\t}],\r\n\t\t\t\t\"page\": {\r\n\t\t\t\t\t\"totalPages\": 0,\r\n\t\t\t\t\t\"count\": 10000000,\r\n\t\t\t\t\t\"pageNo\": _page,\r\n\t\t\t\t\t\"pageSize\": 12\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\treturn JSON.stringify(temp);\r\n\t\t},\r\n\t\t\r\n\t\tcolumns: disease_centre.table_columns(\"data_other\"),\r\n\t\t\r\n\t\tresponseHandler: function (data) {\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView('');\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar _data = data.result.data.features || data.result.data || [],\r\n\t\t\t\tres = {\r\n\t\t\t\t\trows: _data,\r\n\t\t\t\t\ttotal: data.result.page.count\r\n\t\t\t\t};\r\n\t\t\treturn res;\r\n\t\t},\r\n\t\tformatLoadingMessage: function(data){\r\n\t\t\treturn \"...\";\r\n\t\t},\r\n\t\tformatNoMatches: function(data){\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tonLoadError: function (data) {\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tonLoadSuccess: function (data) {\r\n\t\t\tif(data.total){\r\n\t\t\t\t_this.table_pagination_init({\r\n\t\t\t\t\t'data': data,\r\n\t\t\t\t\t'page': page,\r\n\t\t\t\t\t'id': 'data_other_table',\r\n\t\t\t\t\t'type': false,\r\n\t\t\t\t\t'class': 'data_other_body',\r\n\t\t\t\t\t'value': 2\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\tmyTable.bootstrapTable('hideLoading');\r\n\t/*$.postAjax({\r\n\t\turl: _url,\r\n\t\tdata: data,\r\n\t\tcallback: function(data){\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView(data.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar _data = data.result.data.features || [];\r\n\t\t\tconsole.log(_data);\r\n\t\t}\r\n\t})*/\r\n\t\r\n\t$('#data_other_table').on('mouseover', 'a.remarks', function (e) {\r\n\t\tvar row_index = e.target.parentElement.parentElement.sectionRowIndex;\r\n\t\tvar row = $(\"#data_other_table\").bootstrapTable(\"getData\")[row_index];\r\n\t\tdisease_centre.open_remark(row, e.target);\r\n\t})\r\n\t$('#data_other_table').on('mouseout', 'a.remarks', function (e) {\r\n\t\tdisease_centre.close_remark();\r\n\t})\r\n\t\r\n};\r\n\r\n\r\nexport {\r\n    data_other\r\n};\r\n","\r\n\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\n\r\nvar disease_group = {};\r\n/*ZOOM*/\r\ndisease_group.point_group = function(){\r\n\tvar zoom = _viewer.camera.mathZoom;\r\n\t\r\n\tif(!disease_list.data_point || !disease_list.data_point.length){\r\n\t\treturn;\r\n\t}\r\n\tvar entities = _viewer.entities;\r\n\tthis.entity_hide();\r\n\tif(disease_player.position_icon){\r\n\t\treturn;\r\n\t}\r\n\tif(zoom > 17){\r\n\t\tfor(var i=0; i<disease_list.data_point.length; i++){\r\n\t\t\tdisease_list.data_point[i].show = true;\r\n\t\t}\r\n\t}else if(15 < zoom && zoom < 18){\r\n//\t\t}else if(14 < zoom && zoom < 18){\r\n\t\tfor(var mp_code in disease_list.data_groups.mp_code){\r\n\t\t\tvar _entity = entities.getById(mp_code);\r\n\t\t\tif(_entity){\r\n\t\t\t\t_entity.show = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}else if(11 < zoom && zoom < 16){\r\n//\t\t}else if(11 < zoom && zoom < 15){\r\n\t\tfor(var link_code in disease_list.data_groups.link_code){\r\n\t\t\tvar _entity = entities.getById(link_code);\r\n\t\t\tif(_entity){\r\n\t\t\t\t_entity.show = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}else{\r\n\t\tfor(var road_code in disease_list.data_groups.road_code){\r\n\t\t\tvar _entity = entities.getById(road_code);\r\n\t\t\tif(_entity){\r\n\t\t\t\t_entity.show = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t$.cesium_refresh();\r\n};\r\n\r\n/*entity*/\r\ndisease_group.entity_hide = function(type = false){\r\n\tvar entities = _viewer.entities;\r\n\tfor(var i=0; i<entities.values.length; i++){\r\n\t\tif(!entities.values[i]._position_type && !entities.values[i]._mark_type && !entities.values[i]._data_type){\r\n\t\t\tentities.values[i].show = type;\r\n\t\t}\r\n\t}\r\n\t$.cesium_refresh();\r\n};\r\n\r\n/**/\r\ndisease_group.list_group = function(){\r\n\tdisease_list.data_groups.road_code = _.groupBy(disease_list.catchList, function (n) {\r\n\t\treturn n.properties.LINK_CODE; \r\n\t});\r\n\tdisease_list.data_groups.link_code = _.groupBy(disease_list.catchList, function (n) {\r\n\t\tvar new_code = n.properties.mp_codes_0 + '_' + n.properties.mp_codes_1;\r\n\t\treturn new_code;\r\n\t});\r\n\tdisease_list.data_groups.mp_code = _.groupBy(disease_list.catchList, function (n) {\r\n\t\tvar new_code = n.properties.mp_codes_0 + '_' + n.properties.mp_codes_1 + '_' + n.properties.mp_codes_2;\r\n\t\treturn new_code;\r\n\t});\r\n//\t\twindow.data_groups = disease_list.data_groups;\r\n\t\r\n\t/**/\r\n\tvar _height = 1;\r\n\tfor(var road_code in disease_list.data_groups.road_code){\r\n\t\t_height += 30;\r\n\t\tvar links = disease_list.data_groups.road_code[road_code],\r\n\t\t\tlength = links.length.toString().length,\r\n\t\t\ticon_url = './Apps/Dist/Img/label_background_'+ length +'.png',\r\n\t\t\twidth = 36 + (length - 1) * 9;\r\n\t\t\r\n\t\tvar center = $.getNearPoint(links);\r\n\t\t$.add_group_billboard({\r\n\t\t\t'positions': center,\r\n\t\t\t'mp_code': road_code,\r\n\t\t\t'properties': links,\r\n\t\t\t'icon_url': icon_url,\r\n\t\t\t'icon_length': length,\r\n\t\t\t'height': _height,\r\n\t\t\t'width': width,\r\n\t\t\t'links': links\r\n\t\t})\r\n\t}\r\n\t\r\n\t/**/\r\n\tvar _heights = {};\r\n\tfor(var link_code in disease_list.data_groups.link_code){\r\n\t\t\r\n\t\tvar roadcode = link_code.split('_')[0] || '';\r\n\t\tif(_heights[roadcode]){\r\n\t\t\t_heights[roadcode] += 3;\r\n\t\t}else{\r\n\t\t\t_heights[roadcode] = 1;\r\n\t\t}\r\n\t\t\r\n\t\tvar links = disease_list.data_groups.link_code[link_code],\r\n\t\t\tlength = links.length.toString().length,\r\n\t\t\ticon_url = './Apps/Dist/Img/label_background_'+ length +'.png',\r\n\t\t\twidth = 36 + (length - 1) * 9;\r\n\t\t\r\n\t\tvar center = $.getNearPoint(links);\r\n\t\t$.add_group_billboard({\r\n\t\t\t'positions': center,\r\n\t\t\t'mp_code': link_code,\r\n\t\t\t'properties': links,\r\n\t\t\t'icon_url': icon_url,\r\n\t\t\t'icon_length': length,\r\n\t\t\t'height': _heights[roadcode],\r\n\t\t\t'width': width,\r\n\t\t\t'links': links\r\n\t\t})\r\n\t}\r\n\t\r\n\t/**/\r\n\t_heights = {};\r\n\tfor(var mp_code in disease_list.data_groups.mp_code){\r\n\t\t\r\n\t\tvar mapcode = mp_code.split('_')[1] || '',\r\n\t\t\tlinkcode = mp_code.split('_')[0] || '',\r\n\t\t\theight_code = linkcode + '_' + mapcode;\r\n\t\tif(_heights[height_code]){\r\n\t\t\t_heights[height_code] += 3;\r\n\t\t}else{\r\n\t\t\t_heights[height_code] = 1;\r\n\t\t}\r\n\t\t\r\n\t\tvar codes = disease_list.data_groups.mp_code[mp_code],\r\n\t\t\tlength = codes.length.toString().length,\r\n\t\t\ticon_url = './Apps/Dist/Img/label_background_'+ length +'.png',\r\n\t\t\twidth = 36 + (length - 1) * 9;\r\n\t\t\r\n\t\tvar center = $.getNearPoint(codes);\r\n\t\t$.add_group_billboard({\r\n\t\t\t'positions': center,\r\n\t\t\t'mp_code': mp_code,\r\n\t\t\t'properties': codes,\r\n\t\t\t'icon_url': icon_url,\r\n\t\t\t'icon_length': length,\r\n\t\t\t'height': _heights[height_code],\r\n\t\t\t'width': width,\r\n\t\t\t'links': codes\r\n\t\t})\r\n\t}\r\n\tthis.point_group();\r\n};\r\n\r\nexport {\r\n    disease_group\r\n};\r\n\r\n// module.exports = disease_group;\r\n\r\n\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\nimport {\r\n    disease_cesium\r\n} from './disease_cesium.js';\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\nimport {\r\n    disease_leaflet\r\n} from './disease_leaflet.js';\r\n\r\nvar disease_info = {};\r\n\r\ndisease_info.current_info = null;\t//\r\ndisease_info.info_ways = null;\t\t//\r\ndisease_info.jump_type = false;\t\t//\r\n\r\n/*--*/\r\ndisease_info.come_to_info = function(result, type=false, junge=false, change_type=false){\r\n\tdisease_info.jump_type = false;\r\n\tif(!change_type){\r\n\t\tdisease_player.recog_result = '2';\r\n\t}\r\n\tthis.info_init(result, type, junge, change_type);\r\n\t\r\n\tlet display = $('.disease_info').css('display');\r\n\tif(display == 'none'){\r\n\t\t$('.disease_info').fadeIn(100, function(){\r\n\t\t\tdisease_cesium.listen_cesium_body('disease_info', true);\r\n\t\t\tdisease_player.request_track(true);\r\n\t\t});\r\n\t}else{\r\n\t\tdisease_player.request_track(true);\r\n\t}\r\n};\r\n\r\ndisease_info.info_init = function(result, type=false, junge=false, change_type=false) {\r\n\r\n//\t\tlet ratio_width = 620 / 2448,\r\n//\t\t\tratio_height = ratio_width * 2048,\r\n//\t\t\t_height = Number(ratio_height);\r\n\r\n//\t\t$('.disease_info .video_image').css('height', _height);\r\n//\t\t$('.disease_player_body .player_image #canvas_three').css('height', _height);\r\n\t\r\n\tthis.current_info = result;\r\n\t\r\n\tdisease_list.list_toggle(type, junge);\r\n\tdisease_leaflet.visua_up_map_init('visua_up_map');\r\n\t/*this.polygon_info();\r\n\tdisease_list.list_toggle(type, junge);*/\r\n\tvar token = $.getCookie('token') || '';\r\n\tif(!token){\r\n\t\t$.errorView('token');\r\n\t\tlet _url = './login.html';\r\n\t\twindow.open(_url, '_self');\r\n\t}\r\n\t\r\n\tlet type_list = window.Disease.TYPE_LIST.TYPES;\r\n\tlet properties = this.current_info.properties || {},\r\n\t\tinfo_view_type_2 = properties.mp_codes_0 + ' ' + properties.mp_codes_1 + properties.mp_codes_2 + ' ' + properties.cn_up_down,\r\n\t\tlane_no = properties.LANE_NO || '',\r\n\t\ttrack_point_id = properties.T_POINT_ID,\r\n\t\tlist_key = properties[type_list.KEY],\r\n\t\tthis_info = Disease.TYPE_LIST.TYPES.VALUES[list_key] || {'INFO': []},\r\n\t\t\r\n\t\t_area = properties.AREA || '0.0',\r\n\t\tswitch_area = Number(_area),\r\n\t\tinfo_view_result = [],\r\n\t\ttrack_image_url = config_url.krs + 'image/get?trackPointId=' + track_point_id + '&type=00&seq=005&imageType=jpg';\r\n\t\r\n\tconsole.log(properties);\r\n\tthis.info_statistics(properties);\r\n\t\r\n\tif(!change_type){\r\n\t\tdisease_player.player_start_init();\r\n\t}\r\n\t\r\n\t/*,*/\r\n\t$('.pdds_id').html(properties.ID);\r\n\t$('.pdds_types').html(properties._cn_type);\r\n\t$('.view_level').html(properties._cn_subtype);\r\n\t$('.info_view_type_2').html(info_view_type_2);\r\n\t$('.info_view_type_3').html(properties.update_time);\r\n\t\r\n\tif(Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS'){\r\n\t\tswitch_area = ': ' + Number(switch_area.toFixed(2)) + '';\r\n\t\tinfo_view_result.push(switch_area);\r\n\t}else if(Disease.TYPE_LIST.ID == 'ASSET_INSPECTION'){\r\n\t\tvar type_value = type_list.VALUES[properties.TYPE].SUBTYPE[properties.SUBTYPE];\r\n\t\tswitch_area = ': ' + type_value;\r\n\t\tinfo_view_result.push(switch_area);\r\n\t\t\r\n\t\tif(properties.TYPE == '701' || properties.TYPE == '702'){\r\n\t\t\tlet length_v = Number(properties.LENGTH) || '';\r\n\t\t\tlet length_n = length_v ? Number( length_v.toFixed(2) ) : '-';\r\n\t\t\tlet length_t = ': ' + length_n + 'm';\r\n\t\t\tinfo_view_result.push(\r\n\t\t\t\tlength_t\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\t\r\n    /**/\r\n    for(var i=0; i<this_info.INFO.length; i++){\r\n        var _id = this_info.INFO[i].ID,\r\n            _val = this_info.INFO[i].VAL,\r\n            _type = this_info.INFO[i].TYPE,\r\n            _length = this_info.INFO[i].LENGTH,\r\n            ext_info = this_info.INFO[i].EXT_INFO,\r\n            valInfo = {};\r\n        if(ext_info){\r\n            valInfo = properties[ext_info] || {};\r\n        }else{\r\n            valInfo = properties || {};\r\n        }\r\n        var _name = this_info.INFO[i].NAME,\r\n            _newval = valInfo[_id] || '-',\r\n            newVal = _val ? (valInfo[_id] || '0.0') : _newval,\r\n            switch_val = _val ? Number(newVal) : newVal;\r\n        \r\n        if(_type){\r\n            switch_val = switch_val * 1000;\r\n        }\r\n        if(_length){\r\n            switch_val = switch_val.toFixed(_length);\r\n            switch_val = Number(switch_val);\r\n        }\r\n        \r\n        var _text = _name + ': ' + switch_val + _val;\r\n        info_view_result.push(_text)\r\n    }\r\n\t\r\n\t\r\n\t\r\n//\t\t$.getImageToken(\r\n//\t\t\t$('.disease_info .info_image img'),\r\n//\t\t\ttrack_image_url\r\n//\t\t);\r\n\t\r\n\tlet param_html = `\r\n\t\t${info_view_result.map(f => `\r\n\t\t\t<span>${f}</span>\r\n\t\t`).join('')}\r\n\t`;\r\n\t$('.info_view .info_view_param').html(param_html);\r\n\t\r\n\t$('.menu_list ul li').removeClass('active');\r\n\tthis.pd_label_types();\r\n};\r\n\r\n/**/\r\ndisease_info.info_statistics = function(properties){\r\n\tif(Disease.TYPE_LIST.ID == 'ASSET_INSPECTION'){\r\n\t\treturn;\r\n\t}\r\n\t$('.info_view_statistics .statistics_list').html('');\r\n\tlet _url = config_url.pdds + 'data/stat/pd/countGroup',\r\n\t\tmap_code_param = {'groupKeys': ['TYPE'],'ops': [{'k': 'MP_CODE','v': properties.MP_CODE,'op': 'eq'}]};\r\n\t\r\n\t$.postAjax({\r\n\t\turl: _url,\r\n\t\tdata: map_code_param,\r\n\t\tcallback: function(data){\r\n\t\t\tlet type_arr = data.result || [],\r\n\t\t\t\t_texts = [];\r\n\t\t\tfor(let i=0; i<type_arr.length; i++){\r\n\t\t\t\tlet _type = type_arr[i].TYPE,\r\n\t\t\t\t\t_count = type_arr[i].count,\r\n\t\t\t\t\t_info = Disease.TYPE_LIST.TYPES.VALUES[_type] || {},\r\n\t\t\t\t\t_text = (_info.NAME || _type) + ' ' + _count + '';\r\n\t\t\t\t\r\n\t\t\t\t_texts.push(_text);\r\n\t\t\t}\r\n\t\t\tlet code_html = `\r\n\t\t\t\t${_texts.map(f => `\r\n\t\t\t\t\t<p>${f}</p>\r\n\t\t\t\t`).join('')}\r\n\t\t\t`;\r\n\t\t\t$('.info_view_statistics .statistics_list').html(code_html);\r\n\t\t}\r\n\t})\r\n};\r\n\r\n/*,*/\r\ndisease_info.polygon_info = function(type=false){\r\n\tvar geom = this.current_info.properties.locs,\r\n\t\tid = this.current_info.properties.T_POINT_ID;\r\n\tif(this.info_ways){\r\n\t\t_viewer.entities.remove(this.info_ways);\r\n\t}\r\n\t\r\n\tdisease_player.remove_entity();\r\n\t/**/\r\n\tif(!type){\r\n\t\tthis.info_ways = $.add_polygon({\r\n\t\t\t'type': 'position',\r\n\t\t\t'result': {\r\n\t\t\t\t'properties': {\r\n\t\t\t\t\t'ID': ('polygon_'+id),\r\n\t\t\t\t\t'locs': geom\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\t$.cesium_refresh();\r\n};\r\n\r\n/**/\r\ndisease_info.pd_label_types = function(){\r\n\t$('.menu_manage a.iconshenglvehao').removeClass('active');\r\n\tvar pd_id = this.current_info.properties.ID,\r\n\t\tpd_url = config_url.pdds + \"data/pd_label/query\",\r\n\t\tpd_body = {\r\n\t\t\t\"ops\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"k\": \"PD_ID\",\r\n\t\t\t\t\t\"type\": \"string\",\r\n\t\t\t\t\t\"v\": pd_id,\r\n\t\t\t\t\t\"op\": \"eq\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t};\r\n\t$.postAjax({\r\n\t\turl: pd_url,\r\n\t\tdata: pd_body,\r\n\t\tcallback: function(data){\r\n\t\t\tlet features = (data.result && data.result.data) ? data.result.data.features.length : 0\r\n\t\t\tif(features){\r\n\t\t\t\t$('.menu_list .menu_list_child .menu_collect').addClass('active');\r\n\t\t\t\t$('.menu_manage a.iconshenglvehao').addClass('active');\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n};\r\n\r\nexport {\r\n    disease_info\r\n};\r\n\r\n// module.exports = disease_info;\r\n\r\n\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    SlideList\r\n} from './disease_slide.js';\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_screen\r\n} from './disease_screen.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\nimport {\r\n    disease_cesium\r\n} from './disease_cesium.js';\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\nimport { cesium_player } from './play_window/cesium_player.js'\r\nimport {\r\n    disease_centre\r\n} from './disease_centre.js';\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\nimport {\r\n    disease_swiper\r\n} from './disease_swiper.js';\r\nimport {\r\n    disease_leaflet\r\n} from './disease_leaflet.js';\r\nimport { Evented } from './event_emitter';\r\n\r\nvar disease_init = {};\r\n\r\ndisease_init.play_image_type = 'visua_up_map';\t\t//\r\n\r\ndisease_init.models_init = function () {\r\n\r\n    var _this = this;\r\n\r\n    /**/\r\n    $('.button_other').mouseover(function () {\r\n        $('.user_install').css('display', 'block');\r\n    })\r\n    $('.button_other').mouseout(function () {\r\n        $('.user_install').css('display', 'none');\r\n    })\r\n    /**/\r\n    $('.button_other .user_install .user_handle').click(function () {\r\n        disease_user.userSignOut();\r\n    })\r\n    /**/\r\n    $('.button_other .user_install .user_config').click(function () {\r\n        let _url = './user.html';\r\n        window.open(_url, '_blank');\r\n    })\r\n    // checkbox--\r\n    $('.disease_info').on('change', 'label.checkbox_label input', function () {\r\n\t\tvar type = this.checked;\r\n\t\tcesium_player.change_toggle(type);\r\n    })\r\n    // \r\n    $('.disease_info').on('input', '.image_opacity_change', function () {\r\n\t\tvar num_op = this.value,\r\n\t\t\tra_op = Number( num_op ) || 0;\r\n\t\t\r\n\t\tcesium_player.change_alpha(ra_op);\r\n    })\r\n    /**/\r\n    $('.user_citys').mouseover(function () {\r\n        $('.user_citys .citys_list').css('display', 'block');\r\n    })\r\n    $('.user_citys').mouseout(function () {\r\n        $('.user_citys .citys_list').css('display', 'none');\r\n    })\r\n    /**/\r\n    $('.user_citys .citys_list li').click(function (e) {\r\n        let adcode = e.target.getAttribute('data-adcode'),\r\n            cityname = e.target.innerText,\r\n            newname = cityname.replace(/||||/ig, '');\r\n        $('.user_citys .citys_list li').removeClass('active');\r\n        $('.user_citys .citys_list').css('display', 'none');\r\n        $('.user_citys .citys_name').html(newname);\r\n        e.target.className = 'active';\r\n\t\t\r\n\t\twindow._evented.emit('click.cityChange', adcode)\r\n    })\r\n    /*-*/\r\n    $('.disease_list_screen a.screen_link').click(function () {\r\n        let type = $('.screen_model').css('display');\r\n        _this.screen_model_hide(type);\r\n        disease_screen.screen_icon(type);\r\n    })\r\n    /*-*/\r\n    $('.screen_model').on('click', '.screen_submit label a', function () {\r\n        var checkboxs = $('.screen_model_param input[type=\"checkbox\"]');\r\n        for (var i = 0; i < checkboxs.length; i++) {\r\n            checkboxs[i].checked = false;\r\n        }\r\n        disease_screen.subtype_change();\r\n    });\r\n    /*-*/\r\n    $('.screen_model').on('click', '.screen_submit button', function () {\r\n\t\t\r\n\t\twindow._evented.emit('click.screenChange');\r\n\t\t\r\n    });\r\n    /*--*/\r\n    $('.disease_info').on('click', '.info_view_button button', function () {\r\n        $.errorView('');\r\n        return;\r\n        $('.disease_swiper').toggle(200);\r\n    });\r\n    $('.disease_swiper .model_backdrop').click(function () {\r\n        $('.disease_swiper').toggle(200);\r\n    })\r\n    /*-*/\r\n    $('.disease_list .disease_list_body').on('click', '.disease_list_li', function () {\r\n\t\t/*\r\n\t\tdisease_screen.screen_icon();\r\n\t\t$('.screen_model').fadeOut(100,function(){\r\n\t\t\tdisease_cesium.listen_cesium_body('disease_info', true);\r\n\t\t});\r\n\t\t*/\r\n        disease_player.click_types = true;\r\n        var index = this.getAttribute('data-index');\r\n\t\tvar indexData =  disease_list.catchList[index] || {};\r\n        disease_info.come_to_info(indexData);\r\n\r\n        var active = Disease.TYPE_LIST.FUNBUTTON.find(function (data) {\r\n            return data.ACTIVE == 'active';\r\n        })\r\n        disease_init.player_mode_init(active.ID);\r\n    });\r\n    $('.disease_info').on('click', 'ul.info_tab_list li', function (e) {\r\n        let data_type = e.target.getAttribute('data-type');\r\n        _this.player_mode_init(data_type);\r\n        disease_init.image_type_go(true);\r\n    });\r\n    /*--:,,*/\r\n\t/*$('.disease_info').on('click', '.info_header a.info_header_close', function () {\r\n\t\t$('.disease_info').fadeOut(100);\r\n\t\tdisease_list.position_group_change();\r\n\t\tdisease_cesium.change_last_point();\r\n\t\tdisease_info.polygon_info(true);\r\n\t\tdisease_cesium.listen_cesium_body('disease_info', false);\r\n\t\t\r\n\t\t_this.player_mode_init('visua_up_map');\r\n\t});*/\r\n    /*--*/\r\n\t/*$('.disease_info').on('click', '.info_image', function () {\r\n\t\tdisease_info.polygon_info(true);\r\n\t\tdisease_player.player_start_init();\r\n\t\t$('.disease_player').fadeIn(100, function(){\r\n\t\t\tdisease_player.request_track(true);\r\n\t\t\tdisease_cesium.listen_cesium_body('disease_player', true);\r\n\t\t});\r\n\t});*/\r\n    /**/\r\n    $('.data_header .business_name').mouseover(function () {\r\n        var client = this.getBoundingClientRect(),\r\n            left = client.left - 24,\r\n            top = client.top + client.height - 14;\r\n\r\n        $('.data_header .business_list').css({\r\n            top: top + \"px\",\r\n            left: left + \"px\"\r\n        })\r\n        $('.data_header .business_list').css('display', 'block');\r\n        $('.data_header .business_list a span').attr('class', 'iconfont iconshangsanjiao');\r\n    })\r\n    $('.data_header .business_name').mouseout(function () {\r\n        $('.data_header .business_list').css('display', 'none');\r\n        $('.data_header .business_list a span').attr('class', 'iconfont iconxiasanjiao');\r\n    })\r\n    /*---*/\r\n    $('.button_list ul.business_list').on('click', 'li', function () {\r\n        var type = this.getAttribute('data-name') || '',\r\n            current_adcode = disease_user.current_adcode || {};\r\n\r\n        if (type && current_adcode.dataVersion) {\r\n            Disease.TYPE_LIST = Disease.business_list[type];\r\n            $('.button_list ul.business_list li').removeClass('active');\r\n            $('.button_list a.business_open')[0].firstChild.data = Disease.TYPE_LIST.NAME;\r\n            this.className = 'active';\r\n\t\t\t$('.disease_list_body').html('');\r\n\t\t\t$('.business_list').fadeOut(0);\r\n\t\t\t\r\n\t\t\twindow._evented.emit('click.businessChange')\r\n\t\t\t\r\n        }\r\n    });\r\n    /*-*/\r\n    $('.open_disease_list').on('click', 'a.left_arrow', function () {\r\n\t\tdisease_init.left_list_close();\r\n    });\r\n    /*-*/\r\n    $('.open_disease_list').on('click', 'a.right_arrow', function () {\r\n        $('.open_disease_list a').attr('class', 'left_arrow');\r\n        $(\".disease_list\").animate({\r\n            'left': '0px'\r\n        }, 300, 'swing', function () {\r\n            disease_cesium.listen_cesium_body('disease_list', true);\r\n        });\r\n    });\r\n    /**/\r\n    $('.disease_list_sort ul li a').click(function () {\r\n        var hasClass = $(this.parentNode).hasClass('active');\r\n        if (!hasClass) {\r\n            $('.disease_list_sort ul li').removeClass('active');\r\n            $(this.parentNode).addClass('active');\r\n            disease_screen.screen_search();\r\n        }\r\n\t\t/*var _type = this.parentNode.getAttribute('type');\r\n\t\tDisease.list_init();*/\r\n    })\r\n    /*--*/\r\n    $('.search_param ul li').click(function () {\r\n        $('.search_param ul li').removeClass('active');\r\n        $(this).addClass('active');\r\n        disease_centre.centre_init(this.type);\r\n        disease_player.player_icon_change(true);\r\n    })\r\n\r\n    $('.disease_list .disease_list_body').scroll(function (e) {\r\n        var scrollHeight = $('.disease_list .disease_list_body')[0].scrollHeight,\r\n            scrollTop = $('.disease_list .disease_list_body')[0].scrollTop,\r\n            clientHeight = $('.disease_list .disease_list_body')[0].clientHeight,\r\n            _height = scrollHeight - scrollTop - clientHeight;\r\n\r\n        if (scrollTop && _height <= 5) {\r\n            //\r\n            disease_list.chunk_list_change();\r\n        }\r\n    });\r\n    /*,*/\r\n    $(\".select_value input\").on(\"click\", function () {\r\n        $('.select_option').toggle();\r\n        $('.select_value').toggleClass(\"active\");\r\n    });\r\n    $(\".select_option li\").click(function (event) {\r\n        let val = event.target.getAttribute('data-name'),\r\n            text = event.target.innerText,\r\n            hide_type = (val == '1') ? 'block' : 'none',\r\n            hide_class = (val == '1') ? '' : true;\r\n\r\n        $('.select_option').toggle();\r\n        $('.select_value input').val(text);\r\n        $('.select_value input').attr('name', val);\r\n        $('.select_value').toggleClass(\"active\");\r\n\r\n        $('.feedback_model>div>p').css(\"display\", hide_type);\r\n\r\n        $('.feedback_model div textarea').removeClass('height');\r\n        if (val != '1') {\r\n            $('.feedback_model div textarea').addClass('height');\r\n        }\r\n\r\n    });\r\n    $('.screen_model').on('click', '.screen_model_param input[type=\"checkbox\"]', function () {\r\n        var type = this.getAttribute('name');\r\n        var type_list = Disease.TYPE_LIST.TYPES;\r\n        if (type == type_list.KEY) {\r\n            disease_screen.subtype_change();\r\n        }else if(type == 'all'){\r\n            var id =  this.getAttribute('data-name');\r\n            $('.screen_model .TYPE[name=\"' + id + '\"] input[type=\"checkbox\"]').prop('checked', this.checked);\r\n        }\r\n\r\n    });\r\n    /**/\r\n    $(\".feedback_submit\").click(function (event) {\r\n        _this.feedback_submit();\r\n    });\r\n    /**/\r\n    $(\"#mask_model\").click(function (event) {\r\n        SlideList.menu_feedbacks();\r\n    });\r\n};\r\n\r\n/*  */\r\ndisease_init.left_list_close = function(){\r\n\t$('.open_disease_list a').attr('class', 'right_arrow');\r\n\tdisease_cesium.listen_cesium_body('disease_list', false);\r\n\t$(\".disease_list\").animate({\r\n\t\t'left': '-339px'\r\n\t}, 300);\r\n}\r\n\r\ndisease_init.screen_model_hide = function (type) {\r\n    if (type == 'none') {\r\n        $('.screen_model').css('display', 'block');\r\n        $(\".screen_model\").animate({\r\n            'left': 344\r\n        }, 300, 'swing', function () {\r\n            $('.screen_model').css('z-index', '112');\r\n            disease_cesium.listen_cesium_body('screen_model', true);\r\n        });\r\n    } else {\r\n        $('.screen_model').css('z-index', '110');\r\n        $(\".screen_model\").animate({\r\n            'left': 0\r\n        }, 300, 'swing', function () {\r\n            $('.screen_model').css('display', 'none');\r\n        });\r\n        disease_cesium.listen_cesium_body('screen_model', false);\r\n    }\r\n};\r\n\r\n/*--*/\r\ndisease_init.player_mode_init = function (type) {\r\n\r\n    let new_class = 'player_video new_' + type;\r\n    $('.player_video').attr('class', new_class);\r\n\r\n    this.play_image_type = type;\r\n    $('.disease_info ul.info_tab_list li').removeClass('active');\r\n    $('.disease_info ul.info_tab_list li.' + type).addClass('active');\r\n    $('.video_image').fadeOut(0);\r\n    $('#' + type).fadeIn(0);\r\n};\r\n\r\n/**/\r\ndisease_init.image_type_go = function (type = false) {\r\n    // $('.result_list').hide();\r\n    if (this.play_image_type == 'visua_up_map') {\r\n        // $('.result_list').show();\r\n        disease_leaflet.road_player(type);\r\n\t\twindow.mbSideMap && window.mbSideMap.resize();\r\n    } else if (this.play_image_type == 'collect_map') {\r\n\t\ttype && disease_player.update_image();\r\n        disease_player.player_projection();\r\n    } else if (this.play_image_type == 'threed_map') {\r\n        // cesium_player._alpha = 1.0;\r\n        // $('.image_opacity .checkbox_label input')[0].checked = false;\r\n\t\t\r\n        var _type = $('.image_opacity .checkbox_label input')[0].checked;\r\n\t\tif(!_type){\r\n\t\t\tcesium_player.update();\r\n\t\t}\r\n        cesium_player.change_toggle(_type);\r\n    }\r\n};\r\n\r\n/**/\r\ndisease_init.feedback_submit = function () {\r\n    let type = $('.select_value input').attr('name') || '',\r\n        desc = $('textarea.desc').val() || '';\r\n    if (desc.length > 200) {\r\n        $.errorView('');\r\n        return;\r\n    }\r\n    let json = {\r\n        'pdId': disease_info.current_info.properties.ID,\r\n        'message': desc,\r\n        'type': type\r\n    },\r\n        url = config_url.pdds + 'feedback/save?pdId=' + json.pdId + '&message=' + json.message + '&type=' + json.type;\r\n    $.postAjax({\r\n        url: url,\r\n        data: json,\r\n        callback: function (data) {\r\n            if (data.code != '0') {\r\n                $.errorView(data.message);\r\n                return;\r\n            }\r\n            $.errorView(data.message, true);\r\n            SlideList.menu_feedbacks();\r\n        }\r\n    })\r\n};\r\n\r\n/**/\r\ndisease_init.business_change = function () {\r\n    // \r\n    var type_list = Disease.TYPE_LIST;\r\n    var _buttons = `\r\n\t\t${type_list.FUNBUTTON.map(f => `\r\n\t\t\t<button class=\"btn ${f.CLASS} ${f.CONTROL}\" name=\"${f.ID}\">${f.NAME}</button>\r\n\t\t`).join('')}\r\n\t`;\r\n    $('.cesium_popup .popup_content .image_buttons').html(_buttons);\r\n\r\n    // \r\n    var center_tab = $('.data_center_tab ul li');\r\n    for (let i = 0; i < center_tab.length; i++) {\r\n        center_tab[i].lastChild.data = type_list.LEFTTABS[i].NAME;\r\n    }\r\n\r\n    //  \r\n    var _player = `\r\n\t\t${type_list.FUNBUTTON.map(f => `\r\n\t\t\t<li class=\"${f.ID} ${f.ACTIVE} ${f.CONTROL}\" data-type=\"${f.ID}\">${f.NAME}</li>\r\n\t\t`).join('')}\r\n\t`;\r\n    $('.info_image .info_image_btn ul.info_tab_list').html(_player);\r\n\r\n    //  \r\n    var active = Disease.TYPE_LIST.FUNBUTTON.find(function (data) {\r\n        return data.ACTIVE == 'active';\r\n    })\r\n    disease_init.play_image_type = active.ID;\r\n\t\r\n\t$('#data_center').attr('class', type_list.ID);\r\n    $('#highway_disease').attr('class', type_list.ID);\r\n\t\r\n\tvar text = Disease.TYPE_LIST.TITLE;\r\n\t$('.info_header a.info_header_close').attr('title', '' + text + '');\r\n    $('.info_header div.menu_manage ul.menu_list_child li.menu_collect')[0].lastChild.data = '' + text;\r\n\t\r\n    // \r\n    // disease_centre.search_param();\r\n};\r\n\r\nexport {\r\n    disease_init\r\n};\r\n\r\n// module.exports = disease_init;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","\r\n\r\n/*-leaflet*/\r\n\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\n\r\nimport { visuaUpMapInit as mapboxMapInit } from './leftOrthograph/map_init.js';\r\nimport { addLayers as mapboxAddLayers } from './leftOrthograph/addLayers.js';\r\n\r\nvar disease_leaflet = {};\r\nvar lastInfoId = null;\r\n// var map;\r\nvar polygons = {};\r\nvar last_polygon = null;\r\n\r\ndisease_leaflet.visua_up_map_init = function(containerID , _mapOption){\r\n\tlastInfoId = null;\r\n\treturn mapboxMapInit(containerID, _mapOption);\r\n}\r\n\r\n/*--*/\r\ndisease_leaflet.road_player = function(type){\r\n\tlet _this = this;\r\n\tif(!window.mbSideMap){\r\n\t\tsetTimeout(function(){\r\n\t\t\t_this.road_player();\r\n\t\t}, 300)\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tlast_polygon = null;\r\n\t\r\n\tlet datas = disease_player.getTrackBufferResults(),\r\n\t\tfeatures = datas.features || [],\r\n\t\t_index = disease_player.current_num - 1,\r\n\t\t_view = disease_info.current_info,\r\n\t\tcurrent_id = disease_info.current_info.properties.ID,\r\n\t\ttrack = disease_player.track_list[_index],\r\n\t\t_center = [track.x, track.y];\r\n\t\r\n\t\r\n\t\r\n\tif( type && disease_player.current_num == disease_player.default_num ){\r\n\t\t_center = _view.center_xy;\r\n\t}\r\n\t\r\n\tif(!disease_info.jump_type){\r\n\t\tdisease_info.jump_type = true;\r\n\t}else{\r\n\t\twindow.mbSideMap.setCenter( [_center[0], _center[1]] );\r\n\t}\r\n\t\r\n\tif(lastInfoId == current_id){\r\n\t\treturn;\r\n\t}\r\n\tpolygons = {};\r\n\tif(features.length){\r\n\t\tlastInfoId = current_id;\r\n\t}\r\n\t\r\n\tmapboxAddLayers(features, current_id, window.mbSideMap, resultToggle);\r\n};\r\n\r\n/**/\r\ndisease_leaflet.disease_region = function(){\r\n\tresultToggle();\r\n};\r\n\r\nfunction toggleLayerVisible(type){\r\n\tlet polygons = window.mbSideMap.getLayer('polygons'),\r\n\t\tpolylines = window.mbSideMap.getLayer('polylines');\r\n\tpolygons && window.mbSideMap.setLayoutProperty('polygons', 'visibility', type);\r\n\tpolylines && window.mbSideMap.setLayoutProperty('polylines', 'visibility', type);\r\n}\r\n\r\n/*  */\r\nfunction resultToggle(){\r\n\tlet resultType = $('.result_list_group li.active').attr('type'),\r\n\t\tvisible = (resultType == '2') ? 'visible' : 'none',\r\n\t\tdisplay = (resultType == '1') ? 'block' : 'none';\r\n\t\r\n\ttoggleLayerVisible(visible);\r\n\t$('.geometriesLabel').css('display', display);\r\n}\r\n\r\nexport {\r\n    disease_leaflet\r\n};\r\n\r\n// module.exports = disease_leaflet;\r\n\r\n\r\n","/**\r\n * \r\n */\r\nimport {\r\n    disease_map\r\n} from './disease_main_map.js';\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_group\r\n} from './disease_group.js';\r\nimport {\r\n    disease_screen\r\n} from './disease_screen.js';\r\n\r\nvar disease_list = {};\r\n\r\ndisease_list.mark_points = null;\r\ndisease_list.catchList = null;\r\ndisease_list.catchListUTM = null;\r\ndisease_list.data_point = null;\r\ndisease_list.position_group = null;\r\ndisease_list.chunk_list = [];\r\ndisease_list.chunk_list_index = 0;\r\ndisease_list.page_type = true;\r\ndisease_list.page_param = {\r\n\t\"pageNo\": 1,\r\n\t\"pageSize\": 10\r\n};\r\ndisease_list.data_groups = {\r\n\t'link_code': null,\r\n\t'mp_code': null\r\n};\r\n\r\n/**/\r\ndisease_list.page_init = function(pages){\r\n\tvar obj = {\r\n\t\twrapid: 'page_lists',\t\t\t//id\r\n\t\tbtnCount: 6,\r\n\t\ttotal: pages.count,\t\t\t\t//\r\n\t\tpagesize: pages.pageSize,\t\t//10\r\n\t\tcurrentPage: pages.pageNo,\t\t//\r\n\t\tonPagechange: this.page_change,\r\n\t}\r\n\tpagination.init(obj);\r\n};\r\n\r\n/**/\r\ndisease_list.page_change = function(page){\r\n\tconsole.log(page)\r\n\tdisease_list.page_param.pageNo = page;\r\n\tdisease_screen.screen_search(true);\r\n};\r\n\r\n/**/\r\ndisease_list.list_init = function(param=[],junge=false) {\r\n\tvar _this = this;\r\n\tif(!disease_user.current_adcode){\r\n\t\treturn;\r\n\t}\r\n\tif(!junge){\r\n\t\t_this.page_param = {\r\n\t\t\t\"pageNo\": 1,\r\n\t\t\t\"pageSize\": 10\r\n\t\t};\r\n\t}\r\n\tparam.push({\r\n\t\t'k': 'DATA_VERSION',\r\n\t\t'v': disease_user.current_adcode.dataVersion,\r\n\t\t'op': 'eq'\r\n\t})\r\n\tvar sorts = {\r\n\t\t'1': 'UDATE',\r\n\t\t'2': 'SUBTYPE',\r\n\t\t'3': 'UP_DOWN',\r\n\t\t'4': 'UP_DOWN'\r\n\t};\r\n\tvar orders = {\r\n\t\t'1': 'desc',\r\n\t\t'2': 'desc',\r\n\t\t'3': 'desc',\r\n\t\t'4': 'asc',\r\n\t}\r\n\t$('.disease_list_body').html('');\r\n\t// var _url = config_url.pdds + Disease.TYPE_LIST.URLS.MAP_LIST,\r\n\tlet urlList = Disease.TYPE_LIST.URLS.PD_SHOW_LIST || Disease.TYPE_LIST.URLS.LIST;\r\n\tvar _url = config_url.pdds + urlList,\r\n\t\t_type = $('.disease_list_sort ul li.active').attr('type'),\r\n\t\tsort = sorts[_type],\r\n\t\torder = orders[_type],\r\n\t\tdata = {\r\n\t\t\t'sort': [\r\n\t\t\t\t{\r\n\t\t\t\t  'k': sort,\r\n\t\t\t\t  'order': order\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t\t'ops': param,\r\n\t\t\t'page': this.page_param,\r\n\t\t};\r\n\t\r\n\t// $.cesium_removeEntities();\r\n\t// _this.mark_label_list();\r\n\t\r\n\t_this.chunk_list_index = 0;\r\n\t$.postAjax({\r\n\t\turl: _url,\r\n\t\tdata: data,\r\n\t\tcallback: function(data){\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView(data.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar _data = data.result.data.features || [],\r\n\t\t\t\t_page = data.result.page || {},\r\n\t\t\t\tthis_data = [];\r\n\t\t\t\r\n\t\t\t\tif(_this.page_type){\r\n\t\t\t\t\t_this.page_init(_page);\r\n\t\t\t\t}\r\n\t\t\t_this.data_point = [];\r\n\t\t\tfor(var i=0; i<_data.length; i++){\r\n\t\t\t\t\r\n\t\t\t\t// if(_data[i].properties.ID != \"fe7d7b0d28db61c61445ad1526ec8471\"){\r\n\t\t\t\t// \tcontinue;\r\n\t\t\t\t// }\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tvar link_code = _data[i].properties.LINK_CODE || '';\r\n\t\t\t\t\r\n\t\t\t\tif(!link_code){\r\n\t\t\t\t\t// continue;\r\n\t\t\t\t}\r\n\t\t\t\tvar new_data = disease_list.dataInfoFormat(_data[i], this_data.length);\r\n\t\t\t\t\r\n\t\t\t\tthis_data.push( new_data );\r\n\t\t\t\t\r\n\t\t\t\tvar _entity = $.add_layer({\r\n\t\t\t\t\t'result': {\r\n\t\t\t\t\t\t'properties': new_data.properties\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// var _entity = $.add_billboard({\r\n\t\t\t\t// \t'result': {\r\n\t\t\t\t// \t\t'properties': _data[i].properties,\r\n\t\t\t\t// \t\t'geometry': {\r\n\t\t\t\t// \t\t\t'coordinates': [_coordinates]\r\n\t\t\t\t// \t\t}\r\n\t\t\t\t// \t}\r\n\t\t\t\t// })\r\n\t\t\t\t_this.data_point.push(_entity);\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\t_this.catchList = this_data;\r\n\t\t\t\r\n\t\t\tdisease_list.catchListUTM = addGeometry(this_data);\r\n\t\t\t\r\n\t\t\t// disease_group.list_group();\r\n\t\t\t_this.dataList(this_data);\r\n\t\t\t/*--*/\r\n\t\t\t$('.disease_list_num span').html(_page.count);\r\n\t\t\tif(junge){\r\n\t\t\t\t// disease_cesium.add_3d_tile();\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n};\r\n\r\n/*  */\r\ndisease_list.dataInfoFormat = function(_data, index){\r\n\t\r\n\tvar type_list = Disease.TYPE_LIST.TYPES;\r\n\tvar list_info = Disease.TYPE_LIST.LISTINFO;\r\n\tvar create_time = _data.properties._CREATE_TIME_ || '',\r\n\t\tupdate_time = _data.properties.UDATE || '',\r\n\t\ttype = _data.properties[type_list.KEY],\r\n\t\tlayer_type = 'Point',\r\n\t\tdata_type = _data.properties[type_list.KEY] || '',\r\n\t\t// mps_xy = _data.properties.CENTROID,\r\n\t\tmps_xy = _data.properties.CENTROID || '',\r\n\t\tcenter = mps_xy.split(','),\r\n\t\tsubtype = _data.properties[list_info.ID] || '',\r\n\t\tgeo_range = _data.properties.GEOM || '',\r\n\t\tgeo_range_type = $.cesium_range_type(geo_range),\r\n\t\tgeo_range_new = $.cesium_range(geo_range),\r\n\t\tlink_name = _data.properties.LINK_NAME || '',\r\n\t\tmp_code = _data.properties.MP_CODE || '',\r\n\t\tmp_codes = mp_code.split('|'),\r\n\t\tmp_codes_0 = mp_codes[0] || '',\r\n\t\tmp_codes_1 = mp_codes[1] ? ('K' + mp_codes[1]) : '',\r\n\t\tmp_codes_2 = mp_codes[2] ? ('+' + mp_codes[2] + '00') : '+000',\r\n\t\tmp_codes_2 = mp_code ? mp_codes_2 : '',\r\n\t\t\r\n\t\tup_down = _data.properties.UP_DOWN || '',\r\n\t\tdet_time = _data.properties.DET_TIME || '',\r\n\t\t\r\n\t\t_coordinates = [ Number(center[0]), Number(center[1]), (Number(center[2] || 0)) ],\r\n\t\tcn_up_down = Disease.TYPE_LIST.UP_DOWM[up_down] || '',\r\n\t\tcn_type = Disease.TYPE_LIST.TYPES.VALUES[type] || {'INFO':[], 'NAME': '', 'SUBTYPE': {}},\r\n\t\t_cn_type = cn_type.NAME || '',\t\t\t\t\t\t\t\t\t\t/**/\r\n\t\tcn_subtype = list_info.MAPPING || {},\r\n\t\t_cn_subtype = cn_subtype[subtype] || '',\t\t\t\t\t\t\t/**/\r\n\t\tcn_mark = mp_codes_0 +' ' + link_name + ' ' + mp_codes_1 + mp_codes_2,\t\t/**/\r\n\t\tcn_mark = mp_code ? cn_mark : '';\r\n\t\r\n\tif(Disease.TYPE_LIST.ID == 'ASSET_INSPECTION'){\r\n\t\tif(data_type == '703'){\r\n\t\t\tlayer_type = 'Polygon';\r\n\t\t}else if(data_type == '707'){\r\n\t\t\tdata_type = (data_type + '_' + subtype)\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar utm_arr = [];\r\n\tfor(let d=0; d<geo_range_new.length; d++){\r\n\t\tvar utm_xy = LLtoUTM(geo_range_new[d][0], geo_range_new[d][1]);\r\n\t\tutm_arr.push([\r\n\t\t\tutm_xy.x, utm_xy.y, geo_range_new[d][2]\r\n\t\t])\r\n\t}\r\n\tvar new_code = _data.properties.LINK_CODE + '_' + _data.properties.MP_CODE;\r\n\tvar new_data = {\r\n\t\t'range_type': geo_range_type,\r\n\t\t'create_time': create_time ? $.timeData(create_time,0) : '',\r\n\t\t'update_time': update_time ? $.timeConvert(update_time,0) : '',\r\n\t\t'det_time': update_time ? $.timeData(update_time,0) : '',\r\n\t\t'index': index,\r\n\t\t'link_code': _data.properties.LINK_CODE + '',\r\n\t\t'new_code': new_code,\r\n\t\t'center_xy': _coordinates,\r\n\t\t'subtype': subtype,\r\n\t\t'_cn_type': _cn_type,\r\n\t\t'_cn_subtype': _cn_subtype,\r\n\t\t'cn_up_down': cn_up_down,\r\n\t\t'cn_mark': cn_mark,\r\n\t\t'locs': geo_range_new,\r\n\t\t'layer_type': layer_type,\r\n\t\t'data_type': data_type,\r\n\t\t'locs_utm': utm_arr,\r\n\t\t'mp_codes_0': mp_codes_0,\r\n\t\t'mp_codes_1': mp_codes_1,\r\n\t\t'mp_codes_2': mp_codes_2\r\n\t}\r\n\t\r\n\tfor(var item in new_data){\r\n\t\t_data.properties[item] = new_data[item];\r\n\t\t_data[item] = new_data[item];\r\n\t}\r\n\t\r\n\treturn _data;\r\n}\r\n\r\n/**/\r\ndisease_list.dataList = function(data){\r\n\t$('.disease_list .disease_list_body')[0].scrollTop = 0;\r\n\tvar new_html = data.length ? '' : `\r\n\t\t\t<div class=\"no_list_child\">\r\n\t\t\t\t<span></span>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t\r\n\t$('.disease_list_body').html(new_html);\r\n\t\r\n\tif(data.length){\r\n//\t\t\tthis.chunk_list = _.chunk(data, 100);\r\n\t\tthis.chunk_list = _.chunk(data, 30);\r\n\t\tthis.chunk_list_change();\r\n\t}\r\n};\r\n\r\n/*--100*/\r\ndisease_list.chunk_list_change = function(){\r\n\tvar li_length = $('.disease_list_li').length,\r\n//\t\t\tindex_length = this.chunk_list_index * 100;\r\n\t\tindex_length = this.chunk_list_index * 30;\r\n\tif(li_length != index_length){\r\n\t\treturn;\r\n\t}\r\n\tif(this.chunk_list_index >= this.chunk_list.length){\r\n\t\treturn;\r\n\t}\r\n\t$('.disease_list_foot').css('display', 'block');\r\n\t\r\n\tvar href = 'iconrising' || 'iconRightarrow' || 'iconfalling',\t\t\t//--\r\n\t\t_name = Disease.TYPE_LIST.LISTINFO.NAME,\r\n\t\t_values = Disease.TYPE_LIST.TYPES.VALUES,\r\n\t\t_class = 'up',\r\n\t\ttrue_data = this.chunk_list[this.chunk_list_index] || [],\r\n\t\t_html = `\r\n\t\t${true_data.map(f => `\r\n\t\t\t<div class=\"disease_list_li\" data-index=\"${f.properties.index}\">\r\n\t\t\t\t<div class=\"child_head\">\r\n\t\t\t\t\t<!--<span class=\"child_head_id\">${f.properties.ID || 0}</span>-->\r\n\t\t\t\t\t<span class=\"child_head_name\">${f._cn_type}</span>\r\n\t\t\t\t\t<span class=\"child_head_time\">${f.update_time}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"child_body\">\r\n\t\t\t\t\t<p class=\"child_body_place\">\r\n\t\t\t\t\t\t<span class=\"child_body_name\"></span>\r\n\t\t\t\t\t\t<span class=\"child_body_place_value\">${f.cn_mark} ${f.cn_up_down}</span>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<p class=\"child_body_grade\">\r\n\t\t\t\t\t\t<span class=\"child_body_name\">${_name}</span>\r\n\t\t\t\t\t\t<span class=\"child_body_grade_value grade_${f.subtype}\">${_values[f.properties.TYPE] ? (_values[f.properties.TYPE].SUBTYPE[f.subtype] || '-') : '-'}</span>\r\n\t\t\t\t\t\t<!--<span class=\"iconfont ${_class} ${href}\"></span>\r\n\t\t\t\t\t\t<span class=\"child_body_grade_time\">${f.update_time}</span>-->\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t`).join('')}\r\n\t`;\r\n\t$('.disease_list_body').append(_html);\r\n\t\r\n\tvar doms = $('.child_head_time'),\r\n//\t\t\tl = this.chunk_list_index * 100;\r\n\t\tl = this.chunk_list_index * 30;\r\n//\t\tfor(var i=l; i<100; i++){\r\n\tfor(var i=l; i<30; i++){\r\n\t\tvar width = doms.eq(i).css('width'),\r\n\t\t\tparse_width = parseInt(width) + 13,\r\n\t\t\tnew_width = 'calc(100% - '+parse_width+'px)';\r\n\t\t\r\n\t\t$('.child_head_name').eq(i).css('max-width',new_width);\r\n\t}\r\n\tthis.chunk_list_index ++;\r\n\t$('.disease_list_foot').css('display', 'none');\r\n\t\r\n};\r\n\r\n/*--,*/\r\ndisease_list.list_toggle = function(type, junge){\r\n\t\r\n\treturn\r\n\tvar data = disease_info.current_info.properties,\r\n\t\troad_code = data.mp_codes_0,\r\n\t\tlink_code = data.mp_codes_0 + '_' + data.mp_codes_1,\r\n\t\tmp_code = link_code + '_' + data.mp_codes_2;\r\n\t\t// level_one = _viewer.entities.getById(data.ID),\r\n\t\t// level_two = _viewer.entities.getById(mp_code),\r\n\t\t// level_three = _viewer.entities.getById(link_code),\r\n\t\t// level_four = _viewer.entities.getById(road_code),\r\n\t\t// z_height = _viewer.camera.positionCartographic.height,\r\n\t\t// _entity = level_four;\r\n\t\r\n\t// if(level_one && level_one.show){\r\n\t// \t_entity = level_one;\r\n\t// \tdisease_cesium.change_last_point(_entity);\r\n\t\t\r\n\t// }else if(level_two && level_two.show){\r\n\t// \t_entity = level_two;\r\n\t// }else if(level_three && level_three.show){\r\n\t// \t_entity = level_three;\r\n\t// }\r\n\t\r\n\tthis.position_group_change(_entity);\r\n\t\r\n\tvar center = _entity ? _entity._center : null,\r\n\t\t// bounds = $.getBounds(),\r\n\t\t// _x = (bounds.east+bounds.west)/2,\r\n\t\t// _y = (bounds.north+bounds.south)/2,\r\n\t\tlng_lat = Cesium.Cartesian3.fromDegrees(center[0], center[1], z_height),\r\n\t\tisPointInBbox = false;\r\n\t\t/*isPointInBbox = $.isPointInRect({\r\n\t\t\tlng: center[0],\r\n\t\t\tlat: center[1]\r\n\t\t}, {\r\n\t\t\teast: bounds.east,\r\n\t\t\tnorth: bounds.north,\r\n\t\t\tsouth: bounds.south,\r\n\t\t\twest: _x\r\n\t\t});*/\r\n\t\r\n\tif((!isPointInBbox && !type) || junge){\r\n\t\t_viewer.camera.setView({\r\n\t\t\tdestination: lng_lat\r\n\t\t})\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_list.position_group_change = function(layer){\r\n\tif(this.position_group){\r\n\t\tthis.position_group.billboard.image._value = './Apps/Dist/Img/label_background_'+ this.position_group.icon_length +'.png';\r\n\t\tthis.position_group = null;\r\n\t}\r\n\tif(layer && layer.point_length){\r\n\t\tlayer.billboard.image._value = './Apps/Dist/Img/label_background_'+ layer.icon_length +'_active.png';\r\n\t\tthis.position_group = layer;\r\n\t}\r\n};\r\n\r\nexport {\r\n    disease_list\r\n};\r\n\r\n// module.exports = disease_list;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","/*\r\n * @Author: tao.w\r\n * @Date: 2020-12-01 15:33:27\r\n * @LastEditors: tao.w\r\n * @LastEditTime: 2020-12-02 16:19:58\r\n * @Description: \r\n */\r\n\r\nimport {\r\n    disease_init\r\n} from './disease_init.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\nimport {\r\n    disease_group\r\n} from './disease_group.js';\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\n\r\nimport { mapInit as mapboxInit } from './map_init';\r\n\r\nlet _map = null;\r\nlet _oldSelectIconLayers = [];\r\nlet _oldSelectVectorLayers = [];\r\nvar hoveredStateId = null; //\r\nvar hoveredLayerId = null; //\r\nvar _event = window.event;\r\n\r\nvar modelMapRelation = {\r\n\t1: {\r\n\t\t'TYPE': '702',\t//\r\n\t\t'MODELNAME': 'BARRIER'\r\n\t},\r\n\t2: {\r\n\t\t'TYPE': '701',\t//\r\n\t\t'MODELNAME': 'HD_DIVIDER'\r\n\t},\r\n\t// 3: '',\r\n\t4: {\t\t\t\t//\r\n\t\t'TYPE': '707',\r\n\t\t'MODELNAME': 'HD_POINT'\r\n\t},\r\n\t5: {\t\t\t\t//\r\n\t\t'TYPE': '707',\r\n\t\t'MODELNAME': 'HD_POLYGON'\r\n\t},\r\n\t8: {\t\t\t\t//\r\n\t\t'TYPE': '704',\r\n\t\t'MODELNAME': 'HD_TRAFFICSIGN'\r\n\t},\r\n}\r\nvar sourceLayerMapRalation = {\r\n\t'HD_POINT': {\r\n\t\t'13': {\t\t\t//\r\n\t\t\t'TYPE': '705',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'15': {\t\t\t//\r\n\t\t\t'TYPE': '707',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'16': {\t\t\t//\r\n\t\t\t'TYPE': '707',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'21': {\t\t\t//\r\n\t\t\t'TYPE': '706',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'22': {\t\t\t//\r\n\t\t\t'TYPE': '706',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'23': {\t\t\t//\r\n\t\t\t'TYPE': '706',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'115': {\t\t\t//\r\n\t\t\t'TYPE': '707',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'116': {\t\t\t//\r\n\t\t\t'TYPE': '707',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t},\r\n\t'ROAD': {\t\t\t//\r\n\t\t'3': {\r\n\t\t\t'TYPE': '703',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t\t'4': {\r\n\t\t\t'TYPE': '708',\r\n\t\t\t'MODELNAME': 'HD_POINT'\r\n\t\t},\r\n\t},\r\n\t'HD_POLYGON': {\t\t\t//\r\n\t\t'TYPE': '708',\r\n\t\t'MODELNAME': 'HD_POLYGON'\r\n\t}\r\n}\r\n\r\n/**\r\n * @description: \r\n * @param {*}\r\n * @return {*}\r\n */\r\nfunction initBackgroundStyle() {\r\n    /*URL*/\r\n    //TODO  ,\r\n    // ()\r\n    let TDT_VEC_W = [\r\n        \"http://t0.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t1.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t2.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t3.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t4.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t5.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t6.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t7.tianditu.gov.cn/vec_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=vec&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n    ];\r\n\r\n    //()\r\n    //\"&SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cva&STYLE=default&TILEMATRIXSET=w&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&FORMAT=tiles\" \r\n    let TDT_CVA_W = [\r\n        \"http://t0.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t1.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t2.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t3.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t4.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t5.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t6.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t7.tianditu.gov.cn/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n    ];\r\n\r\n    //()\r\n\r\n    let TDT_IMG_W = [\r\n        \"http://t0.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t1.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t2.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t3.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t4.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t5.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t6.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t7.tianditu.gov.cn/img_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=img&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default&format=tiles&tk=bb3a11452a810044c551e46541839c84\",\r\n    ];\r\n\r\n    //()\r\n    let TDT_CIA_W = [\r\n        \"http://t0.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t1.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t2.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t3.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t4.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t5.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t6.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n        \"http://t7.tianditu.gov.cn/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={z}&TileRow={y}&TileCol={x}&style=default.jpg&tk=bb3a11452a810044c551e46541839c84\",\r\n    ];\r\n\t\r\n\t//\r\n    let DATA_SETS_2D = [];\r\n\tif(disease_user.current_adcode){\r\n\t\tDATA_SETS_2D = [\r\n\t\t\tconfig_url.vector_tile + 'x={x}&y={y}&z={z}&f=png&scale=1&s=' + disease_user.current_adcode['2d_road_grid_tiles']\r\n\t\t];\r\n\t}\r\n\r\n    //['vec-w','cva-w','img-w','cia-w']\r\n    let style = {\r\n        \"version\": 8,\r\n        \"sources\": {\r\n            \"raster-vec-w\": {\r\n                \"type\": \"raster\",\r\n                'tiles': TDT_VEC_W,\r\n                \"tileSize\": 256\r\n            },\r\n            \"raster-cva-w\": {\r\n                \"type\": \"raster\",\r\n                'tiles': TDT_CVA_W,\r\n                \"tileSize\": 256\r\n            },\r\n            \"raster-img-w\": {\r\n                \"type\": \"raster\",\r\n                'tiles': TDT_IMG_W,\r\n                \"tileSize\": 256\r\n            },\r\n            \"raster-cia-w\": {\r\n                \"type\": \"raster\",\r\n                'tiles': TDT_CIA_W,\r\n                \"tileSize\": 256\r\n            },\r\n            \"data-sets-2d\": {\r\n                \"type\": \"raster\",\r\n                'tiles': DATA_SETS_2D,\r\n                \"tileSize\": 256\r\n            },\r\n        },\r\n        \"layers\": [\r\n            {\r\n                \"id\": \"vec-w\",\r\n                \"type\": \"raster\",\r\n                \"source\": \"raster-vec-w\",\r\n                \"minzoom\": 9,\r\n                \"maxzoom\": 24,\r\n                'layout': {\r\n                    // 'visibility': 'none'\r\n                }\r\n            },\r\n            {\r\n                \"id\": \"cva-w\",\r\n                \"type\": \"raster\",\r\n                \"source\": \"raster-cva-w\",\r\n                \"minzoom\": 9,\r\n                \"maxzoom\": 24,\r\n                'layout': {\r\n                    // 'visibility': 'none'\r\n                }\r\n            },\r\n            {\r\n                \"id\": \"img-w\",\r\n                \"type\": \"raster\",\r\n                \"source\": \"raster-img-w\",\r\n                \"minzoom\": 9,\r\n                \"maxzoom\": 24,\r\n                'layout': {\r\n                    'visibility': 'none'\r\n                }\r\n            },\r\n            {\r\n                \"id\": \"cia-w\",\r\n                \"type\": \"raster\",\r\n                \"source\": \"raster-cia-w\",\r\n                \"minzoom\": 9,\r\n                \"maxzoom\": 24,\r\n                'layout': {\r\n                    'visibility': 'none'\r\n                }\r\n            },\r\n            {\r\n                \"id\": \"data-sets-2d\",\r\n                \"type\": \"raster\",\r\n                \"source\": \"data-sets-2d\",\r\n                \"minzoom\": 9,\r\n                \"maxzoom\": 24,\r\n                'layout': {\r\n                    'visibility': 'none'\r\n                }\r\n            }\r\n        ]\r\n    };\r\n    return style;\r\n}\r\n\r\n/* : ,  */\r\nvar cacheAssetDatas = [];\r\nfunction loadAssetDataPromise() {\r\n    cacheAssetDatas = [];\r\n    return new Promise(function (resolve, reject) {\r\n        let dataVersion = disease_user.current_adcode.dataVersion;\r\n        let dataCode = Disease.TYPE_LIST.DATACODE;\r\n        let url = config_url.pdds + 'data/' + dataCode + '/query';\r\n        let body = {\r\n            'ops': [{\r\n                'k': 'DATA_VERSION',\r\n                'v': dataVersion,\r\n                'op': 'eq'\r\n            }],\r\n            'returnFields': [\r\n                'TYPE', 'SUBTYPE', 'MP_CODE', 'UP_DOWN', 'UDATE', 'ID', '_OID_', 'MODEL_NAME'\r\n            ]\r\n\r\n        }\r\n        $.postAjax({\r\n            'url': url,\r\n            'token': true,\r\n            'data': body,\r\n            'callback': function (data) {\r\n                if (data.code != '0') {\r\n                    $.errorView('' + data.message);\r\n                    resolve();\r\n                } else {\r\n                    data.result.data.features.forEach(d => {\r\n                        cacheAssetDatas.push(d.properties)\r\n                    })\r\n                    resolve(1);\r\n                }\r\n            }\r\n        })\r\n    });\r\n}\r\n\r\n\r\n// -\r\nfunction findLinks(dataVersion) {\r\n\tvar url = config_url.pdds + 'data/road_link/query';\r\n\tvar param = {\r\n\t\t'ops': [\r\n\t\t\t{\r\n\t\t\t\t'k': 'DATA_VERSION',\r\n\t\t\t\t'type': 'string',\r\n\t\t\t\t'v': dataVersion,\r\n\t\t\t\t'op': 'eq'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\t\r\n    return new Promise((resolve, reject) => {\r\n        $.postAjax({\r\n            'url': url,\r\n\t\t\t'data': param,\r\n            'token': true,\r\n            'callback': function (data) {\r\n\t\t\t\tvar datas = data.result.data || {};\r\n                resolve(datas);\r\n            }\r\n        })\r\n    })\r\n}\r\n\r\n// \r\nfunction handleRoadRemove(){\r\n\tif(_map.getLayer('dash-lines')){\r\n\t\t_map.removeLayer('dash-lines');\r\n\t\tif( _map.getSource('roadLinkDash') ){\r\n\t\t\t_map.removeSource('roadLinkDash');\r\n\t\t}\r\n\t}\r\n\tif(_map.getLayer('default-lines')){\r\n\t\t_map.removeLayer('default-lines');\r\n\t\tif( _map.getSource('roadLinkDefault') ){\r\n\t\t\t_map.removeSource('roadLinkDefault');\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// \r\nfunction handleRoadHide(zoom){\r\n\tlet visibility = (zoom > 15) ? 'none' : 'visible';\r\n\tif(_map.getLayer('dash-lines')){\r\n\t\t_map.setLayoutProperty('dash-lines', 'visibility', visibility)\r\n\t}\r\n\tif(_map.getLayer('default-lines')){\r\n\t\t_map.setLayoutProperty('default-lines', 'visibility', visibility)\r\n\t}\r\n}\r\n\r\nvar convergeGroups = [];\r\nvar convergeGroupOptions = {\r\n    'LINK_CODE': [9, 10, 11],\t\t\t//\r\n    'KMP_CODE': [12, 13, 14, 15],\t\t//\r\n    'MP_CODE': [16, 17],\t\t\t\t//\r\n};\r\n\r\nfunction loadConvergeData(type = {}) {\r\n\t\r\n    let types = (type.TYPE && type.TYPE.length) ? type.TYPE.join() : '';\r\n\tlet subtype = type.SUBTYPE || '';\r\n\tlet linkCode = (type.LINK_CODE && type.LINK_CODE.length) ? type.LINK_CODE.join() : '';\r\n    let dataVersion = disease_user.current_adcode.dataVersion;\r\n    let url = config_url.pdds + Disease.TYPE_LIST.URLS.AGGR + dataVersion + '&types=' + types+ '&subtype=' + subtype + '&linkCodes=' + linkCode;\r\n    $.getAjax({\r\n        'url': url,\r\n        'token': true,\r\n        'callback': function (data) {\r\n            if (data.code != '0' || _.isEmpty(data.result)) {\r\n                console.warn('');\r\n                return;\r\n            }\r\n            let result = data.result;\r\n            let features = [];\r\n            convergeGroups = [];\r\n            _.forEach(result, (v, k) => {\r\n\r\n                var zooms = convergeGroupOptions[k];\r\n                var value = [];\r\n\r\n                v.forEach(d => {\r\n                    var _code = d.CODE || null;\r\n                    var _count = d.COUNT || 0;\r\n                    var _center = d.CENTROID ? d.CENTROID.split(',') : null;\r\n                    if (_center && _count) {\r\n                        var markDiv = document.createElement(\"div\");\r\n                        markDiv.innerHTML = _count;\r\n                        markDiv.className = 'convergeGroup';\r\n                        markDiv.setAttribute('data-code', _code);\r\n                        var _m = new mapboxgl.Marker({\r\n                            anchor: 'center',\r\n                            element: markDiv\r\n                        }).setLngLat([_center[0], _center[1]])\r\n                        .addTo(_map);\r\n                        value.push(_m)\r\n                    }\r\n                })\r\n\r\n                convergeGroups.push({\r\n                    'k': k,\r\n                    'z': zooms,\r\n                    'v': value\r\n                })\r\n\r\n            })\r\n            convergeGroupChange();\r\n        }\r\n    })\r\n}\r\n\r\n/**/\r\nfunction zoomLevelChange(zoom) {\r\n\t\r\n    if (zoom > 19) {\r\n        $('.layer_list .checkbox_label input[value=\"1\"]')[0].checked = false;\r\n        $('.layer_list li span.radio_label').removeClass('active');\r\n        layerChange(5);\r\n    } else if (zoom < 20) {\r\n        $('.layer_list .checkbox_label input[value=\"1\"]')[0].checked = true;\r\n        // var _active = $('.layer_list li span.radio_label.active');\r\n        // if (!_active.length) {\r\n            $('.layer_list li span.radio_label[name=\"' + disease_map.layer_type + '\"]').addClass('active');\r\n            layerChange(disease_map.layer_type);\r\n        // }\r\n    }\r\n};\r\n\r\n/* , */\r\nfunction convergeGroupChange() {\r\n    var zoom_level = $('.cesium_control .zoom_level a').text(),\r\n        _z = Number(zoom_level);\r\n\t\r\n\tzoomLevelChange(_z);\r\n\t\r\n    convergeGroups.forEach(d => {\r\n\r\n        let values = d.v;\r\n        let _type = d.z.includes(_z);\r\n        let _style = (_type && !playerPoint) ? 'block' : 'none';\r\n        let value_1 = values[0];\r\n        if (value_1) {\r\n            let value_1_ele = value_1.getElement();\r\n            if (value_1_ele.style.display == _style) {\r\n                return\r\n            }\r\n        }\r\n\r\n        values.forEach(v => {\r\n\r\n            let _ele = v.getElement();\r\n            if (_ele) {\r\n                _ele.style.display = _style\r\n            }\r\n\r\n        })\r\n\r\n    })\r\n}\r\n\r\n\r\n/*  */\r\nfunction clearConvergeGroup() {\r\n    convergeGroups.forEach(d => {\r\n        let values = d.v;\r\n        values.forEach(v => {\r\n            v.remove && v.remove();\r\n        })\r\n    })\r\n    convergeGroups = [];\r\n}\r\n\r\n/*  */\r\nfunction playerToTracks(ev){\r\n\t\r\n\t// let evProp = ev.features[0].properties || {};\r\n\t// let sourceLayer = ev.features[0].sourceLayer || null;\r\n\t// let evId = evProp.ID;\r\n\t// let feaType = evProp.FEA_TYPE;\r\n\t// let subType = evProp.TYPE;\r\n\t// let evType = null;\r\n\t\r\n\tgetLayerInfo(ev.features);\r\n\treturn\r\n\tlet evProp = {\"type\":\"Feature\",\"properties\":{\"MAX_Y\":44.08610060899196,\"MAX_X\":87.77992381043984,\"KMP_CODE\":\"G3003|99\",\"_OID_\":\"100000577\",\"UDATE\":\"1603780724000\",\"TRACK_ID\":\"204443803_20201020180446920\",\"LINK_CODE\":\"G3003\",\"MIN_Y\":44.08610060899196,\"MP_CODE\":\"G3003|99\",\"MIN_X\":87.77992381043984,\"_CREATE_TIME_\":1604660582787,\"ID\":\"5508365554169367796\",\"CENTROID\":\"87.77992381043984,44.08610060899196,511.57149172760523\",\"TYPE\":\"707\",\"GEOM\":\"POINT(87.77992381043984 44.08610060899196 511.57149172760523)\",\"DATA_TYPE\":\"MP\",\"MATERIAL\":\"2\",\"_UPDATE_TIME_\":1604660582787,\"SUBTYPE\":\"15\",\"MODEL_NAME\":\"OBJECT_PT\",\"adcode\":\"650100\",\"DATA_VERSION\":\"wlmq_2020_11_06\",\"D_COORDS\":\"87.77992381043984 44.08610060899196 511.57149172760523\",\"HEIGHT\":\"1.3352\",\"NAME\":\"G3003|99\",\"LINK_NAME\":\"\",\"T_POINT_ID\":\"204443803_20201020180456577000\",\"range_type\":\"Point\",\"create_time\":\"2020/11/06\",\"update_time\":\"2020/10/27\",\"det_time\":\"2020/10/27\",\"index\":1,\"link_code\":\"G3003\",\"new_code\":\"G3003_G3003|99\",\"center_xy\":[87.77992381043984,44.08610060899196,511.57149172760523],\"subtype\":\"15\",\"_cn_type\":\"\",\"_cn_subtype\":\"\",\"cn_up_down\":\"\",\"cn_mark\":\"G3003  K99+000\",\"locs\":[[87.77992381043984,44.08610060899196,511.57149172760523]],\"layer_type\":\"Point\",\"data_type\":\"707_15\",\"locs_utm\":[[562439.265349012,4881731.589399391,511.57149172760523]],\"mp_codes_0\":\"G3003\",\"mp_codes_1\":\"K99\",\"mp_codes_2\":\"+000\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[87.77992381043984,44.08610060899196,511.57149172760523]},\"range_type\":\"Point\",\"create_time\":\"2020/11/06\",\"update_time\":\"2020/10/27\",\"det_time\":\"2020/10/27\",\"index\":1,\"link_code\":\"G3003\",\"new_code\":\"G3003_G3003|99\",\"center_xy\":[87.77992381043984,44.08610060899196,511.57149172760523],\"subtype\":\"15\",\"_cn_type\":\"\",\"_cn_subtype\":\"\",\"cn_up_down\":\"\",\"cn_mark\":\"G3003  K99+000\",\"locs\":[[87.77992381043984,44.08610060899196,511.57149172760523]],\"layer_type\":\"Point\",\"data_type\":\"707_15\",\"locs_utm\":[[562439.265349012,4881731.589399391,511.57149172760523]],\"mp_codes_0\":\"G3003\",\"mp_codes_1\":\"K99\",\"mp_codes_2\":\"+000\"}\r\n\t\r\n\t\r\n\tvar active = Disease.TYPE_LIST.FUNBUTTON.find(function (data) {\r\n\t\treturn data.ACTIVE == 'active';\r\n\t})\r\n\t\r\n\t\r\n\tdisease_init.player_mode_init(active.ID);\r\n\tdisease_info.come_to_info(evProp,true,true);\r\n\t\t\t\t\r\n\t\r\n}\r\n\r\n/**\r\n * @description: \r\n * @param {*}\r\n * @return {*}\r\n */\r\nfunction clearMapData() {\r\n\r\n}\r\n\r\n/**\r\n * @description:  \r\n * @param {*}\r\n * @return {*}\r\n */\r\nfunction removeLayerEvent() {\r\n    for (let i = 0; i < _oldSelectIconLayers.length; i++) {\r\n        _map.off('mouseenter', _oldSelectIconLayers[i][0], iconMouseenter);\r\n        _map.off('mouseleave', _oldSelectIconLayers[i][1], iconMouseleave);\r\n        _map.off('click', _oldSelectIconLayers[i][0], iconMouseClick);\r\n    }\r\n\r\n    for (let i = 0; i < _oldSelectVectorLayers.length; i++) {\r\n        _map.off('mousemove', _oldSelectVectorLayers[i], vectorMousemove);\r\n        _map.off('mouseleave', _oldSelectVectorLayers[i], vectormouseleave);\r\n\t\t_map.off('click', _oldSelectVectorLayers[i], vectorMouseClick);\r\n    }\r\n}\r\n\r\n/**\r\n * @description: \r\n * @param {*}\r\n * @return {*}\r\n */\r\n//\r\nfunction iconMouseClick(e) {\r\n    if (e.features.length > 0) {\r\n\t\t\r\n\t\t// addPopup(e);\r\n\t\tplayerToTracks(e);\r\n\t\tconsole.log('')\r\n\t\t\r\n    }\r\n}\r\nfunction vectorMouseClick(e) {\r\n    if (e.features.length > 0) {\r\n\t\t\r\n\t\t// addPopup(e);\r\n\t\tplayerToTracks(e);\r\n\t\tconsole.log('')\r\n\t\t\r\n    }\r\n}\r\n/**\r\n * @description: \r\n * @param {*}\r\n * @return {*}\r\n */\r\n//\r\nfunction iconMouseenter(e) {\r\n    if (e.features.length > 0) {\r\n\t\taddPopup(e);\r\n\t\t\r\n        // var filter1 = e.features.reduce(\r\n        //     function (memo, feature) {\r\n        //         memo.push(feature.properties.ID);\r\n        //         return memo;\r\n        //     },\r\n        //     ['in', 'ID']\r\n        // );\r\n        let feature = e.features[0];\r\n        let filter = ['in', 'ID', feature.properties.ID];\r\n        let id = feature.layer.id + '-highlighted';\r\n        hoveredStateId = id;\r\n        _map.setFilter(id, filter);\r\n    }\r\n}\r\n\r\n/**\r\n * @description: \r\n * @param {*}\r\n * @return {*}\r\n */\r\nfunction iconMouseleave(e) {\r\n    // let id = e.target.painter.id || '';\r\n    if (hoveredStateId != null) {\r\n\t\t\r\n\t\tclosePopup();\r\n\t\t\r\n        // id != '' ? _map.setFilter(id, [\"in\", \"ID\", '']) : false;\r\n        _map.setFilter(hoveredStateId, [\"in\", \"ID\", '']);\r\n        hoveredStateId = null;\r\n    }\r\n    // hoveredStateId = null;\r\n}\r\n\r\nfunction vectorMousemove(e) {\r\n    if (e.features.length > 0) {\r\n\t\t\r\n        if (hoveredStateId && hoveredLayerId) {\r\n            let layer = _map.getLayer(hoveredLayerId);\r\n            _map.setFeatureState(\r\n                {\r\n                    source: layer.source,\r\n                    id: hoveredStateId,\r\n                    sourceLayer: layer.sourceLayer\r\n                },\r\n                { hover: false }\r\n            );\r\n        }\r\n        let feature = e.features[0];\r\n\t\t\r\n\t\tif(hoveredStateId != feature.id || hoveredLayerId != feature.layer.id){\r\n\t\t\taddPopup(e);\r\n\t\t}\r\n\t\t\r\n        hoveredStateId = feature.id;\r\n        hoveredLayerId = feature.layer.id;\r\n\t\t\r\n        let layer = _map.getLayer(hoveredLayerId);\r\n        _map.setFeatureState(\r\n            {\r\n                source: layer.source,\r\n                id: hoveredStateId,\r\n                sourceLayer: layer.sourceLayer\r\n            },\r\n            { hover: true }\r\n        );\r\n    }\r\n}\r\nfunction vectormouseleave(e) {\r\n    if (hoveredStateId) {\r\n\t\t\r\n\t\tclosePopup();\r\n\t\t\r\n        let layer = _map.getLayer(hoveredLayerId);\r\n        _map.setFeatureState(\r\n            {\r\n                source: layer.source,\r\n                id: hoveredStateId,\r\n                sourceLayer: layer.sourceLayer\r\n            },\r\n            { hover: false }\r\n        );\r\n    }\r\n    hoveredStateId = null;\r\n}\r\n\r\n\r\n/**\r\n * @description: \r\n * @param {*} _config\r\n * @return {*}\r\n */\r\nfunction initCustomEvent(_config) {\r\n    let _iconlayers = _config.selectIconLayerIds || [];\r\n    let _vectorLayers = _config.selectHoverEffectLayerIds || [];\r\n    removeLayerEvent();\r\n    for (let i = 0; i < _iconlayers.length; i++) {\r\n        _map.on('mouseenter', _iconlayers[i][0], iconMouseenter);\r\n        _map.on('mouseleave', _iconlayers[i][1], iconMouseleave);\r\n        _map.on('click', _iconlayers[i][0], iconMouseClick);\r\n        _map.on('click', _iconlayers[i][1], iconMouseClick);\r\n    }\r\n    for (let i = 0; i < _vectorLayers.length; i++) {\r\n        _map.on('mousemove', _vectorLayers[i], vectorMousemove);\r\n        _map.on('mouseleave', _vectorLayers[i], vectormouseleave);\r\n        _map.on('click', _vectorLayers[i], vectorMouseClick);\r\n    }\r\n    _oldSelectIconLayers = _iconlayers;\r\n    _oldSelectVectorLayers = _vectorLayers;\r\n}\r\n\r\n/**\r\n * @description: mvt\r\n * @param {*} sources\r\n * @return {*}\r\n */\r\nfunction addSources(sources) {\r\n    // TODO \r\n    if (_map == null) return false;\r\n    for (let i = 0; i < sources.length; i++) {\r\n        let source = sources[i];\r\n\t\t// let mvt = Disease.TYPE_LIST.MVT + '' + disease_user.current_adcode.adcode;\r\n\t\tlet mvt = (Disease.TYPE_LIST.DATACODE == \"pd\") ? disease_user.current_adcode['2d_pd_mvt_tiles'] : disease_user.current_adcode['2d_road_mvt_tiles'];\r\n\t\tif( !_map.getSource(source.datasource) ){\r\n\t\t\t_map.addSource(source.datasource, {\r\n\t\t\t\t'type': 'vector',\r\n\t\t\t\t'tiles': [config_url.vector_tile + 's=' + mvt + '&get=map&cache=true&f=mvt&x={x}&y={y}&z={z}'],\r\n\t\t\t\t// 'tiles': [config_url.vector_tile + 'mid=' + source.datasource_mvt + '&get=map&cache=true&f=mvt&x={x}&y={y}&z={z}'],\r\n\t\t\t\t'minzoom': source.zoomRange[0],\r\n\t\t\t\t'maxzoom': source.zoomRange[1]\r\n\t\t\t});\r\n\t\t}\r\n    }\r\n}\r\n/**\r\n * @description: mvt\r\n * @param {*} sources\r\n * @return {*}\r\n */\r\nfunction removeSources(sources, callback) {\r\n\t\r\n    // TODO \r\n    if (_map == null) return false;\r\n    for (let i = 0; i < sources.length; i++) {\r\n        let source = sources[i];\r\n\t\tif( _map.getSource(source.datasource) ){\r\n\t\t\t_map.removeSource(source.datasource);\r\n\t\t}\r\n    }\r\n\tcallback && callback();\r\n}\r\n/**\r\n * @description: \r\n * @param {*} layers\r\n * @return {*}\r\n */\r\nfunction addLayers(layers, toplayerId = null) {\r\n    if (_map == null) return false;\r\n    for (var i in layers) {\r\n        var layer = layers[i];\r\n\t\tif( !_map.getLayer(layer.id) ){\r\n\t\t\tif (layer.id != toplayerId) {\r\n\t\t\t    _map.addLayer(layer, toplayerId);\r\n\t\t\t} else {\r\n\t\t\t    _map.addLayer(layer);\r\n\t\t\t}\r\n\t\t}\r\n    }\r\n}\r\n/**\r\n * @description: \r\n * @param {*} layers\r\n * @return {*}\r\n */\r\nfunction removeLayers(layers, callback) {\r\n    if (_map == null) return false;\r\n    for (var i in layers) {\r\n        var layer = layers[i];\r\n\t\tif( _map.getLayer(layer.id) ){\r\n\t\t\t_map.removeLayer(layer.id);\r\n\t\t}\r\n    }\r\n\tcallback && callback();\r\n}\r\n\r\n/*  */\r\nfunction getLayerInfo(ev, name){\r\n\t\r\n\tlet dataCode = Disease.TYPE_LIST.DATACODE;\r\n\tlet evProp = ev[0].properties || {};\r\n\tlet sourceLayer = ev[0].sourceLayer || null;\r\n\tlet evId = evProp.ID;\r\n\tlet feaType = evProp.FEA_TYPE;\r\n\tlet subType = evProp.TYPE;\r\n\tlet evType = null;\r\n\tlet dataVersion = disease_user.current_adcode.dataVersion;\r\n\t\r\n\tif(dataCode == 'pd'){\r\n\t\tevType = evProp.TYPE;\r\n\t\tsubType = evProp.SUBTYPE;\r\n\t}else{\r\n\t\tif(sourceLayer == 'firstnode'){\r\n\t\t\tevType = modelMapRelation[feaType] || null;\r\n\t\t}else if(sourceLayer == 'HD_POLYGON'){\r\n\t\t\tevType = sourceLayerMapRalation[sourceLayer];\r\n\t\t}else{\r\n\t\t\tevType = (sourceLayerMapRalation[sourceLayer] && sourceLayerMapRalation[sourceLayer][subType]) ? sourceLayerMapRalation[sourceLayer][subType] : null;\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(!evType){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\tlet body = {\r\n\t\t'ops': [\r\n\t\t\t{\r\n\t\t\t\t'k': '_OID_',\r\n\t\t\t\t'v': evId + '',\r\n\t\t\t\t'op': 'eq'\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'k': 'DATA_VERSION',\r\n\t\t\t\t'v': dataVersion,\r\n\t\t\t\t'op': 'eq'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\tif(evType.MODELNAME){\r\n\t\tbody.ops.push({\r\n\t\t\t'k': 'MODEL_NAME',\r\n\t\t\t'v': evType.MODELNAME,\r\n\t\t\t'op': 'eq'\r\n\t\t})\r\n\t}else if(sourceLayer){\r\n\t\tbody.ops.push({\r\n\t\t\t'k': 'MODEL_NAME',\r\n\t\t\t'v': sourceLayer,\r\n\t\t\t'op': 'ieq'\r\n\t\t})\r\n\t}\r\n\t\r\n\tif(evProp.HEIGHT){\r\n\t\tbody.ops.push({\r\n\t\t\t'k': 'HEIGHT',\r\n\t\t\t'v': evProp.HEIGHT + '',\r\n\t\t\t'op': 'eq'\r\n\t\t})\r\n\t}\r\n\t\r\n\tloadLayerInfo(body).then((_t) => {\r\n\t\tif(_t){\r\n\t\t\tvar active = Disease.TYPE_LIST.FUNBUTTON.find(function (data) {\r\n\t\t\t\tif(name){\r\n\t\t\t\t\treturn data.ID == name;\r\n\t\t\t\t}\r\n\t\t\t\treturn data.ACTIVE == 'active';\r\n\t\t\t})\r\n\t\t\t\r\n\t\t\tvar info = _t.find(function (data) {\r\n\t\t\t\treturn data.properties.TRACK_ID;\r\n\t\t\t})\r\n\t\t\tif(info){\r\n\t\t\t\tvar currentInfo = formatProperties(info);\r\n\t\t\t\tdisease_init.player_mode_init(active.ID);\r\n\t\t\t\tdisease_info.come_to_info(currentInfo,true,true);\r\n\t\t\t}\r\n\t\t}\r\n    })\r\n}\r\n\r\n/*  */\r\nfunction formatProperties(prop){\r\n\tvar type_list = Disease.TYPE_LIST.TYPES,\r\n\t\tlist_info = Disease.TYPE_LIST.LISTINFO,\r\n\t\tcreate_time = prop.properties._CREATE_TIME_ || '',\r\n\t\tupdate_time = prop.properties.UDATE || '',\r\n\t\ttype = prop.properties[type_list.KEY],\r\n\t\tlayer_type = 'Point',\r\n\t\tdata_type = prop.properties[type_list.KEY] || '',\r\n\t\t// mps_xy = prop.properties.CENTROID,\r\n\t\tmps_xy = prop.properties.CENTROID || '',\r\n\t\tcenter = mps_xy.split(','),\r\n\t\tsubtype = prop.properties[list_info.ID] || '',\r\n\t\tgeo_range = prop.properties.GEOM || '',\r\n\t\tgeo_range_type = $.cesium_range_type(geo_range),\r\n\t\tgeo_range_new = $.cesium_range(geo_range),\r\n\t\tlink_name = prop.properties.LINK_NAME || '',\r\n\t\tmp_code = prop.properties.MP_CODE || '',\r\n\t\tmp_codes = mp_code.split('|'),\r\n\t\tmp_codes_0 = mp_codes[0] || '',\r\n\t\tmp_codes_1 = mp_codes[1] ? ('K' + mp_codes[1]) : '',\r\n\t\tmp_codes_2 = mp_codes[2] ? ('+' + mp_codes[2] + '00') : '+000',\r\n\t\tmp_codes_2 = mp_code ? mp_codes_2 : '',\r\n\t\t\r\n\t\tup_down = prop.properties.UP_DOWN || '',\r\n\t\tdet_time = prop.properties.DET_TIME || '',\r\n\t\t\r\n\t\t_coordinates = [ Number(center[0]), Number(center[1]), (Number(center[2] || 0)) ],\r\n\t\tcn_up_down = Disease.TYPE_LIST.UP_DOWM[up_down] || '',\r\n\t\tcn_type = Disease.TYPE_LIST.TYPES.VALUES[type] || {'INFO':[], 'NAME': '', 'SUBTYPE': {}},\r\n\t\t_cn_type = cn_type.NAME || '',\t\t\t\t\t\t\t\t\t\t/**/\r\n\t\tcn_subtype = list_info.MAPPING || {},\r\n\t\t_cn_subtype = cn_subtype[subtype] || '',\t\t\t\t\t\t\t/**/\r\n\t\tcn_mark = mp_codes_0 +' ' + link_name + ' ' + mp_codes_1 + mp_codes_2,\t\t/**/\r\n\t\tcn_mark = mp_code ? cn_mark : '';\r\n\r\n\tif(Disease.TYPE_LIST.ID == 'ASSET_INSPECTION'){\r\n\t\tif(data_type == '703'){\r\n\t\t\tlayer_type = 'Polygon';\r\n\t\t}else if(data_type == '707'){\r\n\t\t\tdata_type = (data_type + '_' + subtype)\r\n\t\t}\r\n\t}\r\n\r\n\tvar utm_arr = [];\r\n\tfor(let d=0; d<geo_range_new.length; d++){\r\n\t\tvar utm_xy = LLtoUTM(geo_range_new[d][0], geo_range_new[d][1]);\r\n\t\tutm_arr.push([\r\n\t\t\tutm_xy.x, utm_xy.y, geo_range_new[d][2]\r\n\t\t])\r\n\t}\r\n\tvar new_code = prop.properties.LINK_CODE + '_' + prop.properties.MP_CODE;\r\n\tvar new_data = {\r\n\t\t'range_type': geo_range_type,\r\n\t\t'create_time': create_time ? $.timeData(create_time,0) : '',\r\n\t\t'update_time': update_time ? $.timeConvert(update_time,0) : '',\r\n\t\t'det_time': update_time ? $.timeData(update_time,0) : '',\r\n\t\t'link_code': prop.properties.LINK_CODE + '',\r\n\t\t'new_code': new_code,\r\n\t\t'center_xy': _coordinates,\r\n\t\t'subtype': subtype,\r\n\t\t'_cn_type': _cn_type,\r\n\t\t'_cn_subtype': _cn_subtype,\r\n\t\t'cn_up_down': cn_up_down,\r\n\t\t'cn_mark': cn_mark,\r\n\t\t'locs': geo_range_new,\r\n\t\t'layer_type': layer_type,\r\n\t\t'data_type': data_type,\r\n\t\t'locs_utm': utm_arr,\r\n\t\t'mp_codes_0': mp_codes_0,\r\n\t\t'mp_codes_1': mp_codes_1,\r\n\t\t'mp_codes_2': mp_codes_2\r\n\t}\r\n\r\n\tfor(var item in new_data){\r\n\t\tprop.properties[item] = new_data[item];\r\n\t\tprop[item] = new_data[item];\r\n\t}\r\n\t\r\n\treturn prop;\r\n}\r\n\r\n/*  */\r\nfunction loadLayerInfo(body){\r\n    return new Promise(function (resolve, reject) {\r\n        let dataCode = Disease.TYPE_LIST.DATACODE;\r\n        let url = config_url.pdds + 'data/' + dataCode + '/query';\r\n        $.postAjax({\r\n            'url': url,\r\n            'token': true,\r\n            'data': body,\r\n            'callback': function (data) {\r\n                if (data.code != '0') {\r\n                    $.errorView('' + data.message);\r\n                    resolve();\r\n                } else {\r\n\t\t\t\t\tvar result = data.result.data.features;\r\n                    resolve(result);\r\n                }\r\n            }\r\n        })\r\n    });\r\n}\r\n\r\n/**\r\n * @description: \r\n * @param {*} event\r\n * @return {*}\r\n */\r\nvar playerPoint = null;\r\nvar lastRotation = null;\r\n/*  */\r\nfunction addPlayerPoint(data){\r\n\tvar coordinates = [ data.coordinates[0], data.coordinates[1] ];\r\n\tvar rotation = (data.rotation === null) ? lastRotation : (0 - data.rotation);\r\n\tif(!playerPoint){\r\n\t\tlet playerDiv = document.createElement(\"div\");\r\n\t\tlet playerDivImage = document.createElement(\"div\");\r\n\t\tplayerDivImage.className = 'playerPoint';\r\n\t\tplayerDivImage.style.transform = 'rotate(' + rotation + 'deg)';\r\n\t\t\r\n\t\tplayerDiv.appendChild(playerDivImage)\r\n\t\t\r\n\t\tplayerPoint = new mapboxgl.Marker({\r\n\t\t    anchor: 'center',\r\n\t\t    element: playerDiv\r\n\t\t})\r\n\t\t.setLngLat( coordinates )\r\n\t\t.addTo(_map);\r\n\t}else{\r\n\t\tplayerPoint.setLngLat( coordinates )\r\n\t\tplayerPoint.getElement().firstChild.style.transform = 'rotate(' + rotation + 'deg)';\r\n\t}\r\n\t\r\n\t_map.setCenter(coordinates);\r\n\tlastRotation = rotation;\r\n\t\r\n}\r\n/*  */\r\nfunction removePlayerPoint(){\r\n\tplayerPoint && playerPoint.remove();\r\n\tplayerPoint = null;\r\n}\r\n\r\n\r\n/**\r\n * @description: \r\n * @param {*} event\r\n * @return {*}\r\n */\r\nvar popupOffsets = {\r\n\t'top': [4, 4],\r\n\t'top-left': [-4, 4],\r\n\t'top-right': [4, 4],\r\n\t'bottom': [0, -4],\r\n\t'bottom-left': [4, -4],\r\n\t'bottom-right': [-4, -4],\r\n\t'left': [4, -50],\r\n\t'right': [-4, -50]\r\n};\r\nvar popupMarker = null;\r\nvar popupMouseType = false;\r\nvar evBody = null;\r\nfunction addPopup(ev = {}) {\r\n\t\r\n\t\r\n\tclosePopupTimeOut && clearTimeout(closePopupTimeOut);\r\n\tlet dataCode = Disease.TYPE_LIST.DATACODE;\r\n\tlet evProp = ev.features[0].properties || {};\r\n\tlet sourceLayer = ev.features[0].sourceLayer || null;\r\n\tlet evId = evProp.ID;\r\n\tlet feaType = evProp.FEA_TYPE;\r\n\tlet subType = evProp.TYPE;\r\n\tlet evType = null;\r\n\t\r\n\tlet evProps = {\"type\":\"Feature\",\"properties\":{\"MAX_Y\":44.08610060899196,\"MAX_X\":87.77992381043984,\"KMP_CODE\":\"G3003|99\",\"_OID_\":\"100000577\",\"UDATE\":\"1603780724000\",\"TRACK_ID\":\"204443803_20201020180446920\",\"LINK_CODE\":\"G3003\",\"MIN_Y\":44.08610060899196,\"MP_CODE\":\"G3003|99\",\"MIN_X\":87.77992381043984,\"_CREATE_TIME_\":1604660582787,\"ID\":\"5508365554169367796\",\"CENTROID\":\"87.77992381043984,44.08610060899196,511.57149172760523\",\"TYPE\":\"707\",\"GEOM\":\"POINT(87.77992381043984 44.08610060899196 511.57149172760523)\",\"DATA_TYPE\":\"MP\",\"MATERIAL\":\"2\",\"_UPDATE_TIME_\":1604660582787,\"SUBTYPE\":\"15\",\"MODEL_NAME\":\"OBJECT_PT\",\"adcode\":\"650100\",\"DATA_VERSION\":\"wlmq_2020_11_06\",\"D_COORDS\":\"87.77992381043984 44.08610060899196 511.57149172760523\",\"HEIGHT\":\"1.3352\",\"NAME\":\"G3003|99\",\"LINK_NAME\":\"\",\"T_POINT_ID\":\"204443803_20201020180456577000\",\"range_type\":\"Point\",\"create_time\":\"2020/11/06\",\"update_time\":\"2020/10/27\",\"det_time\":\"2020/10/27\",\"index\":1,\"link_code\":\"G3003\",\"new_code\":\"G3003_G3003|99\",\"center_xy\":[87.77992381043984,44.08610060899196,511.57149172760523],\"subtype\":\"15\",\"_cn_type\":\"\",\"_cn_subtype\":\"\",\"cn_up_down\":\"\",\"cn_mark\":\"G3003  K99+000\",\"locs\":[[87.77992381043984,44.08610060899196,511.57149172760523]],\"layer_type\":\"Point\",\"data_type\":\"707_15\",\"locs_utm\":[[562439.265349012,4881731.589399391,511.57149172760523]],\"mp_codes_0\":\"G3003\",\"mp_codes_1\":\"K99\",\"mp_codes_2\":\"+000\"},\"geometry\":{\"type\":\"Point\",\"coordinates\":[87.77992381043984,44.08610060899196,511.57149172760523]},\"range_type\":\"Point\",\"create_time\":\"2020/11/06\",\"update_time\":\"2020/10/27\",\"det_time\":\"2020/10/27\",\"index\":1,\"link_code\":\"G3003\",\"new_code\":\"G3003_G3003|99\",\"center_xy\":[87.77992381043984,44.08610060899196,511.57149172760523],\"subtype\":\"15\",\"_cn_type\":\"\",\"_cn_subtype\":\"\",\"cn_up_down\":\"\",\"cn_mark\":\"G3003  K99+000\",\"locs\":[[87.77992381043984,44.08610060899196,511.57149172760523]],\"layer_type\":\"Point\",\"data_type\":\"707_15\",\"locs_utm\":[[562439.265349012,4881731.589399391,511.57149172760523]],\"mp_codes_0\":\"G3003\",\"mp_codes_1\":\"K99\",\"mp_codes_2\":\"+000\"}\r\n\t\r\n\tdisease_map.last_point = evProps;\r\n\t\r\n\tif(dataCode == 'pd'){\r\n\t\tevType = evProp.TYPE;\r\n\t\tsubType = evProp.SUBTYPE;\r\n\t}else{\r\n\t\tif(sourceLayer == 'firstnode'){\r\n\t\t\tevType = modelMapRelation[feaType] ? modelMapRelation[feaType].TYPE : null;\r\n\t\t}else{\r\n\t\t\tevType = (sourceLayerMapRalation[sourceLayer] && sourceLayerMapRalation[sourceLayer][subType]) ? sourceLayerMapRalation[sourceLayer][subType].TYPE : null;\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n\t// let data = cacheAssetDatas.find(d => (d.ID == evId)) || { \"SUBTYPE\": \"13\", \"MP_CODE\": \"G3003|101|2\", \"UP_DOWN\": \"2\", \"ID\": \"2364582265951593522\", \"TYPE\": \"705\", \"UDATE\": \"1603780724000\" };\r\n\t\r\n\tlet type_list = Disease.TYPE_LIST,\r\n\t\tsubTypeMap = type_list.LISTINFO.MAPPING,\r\n\t\ttypeMap = type_list.TYPES.VALUES,\r\n\t\tdataTime = evProp.UDATE ? $.timeConvert(evProp.UDATE, 0) : '',\r\n\t\t\r\n\t\tdataType = typeMap[evType] ? typeMap[evType].NAME : '',\r\n\t\tdataSubtype = subTypeMap[subType] || '',\r\n\t\tdataSubtypeClass = 'grade_' + subType,\r\n\t\t\r\n\t\tdataMapCode = evProp.MP_CODE ? evProp.MP_CODE.split('|') : [],\r\n\t\tdataMapRoad = dataMapCode[0] || '',\r\n\t\tdataMapK = dataMapCode[1] ? ('K' + dataMapCode[1]) : '',\r\n\t\tdataMapM = '',\r\n\t\tdataUpDown = type_list.UP_DOWM[evProp.UP_DOWN] || '',\r\n\t\tdataStr = '';\r\n\tif (evProp.MP_CODE) {\r\n\t\tdataMapM = dataMapRoad[2] ? ('+' + dataMapRoad[2] + '00') : '+000';\r\n\t\tdataStr = dataMapRoad + ' ' + dataMapK + dataMapM + ' ' + dataUpDown;\r\n\t}\r\n\t\r\n\tif(sourceLayer == 'road_adas'){\r\n\t\tdataType = '';\r\n\t}else if(sourceLayer == 'HD_POLYGON'){\r\n\t\tdataType = '';\r\n\t}\r\n\t\r\n    var _cns = [\r\n        { 'id': 'WIDTH', 'name': '', 'unit': 'm' },\r\n        { 'id': 'RADIUS', 'name': '', 'unit': 'm' },\r\n        { 'id': 'SLOPE', 'name': '', 'unit': '' }\r\n    ]\r\n    // RADIUS: \"Infinity\"    m\r\n    // SLOPE: \"-0.017119\"\t\t\r\n    // WITH: \"3.75\",            m\r\n\r\n    var text_type = 'type_block';\r\n    var btn_type = 'type_none';\r\n    var _text = '';\r\n\r\n    if ( evProp.hasOwnProperty('WIDTH') || evProp.hasOwnProperty('SLOPE') ) {\r\n\t\t\r\n\t\tlet width =  Number( evProp.WIDTH) || 0,\r\n\t\t\twidthCn = '',\r\n\t\t\twidthVal =  Number( width.toFixed(2) ),\r\n\t\t\tradius = Number( evProp.RADIUS ) || 0,\r\n\t\t\tradiusCn = '',\r\n\t\t\tradiusVal = Number( Math.abs( radius.toFixed(2) ) ),\r\n\t\t\tslope = Number( evProp.SLOPE ) || 0,\r\n\t\t\tslopeCn = '',\r\n\t\t\tslopeVal = Number( slope.toFixed(2) );\r\n\t\t\r\n\t\tif( radius > 0 ){\r\n\t\t\tradiusCn = ' ';\r\n\t\t}else if( radius < 0 ){\r\n\t\t\tradiusCn = ' ';\r\n\t\t}else{\r\n\t\t\tradiusVal = ' - ';\r\n\t\t}\r\n\t\t\r\n        _text = `\r\n\t\t\t<span> ${widthVal}m</span>\r\n\t\t\t<span>${radiusCn} ${radiusVal}m</span>\r\n\t\t\t<span> ${slopeVal}m</span>\r\n\t\t`;\r\n        if (evProp.LINK_CODE && evProp.TRACK_ID) {\r\n\t\t\ttext_type = 'type_none';\r\n\t\t\tbtn_type = 'type_block';\r\n        }\r\n    } else {\r\n        text_type = 'type_none';\r\n        btn_type = 'type_block';\r\n    }\r\n\t\r\n\t// if(data){\r\n\t\t// let subTypeMap = Disease.TYPE_LIST.LISTINFO.MAPPING,\r\n\t\t//     typeMap = Disease.TYPE_LIST.TYPES.VALUES,\r\n\t\t//     dataTime = data.UDATE ? $.timeConvert(data.UDATE, 0) : '',\r\n\t\t//     dataType = typeMap[data.TYPE] ? typeMap[data.TYPE].NAME : '',\r\n\t\t//     dataSubtype = subTypeMap[data.SUBTYPE] || '',\r\n\t\t//     dataSubtypeClass = 'grade_' + data.SUBTYPE,\r\n\t\t//     dataMapCode = data.MP_CODE ? data.MP_CODE.split('|') : [],\r\n\t\t//     dataMapRoad = dataMapCode[0] || '',\r\n\t\t//     dataMapK = dataMapRoad[1] ? ('K' + dataMapRoad[1]) : '',\r\n\t\t//     dataMapM = '',\r\n\t\t//     dataUpDown = Disease.TYPE_LIST.UP_DOWM[data.UP_DOWN] || '',\r\n\t\t//     dataStr = '';\r\n\t\t// if (data.MP_CODE) {\r\n\t\t// \tdataMapM = dataMapRoad[2] ? ('+' + dataMapRoad[2] + '00') : '+000';\r\n\t\t// \tdataStr = dataMapRoad + ' ' + dataMapK + dataMapM + ' ' + dataUpDown;\r\n\t\t// }\r\n\t// }\r\n\t\r\n    var _popup = `\r\n\t\t<div class=\"mapbox_popup\">\r\n\t\t\t<div class=\"popup_content\">\r\n\t\t\t\t<h4 class=\"popup_content_head\">\r\n\t\t\t\t\t<b>${dataType}</b>\r\n\t\t\t\t\t<span class=\"child_body_grade_value ${dataSubtypeClass}\">${dataSubtype}</span>\r\n\t\t\t\t</h4>\r\n\t\t\t\t<p class=\"child_body_place\">\r\n\t\t\t\t\t<span class=\"icon_image icon_position\"></span>\r\n\t\t\t\t\t<span class=\"child_body_place_type\">${dataStr}</span>\r\n\t\t\t\t</p>\r\n\t\t\t\t<p class=\"child_body_grade\">\r\n\t\t\t\t\t<span class=\"icon_image icon_time\"></span>\r\n\t\t\t\t\t<span class=\"child_body_grade_time\">${dataTime}</span>\r\n\t\t\t\t</p>\r\n\t\t\t\t<div class=\"image_buttons image_texts ${text_type}\">\r\n\t\t\t\t\t${_text}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"image_buttons ${btn_type}\">\r\n\t\t\t\t\r\n\t\t\t\t\t${type_list.FUNBUTTON.map(f => `\r\n\t\t\t\t\t\t<button class=\"btn ${f.CLASS} ${f.CONTROL}\" name=\"${f.ID}\">${f.NAME}</button>\r\n\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t`;\r\n\t\r\n\tif(!popupMarker){\r\n\t\t\r\n\t\tpopupMarker = new mapboxgl.Popup({\r\n\t\t\tcloseButton: false,\r\n\t\t\tclassName: 'mapbox_popup_dom',\r\n\t\t\t// anchor: 'top',\r\n\t\t\toffset: popupOffsets\r\n\t\t}).setLngLat([ ev.lngLat.lng, ev.lngLat.lat ])\r\n\t\t  .setHTML(_popup)\r\n\t\t  .addTo(_map);\r\n\t\t\r\n\t}else{\r\n\t\t\r\n\t\tlet isOpen = popupMarker.isOpen();\r\n\t\t!isOpen && popupMarker.addTo(_map);\r\n\t\t\r\n\t\tpopupMarker.setLngLat([ ev.lngLat.lng, ev.lngLat.lat ]);\r\n\t\tpopupMarker.setHTML(_popup);\r\n\t\t\r\n\t}\r\n\t\r\n\tif(ev.features){\r\n\t\tevBody = ev.features;\r\n\t}\r\n\t\r\n\tvar popupEle = popupMarker.getElement();\r\n\t\r\n\t$(popupEle).unbind();\r\n\t\r\n\tpopupEle && popupEle.addEventListener('mouseenter',function(){ popupMouseType = true; });\r\n\tpopupEle && popupEle.addEventListener('mouseleave',function(){ popupMouseType = false; closePopup(10) });\r\n\t\r\n\t$(popupEle).click('BUTTON', function(e){\r\n\t\t\r\n\t\tif(evBody && e.target.name){\r\n\t\t\t\r\n\t\t\tpopupMouseType = false;\r\n\t\t\tclosePopup(10);\r\n\t\t\t\r\n\t\t\tlet name = e.target.name;\r\n\t\t\tdisease_player.click_types = true;\r\n\t\t\tdisease_init.player_mode_init(name);\r\n\t\t\t\r\n\t\t\t// disease_info.come_to_info(disease_map.last_point,true,true);\r\n\t\t\t\r\n\t\t\tgetLayerInfo(evBody, name)\r\n\t\t}\r\n\t})\r\n\t\r\n}\r\n\r\n/*  */\r\nvar closePopupTimeOut = null;\r\nfunction closePopup(time = 200){\r\n\tif(!popupMarker){\r\n\t\treturn\r\n\t}\r\n\tclosePopupTimeOut && clearTimeout(closePopupTimeOut);\r\n\tclosePopupTimeOut = setTimeout(function(){\r\n\t\t!popupMouseType && popupMarker.remove();\r\n\t}, time)\r\n\t\r\n}\r\n\r\n/**\r\n * @description: \r\n * @param {*} value\r\n * @return {*}\r\n */\r\nfunction layerChange(value, show) {\r\n    // ['img-w', 'cia-w']  //\r\n    // ['vec-w', 'cva-w']  //\r\n\t\r\n    let layer_opt = {\r\n        '1': { 'img-w': false, 'cia-w': false, 'vec-w': true, 'cva-w': true },\r\n        '2': { 'img-w': false, 'cia-w': false, 'vec-w': true, 'cva-w': true },\r\n        '3': { 'img-w': true, 'cia-w': true, 'vec-w': false, 'cva-w': false },\r\n        '4': null,\r\n        '5': { 'img-w': false, 'cia-w': false, 'vec-w': false, 'cva-w': false },\r\n        '6': null\r\n    },\r\n    layers = layer_opt[value] || {};\r\n\t\r\n\tif (value == '4') {\r\n\t\tlet positionMarkLabels = $('.positionMarkLabel');\r\n\t\tlet labelDisplay = show ? 'block' : 'none';\r\n\t    for (let i = 0; i < positionMarkLabels.length; i++) {\r\n\t\t\tpositionMarkLabels[i].style.display = labelDisplay;\r\n\t    }\r\n\t}else if(value == '6' || value == '7'){\r\n\t\tlet showZoom = show ? 10 : 18;\r\n\t\thandleRoadHide(showZoom);\r\n\t\t$('.lineLayer .radio_label').removeClass('active');\r\n\t\tif(show){\r\n\t\t\t$('.lineLayer .radio_label[name=\"7\"]').addClass('active');\r\n\t\t}\r\n\t}else{\r\n\t\tif (show && value == '1') {\r\n\t\t    $('.dituLayer .radio_label').removeClass('active');\r\n\t\t    $('.dituLayer .radio_label[name=\"2\"]').addClass('active');\r\n\t\t    $('.dituLayer .radio_label.active').attr('name');\r\n\t\t} else if (value == '1') {\r\n\t\t    $('.radio_label').removeClass('active');\r\n\t\t}\r\n\t\t\r\n\t\tfor (var id in layers) {\r\n\t\t\tlet visibility = layers[id] ? 'visible' : 'none';\r\n\t\t\t_map.setLayoutProperty(id, 'visibility', visibility);\r\n\t\t}\r\n\t}\r\n\t\r\n\t\r\n}\r\nfunction dataLayerChange(z){\r\n\tvar dataCode = Disease.TYPE_LIST.DATACODE;\r\n\tvar visibility = 'visible';\r\n\tvar status = _map.getLayoutProperty('data-sets-2d', 'visibility');\r\n    if ( z < 16 ) {\r\n        visibility = 'none';\r\n    }\r\n\tif( dataCode == 'road_asset' ){\r\n\t\t_map.setLayoutProperty('data-sets-2d', 'visibility', 'none');\r\n\t}else if( (dataCode == 'pd') && (visibility != status) ){\r\n\t\t_map.setLayoutProperty('data-sets-2d', 'visibility', visibility);\r\n\t}\r\n}\r\n\r\nfunction mapClick(e) {\r\n\r\n    $('.cesium_popup_mark').hide();\r\n    if (e && e.originalEvent && e.originalEvent.target && (e.originalEvent.target.className.indexOf('convergeGroup') > -1)) {\r\n        console.log('')\r\n        disease_map.setZoom(18);\r\n        disease_map.setCenter( [e.lngLat.lng, e.lngLat.lat] );\r\n    }\r\n\r\n    // set bbox as 5px reactangle area around clicked point\r\n    var bbox = [[e.point.x - 5, e.point.y - 5], [e.point.x + 5, e.point.y + 5]];\r\n    // var features = _map.queryRenderedFeatures(bbox, { layers: ['counties'] });\r\n    // Run through the selected features and set a filter\r\n    // to match features with unique FIPS codes to activate\r\n    // the `counties-highlighted` layer.\r\n    // var filter = features.reduce(function(memo, feature) {\r\n    //     memo.push(feature.properties.FIPS);\r\n    //     return memo;\r\n    // }, ['in', 'FIPS']);\r\n\r\n    // console.log('features:',features);\r\n}\r\n\r\nfunction mapEventInit(map) {\r\n    map.on('click', mapClick);\r\n    map.on('zoom', controlZoom);\r\n    map.on('contextmenu', mapMenu);\r\n}\r\n\r\n/* ZOOM */\r\nfunction controlZoom() {\r\n    var zoom = _map.getZoom(),\r\n        roundZoom = Math.round(zoom);\r\n    $('.cesium_control .zoom_level a').html(roundZoom);\r\n\thandleRoadHide(roundZoom);\r\n    convergeGroupChange();\r\n    dataLayerChange(roundZoom);\r\n}\r\n\r\n/*  */\r\nfunction mapMenu(e) {\r\n    $('.cesium_popup_mark').hide();\r\n    let map_width = $('#cesium_map').width() || 0,\r\n        map_height = $('#cesium_map').height() || 0,\r\n        dom_width = $('#cesium_map_parent').width() || 0,\r\n        dom_height = $('#cesium_map_parent').height() || 0,\r\n        left_width = dom_width - map_width,\r\n        top_height = dom_height - map_height,\r\n        new_left = e.point.x + left_width + 1,\r\n        new_top = e.point.y + top_height + 50;\r\n\r\n    $('.cesium_popup_mark').css({\r\n        'top': new_top,\r\n        'left': new_left\r\n    });\r\n\r\n    let eDom = e.originalEvent.target,\r\n        eClassName = eDom ? eDom.className : '';\r\n    if (eClassName && eClassName.indexOf('positionMarkLabel') > -1) {\r\n        $('.cesium_popup_mark.remove_mark').show();\r\n        disease_map.right_point = eDom.getAttribute('dataId');\r\n    } else {\r\n        $('.cesium_popup_mark.add_mark').show();\r\n        disease_map.right_point = [e.lngLat.lng, e.lngLat.lat, 0];\r\n    }\r\n}\r\n\r\nfunction hoverLinkCodes(){\r\n\t\r\n}\r\n\r\n\r\nvar disease_map = {};\r\n\r\ndisease_map.right_point = null;\r\ndisease_map.last_point = null;\t\t\t//---\r\ndisease_map.last_info_point = null;\t\t//---\r\ndisease_map.load_image = null;;;\r\ndisease_map.time_spac = 300;;\r\ndisease_map.minZoom = 9;\r\ndisease_map.maxZoom = 27;\r\ndisease_map.camera_zoom = null;\r\ndisease_map.layer_type = '2';\r\n\r\nlet userinfo = $.getLocalStorage('userInfo') || '{}';\r\nlet json_userinfo = JSON.parse(userinfo);\r\nlet userName = json_userinfo.userName;\r\n\r\n// \r\ndisease_map.handleRoadData = async function(){\r\n\tif(!disease_user.current_adcode || !disease_user.current_adcode.dataVersion){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\thandleRoadRemove();\r\n\tvar dataVersion = disease_user.current_adcode.dataVersion;\r\n    var _datas = await findLinks(dataVersion);\r\n    var _colorSetDefault = {'1': 'rgb(52,176,0)','2': 'rgb(52,176,0)','3': 'rgb(255,142,16)','4': 'rgb(255,142,16)','5': 'rgb(233,3,0)'};\r\n    // 12345\r\n    // & -  rgb [52 176 0] & -  rgb [255 142 16]   -  rgb [233 3 0]\r\n\r\n\t// disease_road_link.line_group = null;\r\n\r\n\tvar roadLinkDefault = {\r\n\t\t'type': 'geojson',\r\n\t\t'data': {\r\n\t\t\t'type': 'FeatureCollection',\r\n\t\t\t'features': [\r\n\t\t\t\t\r\n\t\t\t]\r\n\t\t}\r\n\t}\r\n\tvar roadLinkDash = {\r\n\t\t'type': 'geojson',\r\n\t\t'data': {\r\n\t\t\t'type': 'FeatureCollection',\r\n\t\t\t'features': [\r\n\t\t\t\t\r\n\t\t\t]\r\n\t\t}\r\n\t}\r\n\tvar features = _datas.features || [];\r\n\tfor(var i=0; i<features.length; i++){\r\n\t\tvar geom = features[i].properties.GEOM;\r\n\t\t// var rType = features[i].properties.RTYPE || '1';\t// \r\n\t\tvar RATING = _colorSetDefault[features[i].properties.RATING] || 'rgb(180,180,180)';\t\r\n            var geoJson = $.geoJsonParam({\r\n                'range': geom,\r\n                'type': 'Polyline',\r\n                'weight': 2,\r\n\t\t\t\t'datas': features[i].properties,\r\n                'color': RATING\r\n            });\r\n            roadLinkDefault.data.features.push(geoJson);\r\n\t}\r\n\t\t\r\n\t_map.addSource('roadLinkDash', roadLinkDash);\r\n\t_map.addSource('roadLinkDefault', roadLinkDefault);\r\n\t_map.addLayer({\r\n\t\t'id': 'dash-lines',\r\n\t\t'type': 'line',\r\n\t\t'source': 'roadLinkDash',\r\n\t\t'paint': {\r\n\t\t\t'line-width': 6,\r\n\t\t\t\"line-color\":   ['get', 'color'],//\"#47F9FF\",\r\n\t\t\t\"line-dasharray\": [2, 2]\r\n\t\t}\r\n\t});\r\n\t_map.addLayer({\r\n\t\t'id': 'default-lines',\r\n\t\t'type': 'line',\r\n\t\t'source': 'roadLinkDefault',\r\n\t\t'paint': {\r\n\t\t\t'line-width': 6,\r\n            'line-color': ['get', 'color']//'#FF4057'\r\n        }\r\n\t})\r\n}\r\n\r\n/*  */\r\ndisease_map.formatProperties = function (prop) {\r\n\treturn formatProperties(prop);\r\n}\r\n/**\r\n * @description: \r\n */\r\ndisease_map.loadAssetDatas = function () {\r\n    // (Disease.TYPE_LIST.DATACODE == 'road_asset') && loadAssetDataPromise().then((_t) => {\r\n    //     _t && console.log('');\r\n    // })\r\n\tif( _map && _map.getLayer('data-sets-2d') ){\r\n\t\tif( Disease.TYPE_LIST.DATACODE == 'road_asset' ){\r\n\t\t\t_map.setLayoutProperty('data-sets-2d', 'visibility', 'none');\r\n\t\t}else{\r\n\t\t\t_map.setLayoutProperty('data-sets-2d', 'visibility', 'visible');\r\n\t\t}\r\n\t}\r\n}\r\n/**\r\n * @description: \r\n * @param {*} sources\r\n * @return {*}\r\n */\r\ndisease_map.updateSources = function (type) {\r\n    // TODO \r\n    clearConvergeGroup();\r\n    loadConvergeData(type);\r\n\t\r\n\tlet lastConfig = Disease.vector_tile_config[lastId];\r\n\tlet lastSources = lastConfig.source;\r\n\tlet lastLayers = lastConfig.layer;\r\n\t\r\n\tlet id = Disease.TYPE_LIST.ID;\r\n\tlet newConfig = Disease.vector_tile_config[id];\r\n\tlet newSources = newConfig.source;\r\n\tlet newLayers = newConfig.layer;\r\n\t\r\n\t\r\n\tremoveLayers(lastLayers);\r\n\tremoveSources(lastSources);\r\n\t\r\n\taddSources(newSources);\r\n\taddLayers(newLayers);\r\n\t\r\n\tinitCustomEvent(newConfig);\r\n\t\r\n    lastId = Disease.TYPE_LIST.ID;\r\n\r\n}\r\n\r\n/**\r\n * @description: --\r\n * @param {*} sources\r\n * @return {*}\r\n */\r\ndisease_map.updateConverges = function (type) {\r\n    // TODO \r\n    clearConvergeGroup();\r\n    loadConvergeData(type);\r\n}\r\n\r\ndisease_map.point_to_info = function (type) {\r\n    if (!this.last_point) {\r\n        $.errorView('');\r\n        return;\r\n    }\r\n    disease_player.click_types = true;\r\n    $(\".cesium_popup\").hide();\r\n    disease_init.player_mode_init(type);\r\n    disease_info.come_to_info(this.last_point.datas.index, true, true);\r\n};\r\n\r\ndisease_map.setCenter = function (xy) {\r\n    _map.setCenter(xy);\r\n}\r\n\r\ndisease_map.setResize = function () {\r\n    _map && _map.resize();\r\n}\r\n\r\ndisease_map.setZoom = function (z) {\r\n    _map.setZoom(z);\r\n}\r\n\r\ndisease_map.addPlayerPoint = function (data) {\r\n    addPlayerPoint(data);\r\n}\r\n\r\ndisease_map.removePlayerPoint = function () {\r\n    removePlayerPoint();\r\n}\r\n\r\n\r\n\r\n/*  */\r\ndisease_map.control_init = function () {\r\n\r\n    /*--*/\r\n    $('.cesium_popup .popup_content .image_buttons').on('click', 'button', function () {\r\n        let name = this.name;\r\n        _this.point_to_info(name);\r\n    })\r\n    /**/\r\n    $('.cesium_control .zoom_in a').click(function () {\r\n        var level = $('.cesium_control .zoom_level a').html(),\r\n            new_level = Number(level) + 1;\r\n        if (new_level > disease_map.maxZoom) {\r\n            return;\r\n        }\r\n        disease_map.setZoom(new_level);\r\n    })\r\n    $('.cesium_control .zoom_out a').click(function () {\r\n        var level = $('.cesium_control .zoom_level a').html() - 1;\r\n        if (level < disease_map.minZoom) {\r\n            return;\r\n        }\r\n        disease_map.setZoom(level);\r\n    })\r\n    /**/\r\n    $('.cesium_control .layer_list').mouseleave(function () {\r\n        $('.cesium_control .cesium_layers').removeClass('active');\r\n        $('.cesium_control .layer_list').hide();\r\n    })\r\n    $('.cesium_control .cesium_layers a').click(function () {\r\n        $('.cesium_control .cesium_layers').toggleClass('active');\r\n        $('.cesium_control .layer_list').toggle();\r\n    })\r\n    $('.layer_list li label input').click(function (e) {\r\n        let value = e.target.value,\r\n            checked = e.target.checked,\r\n\t\t\tnew_v = value;\r\n\t\t\r\n\t\tif(value == '1'){\r\n\t\t\tnew_v = checked ? '1' : '5';\r\n\t\t}\r\n        layerChange(new_v, checked);\r\n    })\r\n    $('.layer_list li span.radio_label').click(function (e) {\r\n        let _type = $('.layer_list .checkbox_label input[value=\"1\"]')[0].checked,\r\n\t\t\tdom = (e.target.localName == 'b') ? e.target.parentNode : e.target,\r\n\t\t\tvalue = dom.getAttribute('name'),\r\n\t\t    checked = true,\r\n\t\t\tview = (value == '7') ? '' : '';\r\n\t\t\r\n\t\tif(value == '7'){\r\n\t\t\t_type = $('.layer_list .checkbox_label input[value=\"6\"]')[0].checked;\r\n\t\t}\r\n\t\t\r\n        if (!_type) {\r\n            $.errorView(view);\r\n            return;\r\n        }\r\n\t\t\r\n\t\tif(value != '7'){\r\n\t\t\t$('.layer_list li.dituLayer span.radio_label').removeClass('active');\r\n\t\t\t$(dom).addClass('active');\r\n\t\t\tdisease_map.layer_type = value;\r\n\t\t}\r\n\t\t\r\n        layerChange(value, checked);\r\n    })\r\n    /*cesium*/\r\n    $('.cesium_control .full_screen a').click(function () {\r\n        var _center = disease_user.current_adcode.center,\r\n            new_center = _center ? _center.split(',') : null;\r\n        if (!new_center) {\r\n            $.errorView('');\r\n            return;\r\n        }\r\n        disease_map.setCenter(new_center);\r\n        disease_map.setZoom(9);\r\n    })\r\n\r\n}\r\n\r\n\r\n/**\r\n * @description:  \r\n * @param {*}\r\n * @return {*}\r\n */\r\nvar lastId = null;\r\ndisease_map.maps_init = function (containerID) {\r\n\r\n    let  this_center = disease_user.current_adcode.center.split(',');\r\n    let _center = disease_user.urlCenter?disease_user.urlCenter:this_center;\r\n    lastId = Disease.TYPE_LIST.ID;\r\n    let _config = Disease.vector_tile_config[lastId];\r\n    let topLayer = _config.topLayer;\r\n    let images = _config.images || [];\r\n    let sources = _config.source;\r\n    let layers = _config.layer;\r\n    if (_map == null) {\r\n        let mapStyle = initBackgroundStyle();\r\n        let opt = {\r\n            style: mapStyle,\r\n            center:_center,\r\n        };\r\n        // opt = {}\r\n        _map = mapboxInit(containerID, opt, images);\r\n        mapEventInit(_map);\r\n        window._main_map = _map;\r\n        console.log(_map.loaded());\r\n\t\tif(!disease_user.current_adcode){\r\n\t\t\treturn\r\n\t\t}\r\n        _map.on('load', function () {\r\n            addSources(sources);\r\n            addLayers(layers, topLayer);\r\n            initCustomEvent(_config);\r\n                if(disease_user.urlCenter){\r\n                    window._main_map.setZoom(17);\r\n                }\r\n        });\r\n    }\r\n};\r\n\r\n\r\n/**/\r\ndisease_map.loadMarkLabels = function () {\r\n    let _this = this,\r\n        _url = config_url.pdds + Disease.TYPE_LIST.URLS.MAP_MARK,\r\n        _json = { 'ops': [{ 'k': 'USER', 'type': 'string', 'v': userName, 'op': 'eq' }] };\r\n\r\n    $.postAjax({\r\n        url: _url,\r\n        data: _json,\r\n        callback: function (data) {\r\n            let features = (data.result && data.result.data) ? data.result.data.features : [];\r\n            _this.mark_points = features;\r\n            for (let i = 0; i < features.length; i++) {\r\n                let id = features[i].properties.ID,\r\n                    classId = 'markLabel_' + id,\r\n                    has_id = $('.' + classId).length,\r\n                    coordinates = features[i].geometry.coordinates;\r\n\r\n                if (!has_id) {\r\n\r\n                    var markDiv = document.createElement(\"div\");\r\n                    markDiv.className = 'positionMarkLabel ' + classId;\r\n                    markDiv.setAttribute('dataId', id);\r\n\r\n                    var _m = new mapboxgl.Marker({\r\n                        anchor: 'bottom',\r\n                        element: markDiv\r\n                    })\r\n                        .setLngLat([coordinates[0], coordinates[1]])\r\n                        .addTo(_map);\r\n\r\n                }\r\n            }\r\n            disease_player.mark_type_init();\r\n        }\r\n    })\r\n};\r\n\r\nvar markBodys = {\r\n    \"type\": \"FeatureCollection\",\r\n    \"features\": [\r\n        {\r\n            \"type\": \"Feature\",\r\n            \"properties\": {\r\n                \"USER\": null\r\n            },\r\n            \"geometry\": {\r\n                \"coordinates\": null,\r\n                \"type\": \"Point\"\r\n            }\r\n        }\r\n    ]\r\n};\r\n/*-*/\r\ndisease_map.menuMarks = function (id = false, callback = false) {\r\n    let _url = config_url.pdds + 'data/position_label/create';\r\n    if (id) {\r\n        _url = config_url.pdds + 'data/position_label/deleteById?id=' + disease_map.right_point;\r\n        $.getAjax({\r\n            'url': _url,\r\n            'token': true,\r\n            'callback': function (data) {\r\n                let _type = true;\r\n                if (data.code != '0') {\r\n                    _type = false;\r\n                } else {\r\n\r\n                    $('.markLabel_' + disease_map.right_point).remove();\r\n                }\r\n                $.errorView('' + data.message, _type);\r\n                callback && callback();\r\n            }\r\n        })\r\n    } else {\r\n        markBodys.features[0].properties.USER = userName;\r\n        markBodys.features[0].geometry.coordinates = [\r\n\t\t\tdisease_map.right_point[0],\r\n\t\t\tdisease_map.right_point[1],\r\n\t\t\t0\r\n\t\t];\r\n\r\n        $.postAjax({\r\n            url: _url,\r\n            data: markBodys,\r\n            callback: function (data) {\r\n                let _type = true;\r\n                if (data.code != '0') {\r\n                    _type = false;\r\n                }\r\n                $.errorView('' + data.message, _type);\r\n                disease_map.loadMarkLabels();\r\n            }\r\n        })\r\n    }\r\n    $('#cesium_map_parent .cesium_popup_mark').hide();\r\n};\r\n\r\n/**/\r\ndisease_map.cesium_popup_mark = function (event) {\r\n\r\n    $('.cesium_popup_mark').hide();\r\n    let map_width = $('#cesium_map').width() || 0,\r\n        map_height = $('#cesium_map').height() || 0,\r\n        dom_width = $('#cesium_map_parent').width() || 0,\r\n        dom_height = $('#cesium_map_parent').height() || 0,\r\n        left_width = dom_width - map_width,\r\n        top_height = dom_height - map_height,\r\n        new_left = event.position.x + left_width + 5,\r\n        new_top = event.position.y + top_height + 52,\r\n        picked = _viewer.scene.pick(event.position);\r\n\r\n    $('.cesium_popup_mark').css({\r\n        'top': new_top,\r\n        'left': new_left\r\n    });\r\n\r\n    if (picked && picked.id && picked.id.mark_type == 'position_label') {\r\n        $('.cesium_popup_mark.remove_mark').show();\r\n        this.right_point = picked.id.id;\r\n    } else {\r\n        $('.cesium_popup_mark.add_mark').show();\r\n        this.right_point = $.get_cesium_xy(event);\r\n    }\r\n};\r\n\r\n/**/\r\ndisease_map.layers_changed = function (param) {\r\n    let show = param.checked,\r\n        param_val = param.value,\r\n        layers = _viewer.imageryLayers._layers || [],\r\n        values = _viewer.entities.values || [],\r\n        param_l = {\r\n            '1': { 'tdtImg_c': true, 'tdtCva': true, 'tdtAdcode': true, 'tdtAdcodeM': true },\r\n            '2': { 'tdtAdcode': true, 'tdtAdcodeM': true },\r\n            '3': { 'tdtImg_c': true, 'tdtCva': true },\r\n            '4': null\r\n        };\r\n\r\n    if (show && param.value == '1') {\r\n        $('.radio_label').removeClass('active');\r\n        $('.radio_label[name=\"2\"]').addClass('active');\r\n        param_val = $('.radio_label.active').attr('name');\r\n    } else if (param.value == '1') {\r\n        $('.radio_label').removeClass('active');\r\n    }\r\n\r\n    if (param.value == '4') {\r\n        for (let i = 0; i < values.length; i++) {\r\n            if (values[i].mark_type == 'position_label') {\r\n                values[i].show = show;\r\n            }\r\n        }\r\n    } else {\r\n        for (let i = 0; i < layers.length; i++) {\r\n            let layer_name = layers[i].imageryProvider._layer,\r\n                createid = layers[i].imageryProvider._credit;\r\n            if (createid && createid._html == 'tile2d') {\r\n                continue;\r\n            }\r\n            if (param.value == '5') {\r\n                layers[i].show = show;\r\n            } else if (param_l[param_val][layer_name]) {\r\n                layers[i].show = show;\r\n            } else {\r\n                layers[i].show = !show;\r\n            }\r\n        }\r\n    }\r\n    $.cesium_refresh();\r\n};\r\n\r\n//\r\ndisease_map.change_last_point = function (layer) {\r\n    if (this.last_info_point) {\r\n\r\n        this.last_info_point._billboard._image._value = this.last_info_point._default_url;\r\n        this.last_info_point._billboard.disableDepthTestDistance._value = Number.POSITIVE_INFINITY;\r\n        this.last_info_point = null;\r\n    }\r\n    if (layer && layer._billboard) {\r\n\r\n        layer._billboard._image._valu = layer._active_url;\r\n        layer._billboard.disableDepthTestDistance._value = Number.POSITIVE_INFINITY;\r\n        this.last_info_point = layer;\r\n    }\r\n    $.cesium_refresh();\r\n};\r\n\r\n/*---*/\r\ndisease_map.zoomInOut = function (zoom) {\r\n    var height = disease_user.zoomToAltitude(zoom);\r\n    if (height) {\r\n        var center = $.getCenterPoint();\r\n        _viewer.camera.setView({\r\n            destination: Cesium.Cartesian3.fromDegrees(center[0], center[1], height)\r\n        })\r\n    }\r\n};\r\n\r\n/**/\r\ndisease_map.zoom_level = function () {\r\n    var height = _viewer.camera.positionCartographic.height,\r\n        zoom = disease_user.altitudeToZoom(height),\r\n        math_zoom = Math.round(zoom);\r\n    _viewer.camera.mathZoom = math_zoom;\r\n    $('.cesium_control .zoom_level a').html(math_zoom);\r\n\r\n    if ((math_zoom > 15) && !window.tile2d.show) {\r\n        window.tile2d.show = true;\r\n    } else if ((math_zoom < 16) && window.tile2d.show) {\r\n        window.tile2d.show = false;\r\n    }\r\n\r\n    if (math_zoom > 19) {\r\n        $('.layer_list .checkbox_label input[value=\"1\"]')[0].checked = false;\r\n        $('.layer_list li span.radio_label').removeClass('active');\r\n        disease_map.layers_changed({\r\n            'value': 5,\r\n            'checked': false\r\n        });\r\n    } else if (math_zoom < 20) {\r\n        $('.layer_list .checkbox_label input[value=\"1\"]')[0].checked = true;\r\n        var _active = $('.layer_list li span.radio_label.active');\r\n        if (!_active.length) {\r\n            $('.layer_list li span.radio_label[name=\"' + disease_map.layer_type + '\"]').addClass('active');\r\n            disease_map.layers_changed({\r\n                'value': disease_map.layer_type,\r\n                'checked': true\r\n            });\r\n        }\r\n    }\r\n\r\n    disease_group.point_group();\r\n};\r\n\r\n/**/\r\ndisease_map.cesium_popup = function (param = null) {\r\n    if (param && Cesium.defined(param.picked)) {\r\n        var center = param.picked.id ? param.picked.id._datas.center_xy : param.picked.primitive.datas.center_xy,\r\n            _id = param.picked.id ? param.picked.id._id : param.picked.primitive.datas.ID,\r\n            id = Cesium.defaultValue(param.picked.id, param.picked.primitive.id),\r\n            properties = param.picked.id ? param.picked.id._datas : param.picked.primitive.datas,\r\n            positions = Cesium.Cartesian3.fromDegrees(center[0], center[1], center[2]),\r\n            position_popup = Cesium.SceneTransforms.wgs84ToWindowCoordinates(param.scene, positions);\r\n\r\n        var _this = disease_map;\r\n        var _cns = [\r\n            { 'id': 'WIDTH', 'name': 'WIDTH_CN', 'unit': 'm' },\r\n            { 'id': 'RADIUS', 'name': 'RADIUS_CN', 'unit': 'm' },\r\n            { 'id': 'SLOPE', 'name': 'SLOPE_CN', 'unit': '' }\r\n        ]\r\n        // RADIUS: \"Infinity\"    m\r\n        // SLOPE: \"-0.017119\"\t\t\r\n        // WITH: \"3.75\",            m\r\n\r\n        if (properties.WIDTH_CN || properties.SLOPE_CN) {\r\n\r\n            $('.cesium_popup .popup_content .image_buttons').css('display', 'none');\r\n            $('.cesium_popup .popup_content .image_texts').css('display', 'block');\r\n\r\n            let _html = `\r\n\t\t\t\t${_cns.map(c => `\r\n\t\t\t\t\t<span>${properties[c.name]} ${properties[c.id]}${c.unit}</span>\r\n\t\t\t\t`).join('')}\r\n\t\t\t`;\r\n            $('.cesium_popup .popup_content .image_texts').html(_html);\r\n            if (properties.LINK_CODE) {\r\n                $('.cesium_popup .popup_content .image_buttons').css('display', 'block');\r\n            }\r\n        } else {\r\n            $('.cesium_popup .popup_content .image_buttons').css('display', 'block');\r\n            $('.cesium_popup .popup_content .image_texts').css('display', 'none');\r\n        }\r\n\r\n        if ((id instanceof Cesium.Entity) || (param.picked.primitive && param.picked.primitive.datas)) {\r\n            function positionPopUp(c) {\r\n                var _x = 0,\r\n                    _y = -123,\r\n                    map_width = $('#cesium_map').width(),\r\n                    left_width = $('.cesium_map_left').width(),\r\n                    map_height = $('#cesium_map').height(),\r\n                    type_width = map_width - position_popup.x,\r\n                    type_height = map_height - position_popup.y;\r\n                if (type_width < 289) {\r\n                    _x = -289;\r\n                }\r\n                if (position_popup.y < 115) {\r\n                    _y = 8;\r\n                }\r\n\r\n                var x = position_popup.x + _x + left_width,\r\n                    y = position_popup.y + _y;\r\n                $(\".cesium_popup\").css('transform', 'translate3d(' + x + 'px, ' + y + 'px, 0)');\r\n            }\r\n            $(\".cesium_popup\").show();\r\n            //\t        \tif(param._id != _id){\r\n            positionPopUp();\r\n            //\t       \t\t}\r\n            $('.leaflet-popup-close-button').click(function () {\r\n                $(\".cesium_popup\").hide();\r\n                return false;\r\n            });\r\n            return id;\r\n        }\r\n    }\r\n};\r\n\r\n/**/\r\ndisease_map.cesium_popup_html = function (param) {\r\n    var param_id = param.picked.id ? param.picked.id._id : param.picked.primitive.datas.ID,\r\n        datas = param.picked.id ? param.picked.id.datas : param.picked.primitive.datas,\r\n        update_time = datas.update_time ? datas.update_time.split('/').join('.') : '',\r\n        create_time = new Date(datas.create_time),\r\n        new_create_time = $.timeConvert(create_time, true),\r\n        class_name = 'child_body_grade_value grade_' + datas.subtype,\r\n        info_view_type_2 = datas.mp_codes_0 + ' ' + datas.mp_codes_1 + datas.mp_codes_2 + ' ' + datas.cn_up_down,\r\n        track_point_id = datas.T_POINT_ID,\r\n        place_value = datas.cn_mark + ' ' + datas.cn_up_down,\r\n        track_image_url = config_url.krs + 'image/get?trackPointId=' + track_point_id + '&type=00&seq=005&imageType=jpg';\r\n\r\n    if (param._id != param_id || datas.TYPE == '703') {\r\n        $('.cesium_popup .popup_content_head b').html(datas._cn_type || '');\r\n        $('.cesium_popup .popup_content_head .child_body_grade_value').html(datas._cn_subtype || '');\r\n        $('.cesium_popup .popup_content_head .child_body_grade_value').attr('class', class_name);\r\n\r\n        $('.cesium_popup .child_body_place .child_body_place_type').html(info_view_type_2);\r\n        $('.cesium_popup .child_body_grade .child_body_grade_time').html(datas.update_time);\r\n\r\n\r\n        /*this.load_image && clearTimeout(this.load_image);\r\n        this.load_image = setTimeout(function(){\r\n            $.getImageToken(\r\n                $('.cesium_popup .popup_img img'),\r\n                track_image_url\r\n            );\r\n        }, this.time_space);*/\r\n    }\r\n\r\n    this.cesium_popup(param);\r\n};\r\n\r\n\r\n/**/\r\ndisease_map.listen_cesium_body = function (dom, type) {\r\n    var class_obj = {\r\n        'disease_list': true,\r\n        'disease_info': true,\r\n        //\t\t\t'disease_player': false\r\n    };\r\n    var width_arr = [],\r\n        dom_width = 0;\r\n    for (var class_name in class_obj) {\r\n        var bound_rect = $('#highway_disease .' + class_name)[0].getBoundingClientRect(),\r\n            display_type = $('#highway_disease .' + class_name).css('display'),\r\n            bound_rect_type = (bound_rect && bound_rect.left < -1) ? false : true,\r\n            width = $('#highway_disease .' + class_name)[0].offsetWidth - 10;\r\n\r\n        if (class_name != dom && display_type == 'block' && bound_rect_type) {\r\n            if (class_name == 'screen_model') {\r\n                width += 344;\r\n            }\r\n            width_arr.push(width);\r\n        }\r\n    }\r\n    if (type && class_obj[dom]) {\r\n        dom_width = $('#highway_disease .' + dom)[0].offsetWidth - 10;\r\n    }\r\n\r\n    width_arr.push(dom_width);\r\n    width_arr.sort(function (a, b) {\r\n        return b - a;\r\n    });\r\n\r\n    var max_width = width_arr[0],\r\n        map_width = 'calc(100% - ' + max_width + 'px)';\r\n\r\n    $('#cesium_map_parent .cesium_map_left').width(max_width);\r\n    $('#cesium_map_parent #cesium_map').width(map_width);\r\n\r\n\tdisease_map.setResize();\r\n};\r\n\r\n\r\n/*postrender,*/\r\ndisease_map.postRender = function () {\r\n    _viewer.scene.postRender.addEventListener(function () {\r\n        if (disease_map.camera_zoom > 17) {\r\n            var entitys = disease_player.current_disease || {};\r\n            for (var id in entitys) {\r\n                var _entity = entitys[id],\r\n                    _show = _entity.show,\r\n                    nodes = _entity._nodes,\r\n                    new_nodes = [],\r\n                    points_center = $.getPointsCenter(nodes, true);\r\n\r\n                for (var i = 0; i < nodes.length; i++) {\r\n                    var positions = Cesium.Cartesian3.fromDegrees(nodes[i][0], nodes[i][1], nodes[i][2]);\r\n                    //\t\t    \t\t\t\tnew_positions = _viewer.scene.clampToHeight(positions, [_entity]);\r\n                    console.log(positions)\r\n                }\r\n\r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nexport {\r\n    disease_map\r\n};\r\n\r\n// module.exports = disease_map;\r\n\r\n\r\n\r\n\r\n\r\n\r\n","\r\n/**\r\n * \r\n */\r\n\r\nimport {\r\n    SlideList\r\n} from './disease_slide.js';\r\nimport {\r\n    disease_map\r\n} from './disease_main_map.js';\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\nimport {\r\n    disease_init\r\n} from './disease_init.js';\r\nimport {\r\n    disease_leaflet\r\n} from './disease_leaflet.js';\r\nimport {\r\n    disease_group\r\n} from './disease_group.js';\r\nimport {\r\n    projection\r\n} from './get_show_polygon.js';\r\nimport { cesium_player } from './play_window/cesium_player.js'\r\n\r\nvar disease_player = {};\r\n\r\n/*  */\r\nvar playerInterfaceStatus = false;\r\n\r\ndisease_player.catch_count = 10;\r\ndisease_player.recog_result = '2';\t\t//\r\ndisease_player.current_num = null;\t\t//\r\ndisease_player.default_num = null;\t\t//\r\ndisease_player.track_list = null;\t\t//\r\ndisease_player.camera_params = null;\t//\r\ndisease_player.position_icon = null;\t//layer\r\ndisease_player.current_disease = {};\t//\r\ndisease_player.context = null;\t\t\t//canvas-\r\ndisease_player.max_distance = 20;\t\t//20M\r\ndisease_player.timing = null;\t\t\t//\r\ndisease_player.time_space = 750;\t\t//\r\ndisease_player.entitys = null;\r\ndisease_player.entitys_utm = null;\r\ndisease_player.click_types = false;\r\n\r\ndisease_player.player_init = function(type=false) {\r\n\t\r\n\tif(Disease.TYPE_LIST.ID == \"ASSET_INSPECTION\"){\r\n\t\tdisease_player.max_distance = 100;\r\n\t}else{\r\n\t\tdisease_player.max_distance = 20;\r\n\t}\r\n\t\r\n\tvar _this = this;\r\n\twindow.three_viewer = null;\t\t\t//threeJS\r\n\t\r\n\t_this.current_num = 1;\r\n\t_this.track_list = {};\r\n\t/*var ratio_width = 608 / 2448,\r\n\t\tratio_height = ratio_width * 2048,\r\n\t\t_height = Number(ratio_height);\r\n\r\n\t$('.disease_player_body .player_image').css('height', _height);\r\n\t$('.disease_player_body .player_image #canvas_three').css('height', _height);*/\r\n\t_this.three_init();\r\n\t_this.cesiumPlayer_init();\r\n\t// animate();\r\n\t\r\n\t/**/\r\n\t/*$('.disease_player').on('keydown', '.player_speed input.player_speed_current', function (e) {\r\n\t\tif(e.keyCode == 13){\r\n\t\t\tvar _value = e.target.value;\r\n\t\t\t_this.current_num = parseInt(_value);\r\n\t\t\t\r\n\t\t\tif(current_num < 1){\r\n\t\t\t\t_this.current_num = 1;\r\n\t\t\t}else if(current_num > _this.track_list.length){\r\n\t\t\t\t_this.current_num = _this.track_list.length;\r\n\t\t\t}\r\n\t\t\t_this.player_skip();\r\n\t\t}\r\n\t});*/\r\n\t\r\n\t$('.disease_info').on('click', '.geometriesLabel', function () {\r\n\t\tlet id = this.getAttribute('dataid') || null;\r\n\t\tlet info = trackBufferResults.features.find( d => { return d.properties.ID == id } );\r\n\t\tif(id && info){\r\n\t\t\tdisease_info.come_to_info(info,true,true);\r\n\t\t}\r\n\t})\r\n\t/*--*/\r\n\t$('.disease_player').on('click', '.player_recog .label input', function (e) {\r\n\t\t_this.recog_result = !_this.recog_result;\r\n\t\tthis.checked = _this.recog_result;\r\n\t\t_this.player_recog();\r\n\t});\r\n\t/**/\r\n\t$('.disease_info').on('click', '.player_video button.next_image', function (e) {\r\n\t\t_this.view_info_types(true);\r\n\t\t_this.next_image();\r\n\t});\r\n\t/**/\r\n\t$('.disease_info').on('click', '.player_video button.pre_image', function (e) {\r\n\t\t_this.view_info_types(true);\r\n\t\t_this.pre_image();\r\n\t});\r\n\t/*-*/\r\n\t$('.disease_info').on('click', '.player_video button.play_image', function () {\r\n\t\t_this.view_info_types(true);\r\n\t\t_this.player_icon_change();\r\n\t})\r\n\t/*--*/\r\n\t$('.disease_info').on('click', '.player_video button.player_to_info', function () {\r\n\t\t_this.view_info_types();\r\n\t\tdisease_player.player_icon_change(true);\r\n\t\t_this.timing && clearInterval(_this.timing);\r\n\t\t_this.current_num = _this.default_num;\r\n\t\t_this.player_skip();\r\n\t})\r\n\t/**/\r\n\t$('.disease_info').on('click', '.player_video button.download_image', function () {\r\n\t\t$.errorView('');\r\n\t})\r\n\t/**/\r\n\t$('.disease_info .info_header .menu_feedback').click(function(){\r\n\t\t$('textarea.desc').val('');\r\n\t\tSlideList.menu_feedbacks(true);\r\n\t})\r\n\t/**/\r\n\t$('.disease_info .info_header .menu_manage').mouseover(function(){\r\n\t\t$('.disease_info .menu_list').css('display', 'block');\r\n\t})\r\n\t$('.disease_info .info_header .menu_manage').mouseout(function(){\r\n\t\t$('.disease_info .menu_list').css('display', 'none');\r\n\t})\r\n\t/**/\r\n\t$('.disease_info .info_header .menu_collect').click(function(){\r\n\t\tlet type = $('.menu_collect').hasClass('active');\r\n\t\tSlideList.menu_collects(type);\r\n\t})\r\n\t/**/\r\n\t$('.disease_info .info_header .menu_mark').click(function(e){\r\n\t\tif(!disease_player.track_list.length){\r\n\t\t\t$.errorView('...');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet _name = $('.disease_info .info_header .menu_mark').attr('name');\r\n\t\tif(_name){\r\n\t\t\tdisease_map.right_point = _name;\r\n\t\t\tdisease_map.menuMarks(true, function(){\r\n\t\t\t\t_this.mark_type_init();\r\n\t\t\t});\r\n\t\t}else{\r\n\t\t\tlet _track = _this.track_list[_this.current_num - 1];\r\n\t\t\tdisease_map.right_point = _track.map_center;\r\n\t\t\tdisease_map.menuMarks();\r\n\t\t}\r\n\t})\r\n\t/**/\r\n\t$('.cesium_popup_mark a.mark_point').click(function(){\r\n\t\tdisease_map.menuMarks();\r\n\t})\r\n\t/**/\r\n\t$('.cesium_popup_mark a.remove_point').click(function(){\r\n\t\tdisease_map.menuMarks(true, function(){\r\n\t\t\t_this.mark_type_init();\r\n\t\t});\r\n\t})\r\n\t/*,*/\r\n\t$('.disease_info').on('click', '.info_image a.full_back_index', function () {\r\n\t\tSlideList.full_screen(true);\r\n\t\t\r\n\t\t_this.view_info_types();\r\n\t\t_this.timing && clearInterval(_this.timing);\r\n\t\t_this.player_closer();\r\n\t\t\r\n\t\t$('.disease_info').fadeOut(100);\r\n\t\tdisease_list.position_group_change();\r\n\t\tdisease_map.change_last_point();\r\n\t\tdisease_info.polygon_info(true);\r\n\t\tdisease_map.listen_cesium_body('disease_info', false);\r\n\t\t\r\n\t\tvar active_dom = Disease.TYPE_LIST.FUNBUTTON.find(function(data){\r\n\t\t    return data.ACTIVE == 'active';\r\n\t\t})\r\n\t\tdisease_init.player_mode_init(active_dom.ID);\r\n\t});\r\n\t/*:,*/\r\n\t$('.disease_info').on('click', '.info_header a.info_header_close', function () {\r\n\t\t_this.player_close();\r\n\t});\r\n\t/**/\r\n\t$('.disease_info').on('mouseover', 'button.search_image', function () {\r\n\t\t$(\".disease_info .speed_list_group\").css('display', 'block');\r\n\t})\r\n\t$('.disease_info').on('mouseleave', 'div.speed_list', function () {\r\n\t\t$(\".disease_info .speed_list_group\").css('display', 'none');\r\n\t})\r\n\t/**/\r\n\t$('.disease_info').on('mouseover', 'button.pdds_result', function () {\r\n\t\t$(\".disease_info .result_list_group\").css('display', 'block');\r\n\t})\r\n\t$('.disease_info').on('mouseleave', 'div.result_list', function () {\r\n\t\t$(\".disease_info .result_list_group\").css('display', 'none');\r\n\t})\r\n\t/*$('button.player_speed').click(function(){\r\n\t\t$(\".player_toggle_button .speed_list\").toggle();\r\n\t})*/\r\n\t/**/\r\n\t$('.disease_info').on('click', '.speed_list_group li', function () {\r\n\t\t_this.view_info_types(true);\r\n\t\tlet _time = this.getAttribute('type'),\r\n\t\t\t_text = this.innerText;\r\n\t\t\r\n\t\t$(\".disease_info .speed_list_group\").css('display', 'none');\r\n\t\t$(\".speed_list_group li\").removeClass('active');\r\n\t\tthis.setAttribute('class', 'active');\r\n\t\t_this.time_space = Number(_time);\r\n\t\t$(\".play_image span\").attr('class', 'iconfont iconzanting');\r\n\t\t$(\".search_image\").text(_text);\r\n\t\t\r\n\t\t_this.timing && clearInterval(_this.timing);\r\n\t\t_this.timing = setInterval(function(){\r\n\t\t\t_this.next_image();\r\n\t\t}, _this.time_space);\r\n\t})\r\n\t/**/\r\n\t$('.disease_info').on('click', '.result_list_group li', function () {\r\n\t\tlet _text = this.innerText;\r\n\t\t_this.recog_result = this.getAttribute('type');\r\n\t\t\r\n\t\t$(\".disease_info .result_list_group\").css('display', 'none');\r\n\t\t$(\".result_list_group li\").removeClass('active');\r\n\t\tthis.setAttribute('class', 'active');\r\n\t\t$(\".pdds_result\").text(_text);\r\n\t\tdisease_leaflet.disease_region();\r\n\t\t_this.disease_region();\r\n\t})\r\n\t/**/\r\n\t$('.disease_player').on('click', '.player_restore', function () {\r\n\t\t_this.current_num = _this.default_num;\r\n\t\t_this.update_image();\r\n\t})\r\n\t/**/\r\n\t$('.info_image').on('click', '.full_screen_control', function () {\r\n\t\tSlideList.full_screen(true);\r\n\t\t\r\n\t\tvar _type = $('.image_opacity .checkbox_label input')[0].checked;\r\n\t\tif(!_type){\r\n\t\t\tcesium_player.update();\r\n\t\t}\r\n\t\tcesium_player.change_toggle(_type);\r\n\t\t\r\n\t})\r\n\t/**/\r\n\t$('.info_image').on('click', '.history_control', function () {\r\n\t\t$.errorView('');\r\n\t})\r\n\t\r\n//\t\t_this.request_track();\r\n};\r\n\r\n/*  */\r\ndisease_player.player_close = function(){\r\n\t\r\n\tplayerInterfaceStatus = false;\r\n\t\r\n\tlet _this = disease_player;\r\n\t\r\n\t_this.view_info_types();\r\n\t_this.timing && clearInterval(_this.timing);\r\n\t_this.player_closer();\r\n\t\r\n\t$('.disease_info').fadeOut(100);\r\n\tdisease_list.position_group_change();\r\n\t// disease_map.change_last_point();\r\n\t// disease_info.polygon_info(true);\r\n\tdisease_map.listen_cesium_body('disease_info', false);\r\n\t\r\n\tvar active_dom = Disease.TYPE_LIST.FUNBUTTON.find(function(data){\r\n\t\treturn data.ACTIVE == 'active';\r\n\t})\r\n\tdisease_init.player_mode_init(active_dom.ID);\r\n\t\r\n}\r\n\r\n/**/\r\ndisease_player.view_info_types = function(type=false){\r\n\tif(Disease.TYPE_LIST.ID == 'ASSET_INSPECTION'){\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tlet class_none = type ? 'info_view' : 'info_view_statistics',\r\n\t\tclass_block = type ? 'info_view_statistics' : 'info_view',\r\n\t\tbtn_display = type ? 'block' : 'none';\r\n\t$('.disease_info .'+class_none).css('display', 'none');\r\n\t$('.disease_info .'+class_block).css('display', 'block');\r\n\t\r\n\t$('.disease_info .player_to_info').css('display', btn_display);\r\n};\r\n\r\n/**/\r\ndisease_player.player_closer = function(){\r\n\t\r\n\tdisease_map.removePlayerPoint();\r\n\tremoveLineLayer();\r\n\t\r\n\t// disease_player.remove_entity();\r\n\t// disease_group.point_group();\r\n};\r\n\r\n/**/\r\ndisease_player.player_icon_change = function(parent=false){\r\n\tvar _this = this;\r\n\tvar type = $(\".play_image span\").hasClass(\"iconbofang\"),\r\n\t\tclassName = (type && !parent) ? 'iconfont iconzanting' : 'iconfont iconbofang';\r\n\t\r\n\t$(\".play_image span\").attr('class', className);\r\n\t\r\n\tif(type && !parent){\r\n\t\t_this.timing = setInterval(function(){\r\n\t\t\t_this.next_image();\r\n\t\t}, _this.time_space);\r\n\t}else{\r\n\t\t_this.timing && clearInterval(_this.timing);\r\n\t}\r\n};\r\n\r\n/*--*/\r\ndisease_player.player_start_init = function(){\r\n\t\r\n\tif(window.three_viewer && window.three_viewer.scene){\r\n\t\twindow.three_viewer.scene.removeAllMeasurements();\r\n\t\twindow.three_viewer.scene.sceneBG.fg_texture_1.image.src = '';\r\n\t\twindow.three_viewer.scene.sceneBG.fg_texture_1.needsUpdate = true;\r\n\t}\r\n\t\r\n\tvar title = Disease.TYPE_LIST.TITLE;\r\n\tvar det_time = disease_info.current_info.det_time || '';\r\n\tvar _control = `\r\n\t\t\t<button class=\"btn btn-default player_to_info\" title=\"${title}\">\r\n\t\t\t\t<span></span>${title}\r\n\t\t\t</button>\r\n\t\t\t<div class=\"player_toggle_2\">\r\n\t\t\t\t<button class=\"btn btn-default pre_image\" title=\"\"></button>\r\n\t\t\t\t<button class=\"btn btn-default play_image\" title=\"\">\r\n\t\t\t\t\t<span class=\"iconfont iconbofang\"></span>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class=\"btn btn-default next_image\" title=\"\"></button>\r\n\t\t\t</div>\r\n\t\t\t<button class=\"btn btn-default download_image\" title=\"\"></button>\r\n\t\t\t<div class=\"speed_list\">\r\n\t\t\t\t<ul class=\"speed_list_group\">\r\n\t\t\t\t\t<li class=\"\" type=\"1000\">0.5x</li>\r\n\t\t\t\t\t<li class=\"active\" type=\"750\">1.0x</li>\r\n\t\t\t\t\t<li class=\"\" type=\"500\">2.0x</li>\r\n\t\t\t\t</ul>\r\n\t\t\t\t<button class=\"btn btn-default search_image\" title=\"\"></button>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"result_list\">\r\n\t\t\t\t<ul class=\"result_list_group\">\r\n\t\t\t\t\t<li class=\"\" type=\"1\">${title}</li>\r\n\t\t\t\t\t<li class=\"active\" type=\"2\">${title}</li>\r\n\t\t\t\t\t<li class=\"\" type=\"3\"></li>\r\n\t\t\t\t</ul>\r\n\t\t\t\t<button class=\"btn btn-default pdds_result\">${title}</button>\r\n\t\t\t</div>\r\n            <div class=\"image_opacity\" style=\"float: right;padding-top: 18px;margin-top: -10px;display: none;\">\r\n                \r\n\t\t\t\t<label class=\"checkbox_label\" style=\"float: left;margin-right: 10px;\">\r\n\t\t\t\t\t<input type=\"checkbox\" value=\"\">\r\n\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t<span style=\"float: left;line-height: 18px;\"></span>\r\n\t\t\t\t</label>\r\n\t\t\t\t\r\n                <input class=\"image_opacity_change\" style=\"width: 60px;\" type=\"range\" min=\"0\" max=\"100\" value=\"${cesium_player._alpha}\" />\r\n            </div>\r\n\t`;\r\n\t$('.player_control .player_button').html(_control);\r\n\t\r\n\tvar level = $('.cesium_control .zoom_level a').html(),\r\n\t\tnew_level = Number(level);\r\n\tif(new_level < 20){\r\n\t\tvar height = disease_user.zoomToAltitude(20);\r\n\t\t\t// center = $.getCenterPoint();\r\n\t\t// _viewer.camera.setView({\r\n\t\t// \tdestination: Cesium.Cartesian3.fromDegrees(disease_info.current_info.properties.center_xy[0], disease_info.current_info.properties.center_xy[1], height)\r\n\t\t// })\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_player.RangeSlider = function(obj){\r\n\tvar _this = this;\r\n\t_this.sliderCfg = {\r\n\t\tmin: obj && !isNaN(parseFloat(obj.min)) ? Number(obj.min) : null, \r\n\t\tmax: obj && !isNaN(parseFloat(obj.max)) ? Number(obj.max) : null,\r\n\t\tstep: obj && Number(obj.step) ? obj.step : 1,\r\n\t\tvalue: obj && Number(obj.value) ? obj.value : 1\r\n\t};\r\n\t\r\n\tvar $input = $('input.player_speed_range'),\r\n\t\tmin = _this.sliderCfg.min,\r\n\t\tmax = _this.sliderCfg.max,\r\n\t\tstep = _this.sliderCfg.step;\r\n\t\r\n\t$(\".player_speed_current\").attr('max',max);\r\n\t$(\".player_speed_current\").attr('min',min);\r\n\t$input.attr('max',max);\r\n\t$input.attr('min',min);\r\n\t\r\n\t_this.player_skip();\r\n\t\r\n\t$input.bind(\"input\", function(e){\r\n\t\t_this.current_num = parseInt(this.value);\r\n\t\t_this.player_skip();\r\n\t});\r\n};\r\n\r\n/*-*/\r\nvar trackBufferResults = {\r\n\t'type': 'FeatureCollection',\r\n\t'features': []\r\n};\r\ndisease_player.request_track = function(type=false){\r\n\t\r\n\tdisease_map.removePlayerPoint();\r\n\tdisease_map.setZoom(18);\r\n\t\r\n\ttrackBufferResults = {\r\n\t\t'type': 'FeatureCollection',\r\n\t\t'features': []\r\n\t};\r\n\tplayerInterfaceStatus = true;\r\n\t\r\n\tvar _this = this;\r\n\t// disease_group.entity_hide();\r\n\t\r\n\tvar trackId = disease_info.current_info.properties.TRACK_ID,\r\n\t\ttrackPointId = disease_info.current_info.properties.T_POINT_ID;\r\n\t\r\n\tif(!trackId){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tremoveLineLayer();\r\n\tvar _url = config_url.krs + 'v3/track/get/tracks/byTrackIds?dynamicCal=true&trackIds=' + trackId;\r\n\t// var _url = 'http://krs.kuandeng.com/krs/v3/track/get/tracks/byTrackIds?dynamicCal=true&trackIds=204427434_20200815093817824';\r\n\t\r\n\t$.getAjax({\r\n\t\t'url': _url,\r\n\t\t'callback': function(data){\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView(data.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tlet pointList = data.result[0] ? data.result[0].pointList : [];\r\n\t\t\tif(!pointList.length){\r\n\t\t\t\t$.errorView('');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttrackBufferDatas(pointList);\r\n\t\t\t_this.track_list = newPointList(pointList);\r\n\t\t\t// _this.track_list = pointList;\r\n\t\t\t_this.camera_params = data.result[0].cameraParams;\r\n\t\t\t_this.camera_params.azimuthDelta = data.result[0].azimuthDelta;\r\n\t\t\t_this.camera_params.pitchDelta = data.result[0].pitchDelta;\r\n\t\t\t_this.camera_params.rollDelta = data.result[0].rollDelta;\r\n\t\t\t_this.camera_params.cameraHeight = data.result[0].cameraHeight;\r\n\t\t\tvar index = _this.track_list.findIndex(data => data.trackPointId === trackPointId);\r\n\t\t\t_this.current_num = (index > -1) ? (index+1) : 1;\r\n\t\t\t_this.default_num = (index > -1) ? (index+1) : 1;\r\n\t\t\t_this.RangeSlider({\r\n\t\t\t\tmin: 1,\r\n\t\t\t\tmax: _this.track_list.length,\r\n\t\t\t\tstep: 0.1\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tvar track_data = _this.track_list[_this.current_num - 1];\r\n\t\t\t// _this.position_point_center(track_data);\r\n\t\t}\r\n\t})\r\n\t\r\n};\r\n\r\n/* buffer */\r\nvar bufferWidth = 100;\r\nfunction getBufferPromise(list) {\r\n\treturn new Promise(function (resolve, reject) {\r\n\t\tvar lineArr = [];\r\n\t\tlist.forEach((point) => {\r\n\t\t\tlineArr.push([\r\n\t\t\t\tpoint.x, point.y\r\n\t\t\t])\r\n\t\t})\r\n\t\tif(!lineArr.length){\r\n\t\t\tresolve(null);\r\n\t\t}\r\n\t\t\r\n\t\tvar gsonline = turf.lineString(lineArr);\r\n\t\t// var buffered = turf.buffer(line, bufferWidth, {units: 'miles'});\r\n\t\tvar buffered = turf.buffer(gsonline, bufferWidth, {units: 'meters'});\r\n\t\t\r\n //        const endindex = gsonline.geometry.coordinates.length - 1;\r\n //        // \r\n //        var lsl = turf.transformRotate(gsonline, -90, {\r\n //            pivot: gsonline.geometry.coordinates[0]\r\n //        });\r\n //        // \r\n //        var lsr = turf.transformRotate(gsonline, 90, {\r\n //            pivot: gsonline.geometry.coordinates[0]\r\n //        });\r\n //        // \r\n //        var lel = turf.transformRotate(gsonline, 90, {\r\n //            pivot: gsonline.geometry.coordinates[endindex]\r\n //        });\r\n //        // \r\n //        var ler = turf.transformRotate(gsonline, -90, {\r\n //            pivot: gsonline.geometry.coordinates[endindex]\r\n //        });\r\n //        var buffered = turf.buffer(gsonline, 100, {\r\n //            units: 'meters'\r\n //        });\r\n //        // bufferfeatureCollection\r\n //        var bufferedtoline = turf.polygonToLine({\r\n\t// \t\t\"type\":\"Feature\",\r\n\t// \t\t\"properties\":{},\r\n\t// \t\t\"geometry\":{\r\n\t// \t\t\t\"type\":\"Polygon\",\r\n\t// \t\t\t\"coordinates\":[ buffered.geometry.coordinates[0] ],\r\n\t// \t\t},\r\n\t// \t});\r\n //        let pointsarr = [];\r\n //        bufferedtoline.geometry.coordinates.forEach((coord) => {\r\n //            const point = turf.point(coord);\r\n //            pointsarr.push(point)\r\n //        })\r\n //        var points = turf.featureCollection(pointsarr);\r\n \r\n //        // 4(buffer)\r\n //        const four_gline = [lel, lsl, lsr, ler]\r\n //        let intersectpointarr = [];\r\n //        four_gline.forEach((i) => {\r\n //            var intersects = turf.lineIntersect(i, buffered);\r\n //            const intersectpoint = intersects.features[0];\r\n //            intersectpointarr.push(intersectpoint);\r\n //        })\r\n \r\n //        let four_index = [];\r\n //        intersectpointarr.forEach((i) => {\r\n //            var nearest = turf.nearestPoint(i, points);\r\n //            four_index.push(nearest.properties.featureIndex);\r\n //            // console.log(nearest.geometry.coordinates)\r\n //        })\r\n \r\n //        console.log(four_index);\r\n //        const splicetop = four_index[3] - four_index[0];\r\n //        const splicebtm = four_index[1] - four_index[2];\r\n //        const coordinates = buffered.geometry.coordinates[0];\r\n //        coordinates.splice(four_index[0] + 1, splicetop - 1);\r\n //        coordinates.splice(four_index[2] + 2 - splicetop, splicebtm - 1);\r\n\t\t\r\n\t// \tcoordinates.push(\r\n\t// \t\tcoordinates[0]\r\n\t// \t)\r\n\t\t\r\n //        console.log(coordinates);\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tvar coordinates = buffered.geometry.coordinates[0];\r\n\t\tvar polygonOpt = [];\r\n\t\t\r\n\t\tcoordinates.forEach( d => {\r\n\t\t\tpolygonOpt.push( d[0] + ' ' + d[1] );\r\n\t\t})\r\n\t\t\r\n\t\tvar polygonStr = 'POLYGON((' + polygonOpt.join(',') + '))';\r\n\t\tresolve(polygonStr);\r\n\t});\r\n}\r\n\r\n/* buffer */\r\nfunction getBoundsDataPromise(buffer) {\r\n\treturn new Promise(function (resolve, reject) {\r\n\t\tlet dataVersion = disease_user.current_adcode.dataVersion;\r\n\t\tlet dataCode = Disease.TYPE_LIST.DATACODE;\r\n\t\t\r\n\t\tlet newDataCode = (dataCode == 'pd') ? 'pd_show' : dataCode;\r\n\t\t\r\n\t\tlet url = config_url.pdds + 'data/' + newDataCode + '/query';\r\n\t\tlet currentInfo = disease_info.current_info.properties;\r\n\t\tlet linkCode = currentInfo.LINK_CODE;\r\n\t\tlet trackId = currentInfo.TRACK_ID;\r\n\t\tlet body = {\r\n\t\t\t'ops': [{\r\n\t\t\t\t'k': 'DATA_VERSION',\r\n\t\t\t\t'v': dataVersion,\r\n\t\t\t\t'op': 'eq'\r\n\t\t\t},{\r\n\t\t\t\t'k': 'LINK_CODE',\r\n\t\t\t\t'v': linkCode,\r\n\t\t\t\t'op': 'eq'\r\n\t\t\t}],\r\n\t\t\t'returnFields': [\r\n\t\t\t\t// 'CENTROID', 'GEOM', 'ID', 'TYPE', 'SUBTYPE', 'TRACK_ID', 'adcode', '_OID_',  'T_POINT_ID'\r\n\t\t\t],\r\n\t\t\t'polygon': buffer\r\n\t\t}\r\n\r\n        $.postAjax({\r\n            'url': url,\r\n            'token': true,\r\n            'data': body,\r\n            'callback': function (data) {\r\n                if (data.code != '0') {\r\n                    $.errorView('' + data.message);\r\n                    resolve( {} );\r\n                } else {\r\n                    resolve( data.result.data );\r\n                }\r\n            }\r\n        })\r\n\t});\r\n}\r\n\r\n/* buffer--10 */\r\nfunction  trackBufferDatas(list){\r\n\tplayerInterfaceStatus && getBufferPromise(list).then((buffer) => {\r\n\t\t\r\n\t\tplayerInterfaceStatus && getBoundsDataPromise(buffer).then((data) => {\r\n\t\t\t\r\n\t\t\tvar features = data.features || [];\r\n\t\t\tfeatures.forEach( d => {\r\n\t\t\t\tvar new_data = disease_list.dataInfoFormat(d);\r\n\t\t\t\ttrackBufferResults.features.push( new_data );\r\n\t\t\t} )\r\n\t\t\t\r\n\t\t\t// playerCounterThrow();\r\n\t\t\tdisease_init.image_type_go();\r\n\t\t})\r\n\t\t\r\n\t})\r\n}\r\n\r\n\r\n/*buffer*/\r\nfunction playerCounterThrow(){\r\n\t\r\n\tconsole.log(trackBufferResults)\r\n\t\r\n\tvar catch_distance = {};\r\n\tfor(var i=0; i<trackBufferResults.length; i++){\r\n\t\tvar properties = trackBufferResults[i].properties,\r\n\t\t\tid = properties.ID,\r\n\t\t\tnew_id = properties.layer_type + '_' + properties.ID,\r\n\t\t\tways = {'_nodes': properties.locs};\r\n\t\t\r\n\t\tcatch_distance[new_id] = {\r\n\t\t\t'ways': ways,\r\n\t\t\t'properties': properties\r\n\t\t};\r\n\t}\r\n\t\r\n\tthis.entitys = catch_distance;\r\n\tthis.entitys_utm = trackBufferResults;\r\n\t// this.get_projection(trackpoint);\r\n\t\r\n\tdisease_init.image_type_go();\r\n};\r\n\r\n\r\ndisease_player.getTrackBufferResults = function(){\r\n\treturn trackBufferResults;\r\n}\r\n\r\n/*  */\r\ndisease_player.isPlayerInterfaceStatus = function(){\r\n\treturn playerInterfaceStatus;\r\n}\r\n\r\n/**/\r\ndisease_player.player_skip = function(){\r\n\tif( 0<this.current_num && this.current_num<=this.track_list.length ){\r\n\t\tvar $input = $('input.player_speed_range'),\r\n\t\t\t_max = $('.player_speed_range').attr('max'),\r\n\t\t\t_ratio = (this.current_num / _max) * 100;\r\n\t\t\r\n\t\t$input.attr('value', this.current_num);\r\n\t\t$input.css( 'background-size', _ratio + '% 100%' );\r\n\t\tthis.update_image();\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_player.next_image = function(){\r\n\tif(this.current_num < this.track_list.length){\r\n\t\tthis.current_num ++;\r\n\t\tthis.player_skip();\r\n\t}else{\r\n\t\t$.errorView('');\r\n\t\tthis.player_icon_change(true);\r\n\t\treturn\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_player.pre_image = function(){\r\n\tif(this.current_num > 1){\r\n\t\tthis.current_num --;\r\n\t\tthis.player_skip();\r\n\t}else{\r\n\t\t$.errorView('');\r\n\t\treturn\r\n\t}\r\n};\r\n\r\n/**/\r\ndisease_player.update_image = function(type){\r\n\tvar token = $.getCookie('token') || '';\r\n\tif(!token){\r\n\t\t$.errorView('token');\r\n\t\tlet _url = './login.html';\r\n\t\twindow.open(_url, '_self');\r\n\t}\r\n\t\r\n//\t\tthis.catchPotreeImage(this.track_list);\r\n\t\r\n\t$(\".player_speed_current\").val(this.current_num);\r\n\tvar _index = this.current_num - 1,\r\n\t\ttrack_data = this.track_list[_index];\r\n//\t\t$('.player_image svg image')[0].setAttribute('xlink:href', point_url);\r\n//\t\t$('.player_image img')[0].setAttribute('src', point_url);\r\n\t/*$.getImageToken(\r\n\t\t$('.player_image img'),\r\n\t\tpoint_url\r\n\t);*/\r\n\t\r\n\t\r\n\tvar data_type = $('.player_toggle').attr('data-type');\r\n\tif(data_type == '1' && this.current_num != this.default_num){\r\n\t\t$('.player_restore').css('display', 'block');\r\n\t}else{\r\n\t\t$('.player_restore').css('display', 'none');\r\n\t}\r\n\tthis.position_icon_change(track_data,type);\r\n\tthis.mark_type_init();\r\n\tif(disease_init.play_image_type == 'visua_up_map'){\r\n\t\tdisease_init.image_type_go(type);\r\n\t\treturn;\r\n\t}\r\n\tthis.setImageUrlPotree();\r\n};\r\n\r\n/*--*/\r\ndisease_player.mark_type_init = function(){\r\n\t$('.menu_manage .menu_list_child .menu_mark').removeClass('active');\r\n\tlet _track = this.track_list[this.current_num - 1] || {},\r\n\t\thas_class = $('.menu_manage .menu_collect').hasClass('active'),\r\n\t\tmap_center = _track.map_center || [],\r\n\t\tid = '';\r\n\t\r\n\tif(!map_center.length){\r\n\t\treturn;\r\n\t}\r\n\tfor(let i=0; i<disease_map.mark_points.length; i++){\r\n\t\tlet coordinate = disease_map.mark_points[i].geometry.coordinates,\r\n\t\t\tthis_id = disease_map.mark_points[i].properties.ID,\r\n\t\t\tpoint = $('.markLabel_' + this_id);\r\n\t\t\r\n\t\tif( point.length && (coordinate[0] == map_center[0]) && (coordinate[1] == map_center[1]) ){\r\n\t\t\tid = this_id;\r\n\t\t}\r\n\t}\r\n\tif(!has_class){\r\n\t\t$('.menu_manage a.iconshenglvehao').removeClass('active');\r\n\t}\r\n\tif(id){\r\n\t\t$('.menu_manage a.iconshenglvehao').addClass('active');\r\n\t\t$('.menu_manage .menu_list_child .menu_mark').addClass('active');\r\n\t}\r\n\t$('.menu_manage .menu_list_child .menu_mark').attr('name', id);\r\n};\r\n\r\n/*--*/\r\ndisease_player.position_icon_change = function(data){\r\n\tvar rotation = null,\r\n\t\tcenter = [data.x, data.y, data.z],\r\n\t\tazimuth = data.azimuth - 90,\r\n\t\t_index = this.current_num - 1,\r\n\t\tthis_point = [data.x, data.y, data.z],\r\n\t\t\r\n\t\tlast_index = this.current_num - 2,\r\n\t\tlast_data = this.track_list[last_index] || null,\r\n\t\tlast_point = last_data ? [last_data.x, last_data.y, last_data.z] : null,\r\n\t\t\r\n\t\tnext_data = this.track_list[this.current_num] || null,\r\n\t\tnext_point = next_data ? [next_data.x, next_data.y, next_data.z] : null,\r\n\t\t\r\n\t\tpoint_1 = next_point ? this_point : last_point,\r\n\t\tpoint_2 = next_point ? next_point : this_point,\r\n\t\ticon_url = './Apps/Dist/Img/position.png';\r\n\r\n\t/*,6trackpoint*/\r\n\t\t// if(_index > 0){\r\n\t\tvar point = iD.util.getLocationPoint(point_2, point_1, 0.3),\r\n\t\t\tnew_data = [];\r\n\t\tcenter = [point[0], point[1], point[2]];\r\n\t\tfor(var i=0; i<this.track_list.length; i++){\r\n\t\t\tif(i < _index){\r\n\t\t\t\tnew_data.push( this.track_list[i] );\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar distance_data = $.getNearPointList(point, new_data);\r\n\t\tif(distance_data){\r\n\t\t\tcenter = [distance_data.x, distance_data.y, distance_data.z];\r\n\t\t}\r\n\t\t// }\r\n\r\n\tif(next_data){\r\n\t\trotation = $.courseAngle(point_1[0], point_1[1], point_2[0], point_2[1]);\r\n\t}\r\n\tdisease_map.addPlayerPoint({\r\n\t\t'properties': data,\r\n\t\t'coordinates': center,\r\n\t\t'rotation': rotation\r\n\t})\r\n\t\r\n\tdata['map_center'] = center;\r\n\t// this.position_point_center(data);\r\n//\t\tthis.get_projection(data);\r\n\t// this.get_distance(data);\r\n};\r\n\r\ndisease_player.getNorthPointByDistance = function(position, distance) {\r\n\t//x,y,z\r\n\tvar localToWorld_Matrix = Cesium.Transforms.eastNorthUpToFixedFrame(position);\r\n\treturn Cesium.Matrix4.multiplyByPoint(localToWorld_Matrix, Cesium.Cartesian3.fromElements(0, distance, 0), new Cesium.Cartesian3())\r\n};\r\n\r\n/*: */\r\ndisease_player.player_recog = function(){\r\n\tvar _index = this.current_num - 1,\r\n\t\ttrack_data = this.track_list[_index];\r\n\t\r\n\tthis.get_distance(track_data);\r\n};\r\n\r\n// \r\nfunction new_point_distance(trackpoint, locs, type){\r\n\tvar distance = 1000,\r\n\t\tpoint_distance = 0,\r\n\t\t_position = {\r\n\t\t\t'lat1': trackpoint.map_center[0],\r\n\t\t\t'lng1': trackpoint.map_center[1],\r\n\t\t\t'lat2': null,\r\n\t\t\t'lng2': null\r\n\t\t},\r\n\t\tnew_locs = locs;\r\n\tfor(var s=0; s<new_locs.length; s++){\r\n\t\t_position.lat2 =  new_locs[s][0];\r\n\t\t_position.lng2 =  new_locs[s][1];\r\n\t\tpoint_distance = $.disTance(_position);\r\n\t\t\r\n\t\tif(point_distance < distance){\r\n\t\t\tdistance = point_distance;\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn distance;\r\n\t\r\n}\r\n\r\n/*,*/\r\ndisease_player.get_distance = function(trackpoint){\r\n\t\r\n\tconsole.log(trackBufferResults)\r\n\t\r\n\tvar trackPointId = trackpoint.trackPointId,\r\n\t\tcatch_distance = {},\r\n\t\tcatch_distance_utm = {\r\n\t\t\t'features': [],\r\n\t\t\t'type': 'FeatureCollection'\r\n\t\t};\r\n\twindow.lines = [];\r\n\t\r\n\tfor(var i=0; i<disease_list.catchList.length; i++){\r\n\t\tvar _locs = disease_list.catchList[i].locs;\r\n\t\tvar properties = disease_list.catchList[i].properties;\r\n\t\t\r\n\t\t// var distance = new_point_distance(trackpoint, _locs, properties.layer_type);\r\n\t\t\r\n\t\tvar id = properties.ID,\r\n\t\t\tnew_id = properties.layer_type + '_' + properties.ID,\r\n\t\t\tlocs = $.cesium_range(properties.GEOM),\r\n\t\t\tways = {'_nodes': locs};\r\n\t\t\r\n\t\t// if(distance < this.max_distance){\r\n\t\t\t// if(properties.layer_type != 'Point'){\r\n\t\t\t// \tvar new_z = iD.util.pt2LineDist2(locs, trackpoint.map_center),\r\n\t\t\t// \t\tnew_loc = [new_z.x, new_z.y, new_z.dis],\r\n\t\t\t// \t\tfloc = locs[new_z.i],\r\n\t\t\t// \t\ttloc = locs[new_z.i + 1],\r\n\t\t\t// \t\tnew_result = iD.util.getBetweenPointLoc(floc, tloc, new_loc);\r\n\t\t\t\t\r\n\t\t\t// \tvar height_dis = Math.abs( new_result[2] - trackpoint.map_center[2] );\r\n\t\t\t// \tif(height_dis > 2){\r\n\t\t\t// \t\tcontinue\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\t\t\tcatch_distance[new_id] = {\r\n\t\t\t\t'ways': ways,\r\n\t\t\t\t'properties': properties\r\n\t\t\t};\r\n\t\t\tcatch_distance_utm.features.push(\r\n\t\t\t\tdisease_list.catchListUTM[i]\r\n\t\t\t)\r\n\t\t// }\r\n\t}\r\n\tthis.entitys = catch_distance;\r\n\tthis.entitys_utm = catch_distance_utm;\r\n\t// this.get_projection(trackpoint);\r\n\t\r\n\tdisease_init.image_type_go();\r\n};\r\n\r\n// \r\ndisease_player.remove_entity = function(){\r\n\t// if(disease_info.info_ways){\r\n\t// \t_viewer.entities.remove(disease_info.info_ways);\r\n\t// \tdisease_info.info_ways = null;\r\n\t// }\r\n\tif(!this.current_disease){\r\n\t\treturn;\r\n\t}\r\n\tfor(var id in this.current_disease){\r\n\t\t// _viewer.entities.removeById(id);\r\n\t\t// _viewer.entities.remove(this.current_disease[id]);\r\n\t\t_viewer.entities.removeById(this.current_disease[id].id);\r\n\t\tdelete this.current_disease[id];\r\n\t}\r\n}\r\n\r\n/**/\r\ndisease_player.get_projection = function(trackpoint, datas){\r\n\t\r\n\tdisease_player.remove_entity();\r\n\t\r\n\tfor(var id in this.entitys){\r\n\t\t/**/\r\n\t\tvar ways = this.entitys[id].ways;\r\n\t\tif(ways._nodes && (ways._nodes.length > 0)){\r\n\t\t\tvar map_ways = null;\r\n\t\t\tvar layer_type = this.entitys[id].layer_type;\r\n\t\t\tvar properties = this.entitys[id].properties;\r\n\t\t\tvar measurements = [];\r\n\t\t\tproperties['new_ID'] = properties.layer_type + '_' + properties.ID;\r\n\t\t\t/**/\r\n\t\t\tif(!this.current_disease[id]){\r\n\t\t\t\t\r\n\t\t\t\tif(Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS'){\r\n\t\t\t\t\tlayer_type = this.entitys[id].properties.range_type || this.entitys[id].properties.layer_type;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tmap_ways = $.add_layer({\r\n\t\t\t\t\t// 'type': 'position',\r\n\t\t\t\t\t'data_type': 'position',\r\n\t\t\t\t\t'layer_type': layer_type,\r\n\t\t\t\t\t'result': {\r\n\t\t\t\t\t\t'properties': this.entitys[id].properties\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// map_ways = $.add_polygon({\r\n\t\t\t\t// \t'type': 'position',\r\n\t\t\t\t// \t'result': {\r\n\t\t\t\t// \t\t'properties': {\r\n\t\t\t\t// \t\t\t'ID': ('polygon_'+id),\r\n\t\t\t\t// \t\t\t'GEOM': this.entitys[id].properties.locs\r\n\t\t\t\t// \t\t}\r\n\t\t\t\t// \t}\r\n\t\t\t\t// })\r\n\t\t\t\tthis.current_disease[id] = map_ways;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t$.cesium_refresh();\r\n};\r\n\r\n/*--*/\r\ndisease_player.player_projection = function(){\r\n\tlet datas = this.entitys || {};\r\n\t\r\n\t// window.three_viewer.scene.removeAllMeasurements();\r\n\tlet measurements = [];\r\n\t\r\n\tif (!task_line_layers_json['layer_way'] && !task_line_layers_json[\"layer_label\"]) {\r\n\t\tshowLineLayer(\r\n\t\t\ttrackBufferResults\r\n\t\t)\r\n\t}\r\n\t\r\n\t\r\n\tplayerRender();\r\n\t\r\n\t// disease_player.disease_region();\r\n};\r\n\r\n/**/\r\ndisease_player.position_point_center = function(data){\r\n\t// var bbox = $.getBounds(),\r\n\t// \tpoint = {\r\n\t// \t\tlng: data.x,\r\n\t// \t\tlat: data.y\r\n\t// \t};\r\n\t\r\n\t// if(!bbox){\r\n\t// \treturn;\r\n\t// }\r\n\t\r\n\tif(data.map_center){\r\n\t\tpoint = {\r\n\t\t\tlng: data.map_center[0],\r\n\t\t\tlat: data.map_center[1]\r\n\t\t};\r\n\t}\r\n\t\r\n\tvar isPointInBbox = $.isPointInRect(point, bbox),\r\n\t\tz_height = _viewer.camera.positionCartographic.height,\r\n\t\tcenter = Cesium.Cartesian3.fromDegrees(point.lng, point.lat, z_height);\r\n\t\r\n\tif(!junge){\r\n\t\t_viewer.camera.setView({  \r\n\t\t\tdestination: center\r\n\t\t})\r\n\t}\r\n\t/*if(type){\r\n\t\t_viewer.camera.setView({  \r\n\t\t\tdestination: center\r\n\t\t})\r\n\t}else if(!isPointInBbox){\r\n\t\t_viewer.camera.setView({  \r\n\t\t\tdestination: center\r\n\t\t})\r\n\t}*/\r\n};\r\n\r\n\r\n\r\n\r\n\r\ndisease_player.cesiumPlayer_init = function(){\r\n    cesium_player.playerInit();\r\n    cesium_player._alpha = 100;\r\n}\r\ndisease_player.three_init = function(){\r\n\t\r\n\tvar canvas_w = $('#canvas_three').width,\r\n\t\tcanvas_h = $('#canvas_three').height,\r\n\t\taspect = canvas_w / canvas_h;\r\n\twindow.camera = new THREE.PerspectiveCamera(75, aspect, 1, 1000);\r\n\twindow.scene = new THREE.Scene();\r\n    var backgoundImage = new Image();\r\n\t//scene.background = new THREE.Color(0xFFFFFFFF);\r\n\t//\r\n\tvar light = new THREE.AmbientLight(0xffffff, 1);\r\n\tlight.position.set(1, 1, 1).normalize();\r\n\tscene.add(light);\r\n\t//\r\n\t// window.axis = new THREE.AxisHelper();\r\n\t// scene.add(axis);\r\n\t//\r\n\tvar manager = new THREE.LoadingManager();\r\n\tmanager.onLoad = animate;\r\n\t//\r\n\tdisease_player.backgroundTexture = new THREE.Texture();\r\n\t// backgoundImage.src = 'http://krs-dev.kuandeng.com/krs/image/get?trackPointId=204393125_20191202092511346284&type=00&seq=005&imageType=jpg&token=Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJwZGRzIiwiZXhwIjoxNTk4MjY4NzU5fQ.-U0-f52NZRgsXECxmfENMa7nOmvPjF6Hp51QcrtXvOQqLcOG1m8nl103G_jgT94zakGiCkTYtFxCz2GjJYx9fw';\r\n\r\n\tbackgoundImage.src = '';\r\n\t\r\n\tdisease_player.backgroundTexture.image = backgoundImage;\r\n\tdisease_player.backgroundTexture.minFilter = THREE.LinearFilter;\r\n\tbackgoundImage.onload = function () {\r\n\t\t//backgroundTexture=new THREE.Texture();\r\n\t\t//backgroundTexture.image = backgoundImage.src;\r\n\t\tdisease_player.backgroundTexture.needsUpdate = true;\r\n\r\n\t};\r\n\tvar backgroundMaterial = new THREE.MeshBasicMaterial({\r\n\t\tmap: disease_player.backgroundTexture,\r\n\t\ttransparent: true,\r\n\t\topacity: 1\r\n\r\n\t});\r\n\tvar backgroundMesh = new THREE.Mesh(\r\n\t\tnew THREE.PlaneGeometry(2, 2, 0),\r\n\t\tbackgroundMaterial\r\n\t);\r\n\tbackgroundMesh.needsUpdate = true;\r\n\tbackgroundMesh.material.depthTest = false;\r\n\tbackgroundMesh.material.depthWrite = false;\r\n\r\n\twindow.backgroundScene = new THREE.Scene();\r\n\t//\r\n\twindow.backgroundCamera = new THREE.Camera();\r\n\t//\r\n\twindow.backgroundScene.add(window.backgroundCamera);\r\n\twindow.backgroundScene.add(backgroundMesh);\r\n\t//\r\n\tvar raycaster = new THREE.Raycaster();\r\n\traycaster.linePrecision = 3;\r\n\t//\r\n\twindow.renderer = new THREE.WebGLRenderer({\r\n\t\tantialias: true\r\n\t});\r\n\trenderer.setPixelRatio(2);\r\n\t// renderer.setSize(canvas_w, canvas_h);\r\n\trenderer.autoClear = false;\r\n\trenderer.precision = \"highp\";\r\n\t\r\n\tvar container = document.getElementById(\"canvas_three\");\r\n\tcontainer.appendChild(renderer.domElement);\r\n\t\r\n\t// var viewer = new Potree.Viewer(document.getElementById(\"canvas_three\"));\r\n\t// viewer.setBackground(null);\r\n\t\r\n\t// window.three_viewer = viewer;\r\n\t// window.three_viewer.background = 'gradient';\r\n\t// viewer.setEDLEnabled(false);\r\n\t// viewer.setFOV(60);\r\n\t// viewer.setPointBudget(1 * 1000 * 1000);\r\n\t// viewer.loadSettingsFromURL();\r\n\t// viewer.setDescription(\"\");\r\n\t// viewer.loadGUI(() => {\r\n\t// \tviewer.setLanguage('en');\r\n\t// });\r\n};\r\n\r\n/**/\r\ndisease_player.addPotreePolygon = function(way){\r\n\tlet areaType = (disease_player.recog_result == '2') ? true : false,\r\n\t\ttextType = (disease_player.recog_result == '1') ? true : false;\r\n\t\r\n\tlet datas = way.datas,\r\n\t\tcn_type = datas.properties._cn_type,\r\n\t\tnodes = datas.ways._nodes;\r\n\t\r\n\tletmeasure=newPotree.Measure({\r\n\t\tcolor:'rgb(255, 0, 0)',\r\n//\t\t\tlineType:1,\r\n\t\tshowText: textType,\r\n\t\tlabelColor: {\r\n\t\t\tborderColor: { r: 0, g: 0, b: 0, a: 0 },\r\n\t\t\tbackgroundColor:{ r: 0, g: 0, b: 0, a: 0 },\r\n\t\t\ttextColor:{ r: 236, g: 58, b: 78, a: 1.0 }\r\n\t\t},\r\n\t\tpointColor:'rgb(255, 0, 0)'\r\n\t});\r\n\tmeasure._render=true;\r\n\tmeasure.closed=false;\r\n\tmeasure.showDistances=false;\r\n\tmeasure.showHeight=false;\r\n\tmeasure.showAngles=false;\r\n\tmeasure.name=way.id;\r\n\tmeasure.showArea=true;\r\n\tmeasure.show=areaType;\r\n\tmeasure.text = cn_type;\r\n\t\r\n//\t\tvar _height = way.datas.ways._nodes.nodes[0][2];\r\n\tletpos=null,\r\n\t\tnode=null,\r\n\t\tnode_id = null;\r\n\tfor(leti=0;i<nodes.length;i++){\r\n\t\tnode=nodes[i];\r\n\t\tnode_id = 'node_' + i;\r\n\t\tpos=lonlatToUTM(node[0], node[1]);\r\n\t\tmeasure.addMarker(newTHREE.Vector3(pos.x,pos.y,node[2]),{id:node_id,update:false});\r\n\t}\r\n\tmeasure._entityId = way.id;\r\n\t//scene.addMeasurement(measure);\r\n\t\r\n\treturnmeasure;\r\n};\r\n\r\n\r\n/* -- */\r\ndisease_player.disease_come_info = function(id){\r\n\tlet infos = disease_list.catchList || [],\r\n\t\tthis_info = infos.filter(function(data){\r\n\t\t   return (data.properties.ID == id)\r\n\t\t});\r\n\tif(!this_info.length){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\tlet _index = this_info[0].index;\r\n\tdisease_map.removePlayerPoint();\r\n\tdisease_info.come_to_info(_index, true, true);\r\n};\r\n\r\n/**/\r\ndisease_player.disease_region = function(){\r\n\tif(!window.scene){\r\n\t// if(!window.three_viewer || !window.three_viewer.scene){\r\n\t\treturn;\r\n\t}\r\n\tlet types = {\r\n\t\t'1': 'layer_label',\r\n\t\t'2': 'layer_way',\r\n\t\t'3': null\r\n\t}\r\n\tlet layer_id = types[disease_player.recog_result];\r\n\ttoggleLineLayer(layer_id);\r\n\tplayerRender();\r\n};\r\n\r\ndisease_player.setImageUrlPotree = function() {\r\n\t\r\n\tvar new_width =  $('#canvas_three').width();\r\n\tvar new_height =  $('#canvas_three').height();\r\n\twindow.renderer.setSize(new_width, new_height);\r\n\t\r\n\tlet _index = this.current_num - 1,\r\n\t\ttrackpoint = this.track_list[_index],\r\n\t\ttrack_point_id = trackpoint.trackPointId,\r\n\t\tpoint_url = config_url.krs + 'image/get?trackPointId=' + track_point_id + '&type=00&seq=005&imageType=jpg';\r\n\t\t// point_url = config_url.krs + 'image/get?token=' + window.token + '&trackPointId=' + track_point_id + '&type=00&seq=005&imageType=jpg';\r\n\t\r\n\tvar K = projection.cameraParams();\r\n\tiD.util.locationPotree(trackpoint, K);\r\n\t// window.three_viewer.image_url = point_url;\r\n//\t\twindow.three_viewer.setBGImageUrl(point_url);\r\n\t\r\n\t// let obj = window.three_viewer;\r\n\t\r\n\tconsole.log(trackpoint)\r\n\tconsole.log(this.entitys_utm)\r\n\t\r\n\t$.getImageToken(null, point_url, function(image){\r\n\t\tif ( disease_player.backgroundTexture && disease_player.backgroundTexture.image ) {\r\n\t\t// if (obj.scene.sceneBG != null && obj.scene.sceneBG.fg_material_1 != null) {\r\n\t\t\tvar _src = image;\r\n\t\t\tif(image.response){\r\n\t\t\t\t_src = URL.createObjectURL(image.response);\r\n\t\t\t}\r\n            // disease_player.backgroundTexture.image.crossOrigin = \"\";\r\n\t\t\t// disease_player.backgroundTexture.image.src = point_url;\r\n\t\t\tdisease_player.backgroundTexture.image.src = _src;\r\n\t\t\tplayerRender();\r\n\t\t\t// obj.scene.sceneBG.fg_texture_1.image.src = _src;\r\n\t\t\t// obj.scene.sceneBG.fg_texture_1.needsUpdate = true;\r\n\t\t\t\r\n\t\t}\r\n\t})\r\n};\r\n\r\nvar playerRenderTime = null;\r\nfunction playerRender(){\r\n\t\r\n\tplayerRenderTime && clearTimeout(playerRenderTime);\r\n\t\r\n\tplayerRenderTime = setTimeout(function(){\r\n\t\trenderer.clear();\r\n\t\trenderer.render(window.backgroundScene, window.backgroundCamera);\r\n\t\trenderer.render(window.scene, window.camera);\r\n\t}, 50)\r\n\t\r\n}\r\n\r\n/**/\r\ndisease_player.catchPotreeImage = function(alldata){\r\n\tvar _this = this,\r\n\t\ttotal_length = alldata.length - 1,\r\n\t\tloadedimages = 0,\r\n\t\tiserr = false,\r\n\t\tinit_index = _this.current_num - 1,\r\n\t\tstart_index = ((_this.current_num - _this.catch_count) > -1) ? (_this.current_num - _this.catch_count) : 0,\r\n\t\tend_index = ((_this.current_num + _this.catch_count) < total_length) ? (_this.current_num + _this.catch_count) : total_length,\r\n\t\tlength = end_index - start_index + 1;\r\n\t\r\n\tfor (var i = start_index; i <= end_index; i++) {\r\n\t\tvar img = new Image(),\r\n\t\t\t_data = alldata[i],\r\n\t\t\ttrack_point_id = _data.trackPointId,\r\n\t\t\t_src = config_url.krs + 'image/get?trackPointId=' + track_point_id + '&type=00&seq=005&imageType=jpg&token='+window.token;\r\n\t\t\r\n\t\timg.src = _src;\r\n\t\tif (img.complete) {  \t\t// \r\n\t\t\timageloadpost();\r\n\t\t\tcontinue; \t\t\t\t// onload\r\n\t\t}\r\n\t\timg.onload = function () {\r\n\t\t\timageloadpost();\r\n\t\t}\r\n\t\timg.onerror = function () {\r\n\t\t\tiserr = true;\r\n\t\t\timageloadpost();\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction imageloadpost() {\r\n\t\tloadedimages++;\r\n\t\tif (loadedimages == length) {\r\n\t\t\tif(iserr){\r\n\t\t\t\tconsole.warn('');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n};\r\n\r\nexport {\r\n    disease_player\r\n};\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_centre\r\n} from './disease_centre.js';\r\n\r\nvar disease_road_analyse = {};\r\n\r\ndisease_road_analyse.findDatas = function(){\r\n\tdisease_road_analyse.centre_list()\r\n}\r\n\r\ndisease_road_analyse.centre_list = function(page=false){\r\n\tlet road = $(\".select_road_analyse span.select_value\")[0].name;\r\n\tlet unit = $(\".select_statistical_unit span.select_value\")[0].name || '1';\r\n\tvar _table = `\r\n\t\t<table id=\"road_analyse_table\"></table>\r\n\t`;\r\n\t$('#data_center .road_analyse_body').html(_table);\r\n\tif(!disease_user.current_adcode){\r\n\t\treturn;\r\n\t}\r\n\tvar dataVersion = disease_user.current_adcode.dataVersion;\r\n\tvar _url = config_url.pdds + Disease.TYPE_LIST.URLS.ROAD,\r\n\t// var _url = config_url.pdds + 'data/road_maintenance/queryPage',\r\n\t\t_h = $('.road_analyse').height() - 192 - 56,\r\n\t\t_current = page || 1,\r\n\t\t_this = disease_centre;\r\n\tvar myTable = $('#road_analyse_table').bootstrapTable({\r\n\t\turl: _url,\r\n\t\tmethod: 'POST',\r\n//\t        height: _h,\r\n\t\tuniqueId: 'id',                        // ID\r\n\t\tstriped: false,                        //\r\n\t\tcache: false,                          //true*\r\n\t\tsidePagination: 'server',              //clientserver*\r\n\t\tajaxOptions: {\r\n\t\t\theaders: {\r\n\t\t\t\t'Authorization': token\r\n\t\t\t}\r\n\t\t},\r\n\t\tdataField: 'rows',\r\n\t\tundefinedText: \"-\",\r\n\t\tpagination: true,                      //\r\n\t\tpageNumber: _current,\r\n\t\tpageSize: 12,\r\n\t\tdata_local: \"zh-CN\",\r\n\t\tshowPaginationSwitch: false,\r\n\t\tpaginationLoop: false,\r\n\t\tqueryParams : function (params) {\r\n\t\t\tvar _page = (params.offset / params.limit) + 1;\r\n\t\t\tvar temp = {\r\n\t\t\t\t// \"sort\": [\r\n\t\t\t\t// \t{\r\n\t\t\t\t// \t  \"k\": \"properties.TASK_ID\",\r\n\t\t\t\t// \t  \"order\": \"desc\"\r\n\t\t\t\t// \t}\r\n\t\t\t\t// ],\r\n\t\t\t\t\"ops\": [],\r\n\t\t\t\t\"page\": {\r\n\t\t\t\t\t\"totalPages\": 0,\r\n\t\t\t\t\t\"count\": 10000000,\r\n\t\t\t\t\t\"pageNo\": _page,\r\n\t\t\t\t\t\"pageSize\": 12\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif(road){\r\n\t\t\t\ttemp.ops.push({\r\n\t\t\t\t\t\"k\": \"LINK_CODE\",\r\n\t\t\t\t\t\"type\": \"string\",\r\n\t\t\t\t\t\"v\": road,\r\n\t\t\t\t\t\"op\": \"eq\"\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tif(Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS'){\r\n\t\t\t\ttemp.ops.push({\r\n\t\t\t\t\t\"k\": \"RM_TYPE\",\r\n\t\t\t\t\t\"type\": \"string\",\r\n\t\t\t\t\t\"v\": unit,\r\n\t\t\t\t\t\"op\": \"eq\"\r\n\t\t\t\t})\r\n\t\t\t\ttemp.ops.push({\r\n\t\t\t\t\t\"k\": \"DATA_VERSION\",\r\n\t\t\t\t\t\"type\": \"string\",\r\n\t\t\t\t\t\"v\": dataVersion,\r\n\t\t\t\t\t\"op\": \"eq\"\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn JSON.stringify(temp);\r\n\t\t},\r\n\t\t\r\n\t\tcolumns: disease_centre.table_columns(\"road_analyse\"),\r\n\t\t/* columns: [\r\n\t\t\t{\r\n\t\t\t\tfield: 'properties.LINK_CODE',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.LINK_CODE || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.MAINTENANCE_COMPANY',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.MAINTENANCE_COMPANY || '-',\r\n\t\t\t\t\t\tnew_html = '<span title=\"' + new_value + '\">' + new_value + '</span>';\r\n\t\t\t\t\treturn new_html;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.ROAD_TYPE_NAME',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.ROAD_TYPE_NAME || '-',\r\n\t\t\t\t\t\tnew_html = '<span title=\"' + new_value + '\">' + new_value + '</span>';\r\n\t\t\t\t\treturn new_html;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.UP_DOWN',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tvar cn_name = _this.cn_data.UP_DOWM[value] || '-';\r\n\t\t\t\t\treturn cn_name;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.START_MP',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.START_MP || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.END_MP',\r\n\t\t\t\ttitle: '',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.END_MP || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.EVALUATE_LENG',\r\n\t\t\t\ttitle: 'm',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.EVALUATE_LENG || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.PQI',\r\n\t\t\t\ttitle: 'PQI',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.PQI || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.PCI',\r\n\t\t\t\ttitle: 'PCI',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.PCI || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.RQI',\r\n\t\t\t\ttitle: 'RQI',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.RQI || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.RDI',\r\n\t\t\t\ttitle: 'RDI',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.RDI || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t},{\r\n\t\t\t\tfield: 'properties.SRI',\r\n\t\t\t\ttitle: 'SRI',\r\n\t\t\t\talign: 'center',\r\n\t\t\t\tvalign: 'middle',\r\n\t\t\t\tformatter: function (value, row, index) {\r\n\t\t\t\t\tlet new_value = row.properties.SRI || '-';\r\n\t\t\t\t\treturn new_value;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t], */\r\n\t\tresponseHandler: function (data) {\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView('');\r\n\t\t\t\treturn \"\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar _data = data.result.data.features || data.result.data || [],\r\n\t\t\t\tres = {\r\n\t\t\t\t\trows: _data,\r\n\t\t\t\t\ttotal: data.result.page.count\r\n\t\t\t\t};\r\n\t\t\treturn res;\r\n\t\t},\r\n\t\tformatLoadingMessage: function(data){\r\n\t\t\treturn \"...\";\r\n\t\t},\r\n\t\tformatNoMatches: function(data){\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tonLoadError: function (data) {\r\n\t\t\treturn \"\";\r\n\t\t},\r\n\t\tonLoadSuccess: function (data) {\r\n\t\t\tif(data.total){\r\n\t\t\t\t_this.table_pagination_init({\r\n\t\t\t\t\t'data': data,\r\n\t\t\t\t\t'page': page,\r\n\t\t\t\t\t'id': 'road_analyse_table',\r\n\t\t\t\t\t'type': false,\r\n\t\t\t\t\t'class': 'road_analyse_body',\r\n\t\t\t\t\t'value': 2\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t}\r\n\t\t}\r\n\t})\r\n\tmyTable.bootstrapTable('hideLoading');\r\n\t/*$.postAjax({\r\n\t\turl: _url,\r\n\t\tdata: data,\r\n\t\tcallback: function(data){\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView(data.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tvar _data = data.result.data.features || [];\r\n\t\t\tconsole.log(_data);\r\n\t\t}\r\n\t})*/\r\n\t\r\n};\r\n\r\n\r\nexport {\r\n    disease_road_analyse\r\n\t\r\n\t\r\n\t\r\n};\r\n","\r\n\r\n/*----16*/\r\n\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\n\r\nvar disease_road_link = {\r\n\tline_group: [],\r\n\tpoint_group: []\r\n};\r\n\r\nvar _adcode = null;\r\nvar _datas = null;\r\n\r\n// data--   |||||    type--\r\nfunction addPrimitives(data){\r\n\t\r\n\tvar line_style = {\r\n\t\t'1': { 'line_color': '#FF4057' },\t\t\t\t\t\t\t//\r\n\t\t'3': { 'line_color': '#47F9FF', 'line_dash': true },\t\t//\r\n\t\t'4': { 'line_color': '#47F9FF', 'line_dash': true }\t\t\t//\r\n\t};\r\n\tvar features = data.features;\r\n\tvar _primitive = null;\r\n\t\r\n\tif(data.type == 'point'){\r\n\t\t_primitive = _viewer.scene.primitives.add(new Cesium.BillboardCollection());\r\n\t}else if(data.type == 'polyline'){\r\n\t\t_primitive = [];\r\n\t}\r\n\t\r\n\tfor(let i=0; i<features.length; i++){\r\n\t\tlet new_properties = features[i].new_properties || features[i].properties;\r\n\t\tlet positions = null;\r\n\t\t\r\n\t\tif(data.type == 'point'){\r\n\t\t\tpositions = Cesium.Cartesian3.fromDegrees( new_properties.center_xy[0], new_properties.center_xy[1], 0 );\r\n\t\t\tvar p = _primitive.add({\r\n\t\t\t\tdatas: new_properties,\r\n\t\t\t\tdefault_url: data.icon_url,\r\n\t\t\t\tactive_url: data.icon_active_url,\r\n\t\t\t\tcenter: new_properties.center_xy,\r\n\t\t\t\tshow: data.show_type,\r\n\t\t\t\tposition : positions,\r\n\t\t\t\t\r\n\t\t\t\timage : data.icon_url,\r\n\t\t\t\twidth: 18,\r\n\t\t\t\theight: 18,\r\n\t\t\t\tzIndex: 1000,\r\n\t\t\t\tverticalOrigin : Cesium.VerticalOrigin.CENTER,\r\n\t\t\t\tdisableDepthTestDistance: Number.POSITIVE_INFINITY,\t\t//0\r\n\t\t\t\tpixelOffset: Cesium.Cartesian2.ZERO,\r\n\t\t\t\tscaleByDistance : new Cesium.NearFarScalar(1.5e2, 1.0, 1.5e7, 0.5)\r\n\t\t\t});\r\n\t\t\tp['datas'] = new_properties;\r\n\t\t\tp['default_url'] = data.icon_url;\r\n\t\t\tp['active_url'] = data.icon_active_url;\r\n\t\t\tp['center'] = new_properties.center_xy;\r\n\t\t\t\r\n\t\t}else if(data.type == 'polyline'){\r\n\t\t\tvar rtype = new_properties.RTYPE;\r\n\t\t\tvar line_color = line_style[rtype].line_color;\r\n\t\t\tvar line_dash = line_style[rtype].line_dash;\r\n\t\t\tvar new_line = features[i].new_line;\r\n\t\t\tvar color = Cesium.Color.fromCssColorString(line_color);\r\n\t\t\t\r\n\t\t\tvar new_geometry = [];\r\n\t\t\tfor(var s=0; s<new_line.length; s++){\r\n\t\t\t\tvar _x = new_line[s][0] || 0,\r\n\t\t\t\t\t_y = new_line[s][1] || 0,\r\n\t\t\t\t\t_z = new_line[s][2] || 0;\r\n\t\t\t\tnew_geometry.push( _x, _y );\r\n\t\t\t}\r\n\t\t\tpositions = Cesium.Cartesian3.fromDegreesArray( new_geometry );\r\n\t\t\tvar primitive1 = null;\r\n\t\t\t\r\n\t\t\tif(line_dash){\r\n\t\t\t\tprimitive1 = new Cesium.Primitive({\r\n\t\t\t\t\tgeometryInstances: new Cesium.GeometryInstance({\r\n\t\t\t\t\t\tgeometry: new Cesium.PolylineGeometry({\r\n\t\t\t\t\t\t\tdatas: new_properties,\r\n\t\t\t\t\t\t\tpositions: positions,\r\n\t\t\t\t\t\t\twidth: 6,\r\n\t\t\t\t\t\t\tvertexFormat:Cesium.PolylineColorAppearance.VERTEX_FORMAT\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tappearance: new Cesium.PolylineMaterialAppearance({\r\n\t\t\t\t\t\tmaterial: Cesium.Material.fromType(Cesium.Material.PolylineDashType, {\r\n\t\t\t\t\t\t\tcolor: color,  \t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tgapColor: Cesium.Color.TRANSPARENT, \t\t//\r\n\t\t\t\t\t\t\tdashLength: 10 \t\t\t\t\t\t\t \t//\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t });\r\n\t\t\t}else{\r\n\t\t\t\tprimitive1 = new Cesium.Primitive({\r\n\t\t\t\t\tgeometryInstances: new Cesium.GeometryInstance({\r\n\t\t\t\t\t\tgeometry: new Cesium.PolylineGeometry({\r\n\t\t\t\t\t\t\tdatas: new_properties,\r\n\t\t\t\t\t\t\tpositions: positions,\r\n\t\t\t\t\t\t\twidth: 6,\r\n\t\t\t\t\t\t\tvertexFormat:Cesium.PolylineColorAppearance.VERTEX_FORMAT\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\t\tattributes: {\r\n\t\t\t\t\t\t\tcolor: Cesium.ColorGeometryInstanceAttribute.fromColor(color)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tappearance: new Cesium.PolylineColorAppearance({\r\n\t\t\t\t\t\ttranslucent: false,  //\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t_viewer.scene.primitives.add(primitive1);\r\n\t\t\t\r\n\t\t\t_primitive.push( primitive1 );\r\n\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t\r\n\treturn _primitive;\r\n\t\r\n}\r\n\r\n// -\r\nfunction findNodes(dataVersion) {\r\n\t// var url = config_url.pdds + 'data/road_link/query';\r\n\tvar url = config_url.pdds + 'data/adas_node/query';\r\n\tvar param = {\r\n\t\t'ops': [\r\n\t\t\t{\r\n\t\t\t\t'k': 'DATA_VERSION',\r\n\t\t\t\t'type': 'string',\r\n\t\t\t\t'v': dataVersion,\r\n\t\t\t\t'op': 'eq'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\t\r\n    return new Promise((resolve, reject) => {\r\n        $.postAjax({\r\n            'url': url,\r\n\t\t\t'data': param,\r\n            'token': true,\r\n            'callback': function (data) {\r\n\t\t\t\tvar datas = data.result.data || {};\r\n                resolve(datas);\r\n            }\r\n        })\r\n    })\r\n\r\n}\r\n\r\n// -\r\nfunction findLinks(dataVersion) {\r\n\tvar url = config_url.pdds + 'data/road_link/query';\r\n\t// var url = config_url.pdds + 'data/adas_node/query';\r\n\tvar param = {\r\n\t\t'ops': [\r\n\t\t\t{\r\n\t\t\t\t'k': 'DATA_VERSION',\r\n\t\t\t\t'type': 'string',\r\n\t\t\t\t'v': dataVersion,\r\n\t\t\t\t'op': 'eq'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n\t\r\n    return new Promise((resolve, reject) => {\r\n        $.postAjax({\r\n            'url': url,\r\n\t\t\t'data': param,\r\n            'token': true,\r\n            'callback': function (data) {\r\n\t\t\t\tvar datas = data.result.data || {};\r\n                resolve(datas);\r\n            }\r\n        })\r\n    })\r\n\r\n}\r\n\r\n// \r\ndisease_road_link.handle_road_data = async function(){\r\n\tif(!disease_user.current_adcode || !disease_user.current_adcode.dataVersion){\r\n\t\t$.errorView('');\r\n\t\treturn;\r\n\t}\r\n\t\r\n\tif(_adcode && _adcode == disease_user.current_adcode.dataVersion){\r\n\t\t// return;\r\n\t}\r\n\t\r\n\thandle_road_remove();\r\n\t\r\n\t_adcode = disease_user.current_adcode.dataVersion;\r\n\tdisease_road_link.handle_node_data(_adcode);\r\n\t\r\n    _datas = await findLinks(_adcode);\r\n\t\r\n\tdisease_road_link.line_group = null;\r\n\tvar features = _datas.features || [];\r\n\tfor(var i=0; i<features.length; i++){\r\n\t\tvar geom = features[i].properties.GEOM;\r\n\t\tvar line = $.cesium_range(geom);\r\n\t\tfeatures[i]['new_line'] = line;\r\n\t}\r\n\t\r\n\tdisease_road_link.line_group =  addPrimitives({\r\n\t\t'features': features,\r\n\t\t'type': 'polyline',\r\n\t\t'show_type': true\r\n\t})\r\n\t\r\n}\r\n// \r\ndisease_road_link.handle_node_data = async function(_adcode){\r\n    var nodes = await findNodes(_adcode);\r\n\tdisease_road_link.point_group = null;\r\n\tvar features = nodes.features || [];\r\n\t\r\n\tvar _cns = [\r\n\t\t{ 'id': 'WIDTH', 'name': '', 'unit': 'm' },\r\n\t\t{ 'id': 'CURVATURE', 'name': '', 'unit': 'm' },\r\n\t\t{ 'id': 'SLOPE', 'name': '', 'unit': '' }\r\n\t]\r\n\t\r\n\tfor(var i=0; i<features.length; i++){\r\n\t\tvar new_properties = {};\r\n\t\tvar properties = features[i].properties;\r\n\t\tvar UDATE = properties.UDATE;\r\n\t\tvar CREATE_TIME = properties._CREATE_TIME_ || '';\r\n\t\tvar update_time = properties.UDATE ?  $.timeConvert(properties.UDATE,0) : ' - ';\r\n\t\tvar create_time = CREATE_TIME || '';\r\n\t\tvar up_down = properties.UP_DOWN || '';\r\n\t\t\r\n\t\tvar link_name = properties.LINK_NAME || '';\r\n\t\tvar mp_code = properties.MP_CODE || '';\r\n\t\tvar mp_codes = mp_code.split('|');\r\n\t\tvar mp_codes_0 = mp_codes[0] || '';\r\n\t\tvar mp_codes_1 = mp_codes[1] ? ('K' + mp_codes[1]) : '';\r\n\t\tvar mp_codes_2 = mp_codes[2] ? ('+' + mp_codes[2] + '00') : '+000';\r\n\t\tvar cn_mark = mp_codes_0 +' ' + link_name + ' ' + mp_codes_1 + mp_codes_2;\r\n\t\tvar cn_up_down = Disease.TYPE_LIST.UP_DOWM[up_down] || '';\r\n\t\t\r\n\t\tvar width = Number( properties['WIDTH'] ) || 0;\r\n\t\tvar width_cn = _cns[0].name;\r\n\t\tvar width_unit = _cns[0].unit;\r\n\t\t\r\n\t\tvar radius = Number( properties['RADIUS'] ) || 0;\r\n\t\tvar radius_cn = _cns[1].name;\r\n\t\tvar radius_unit = _cns[1].unit;\r\n\t\t\r\n\t\tvar slope = Number( properties['SLOPE'] ) || 0;\r\n\t\tvar slope_cn = _cns[2].name;\r\n\t\tvar slope_unit = _cns[2].unit;\r\n\t\t\r\n\t\tif(radius > 0){\r\n\t\t\tradius_cn = ' ';\r\n\t\t\tradius = Math.abs(radius);\r\n\t\t\tnew_properties['RADIUS'] = Number( radius.toFixed(2) );\r\n\t\t}else if(radius < 0){\r\n\t\t\tradius_cn = ' ';\r\n\t\t\tradius = Math.abs(radius);\r\n\t\t\tnew_properties['RADIUS'] = Number( radius.toFixed(2) );\r\n\t\t}else{\r\n\t\t\tnew_properties['RADIUS'] = ' - ';\r\n\t\t}\r\n\t\t\r\n\t\tnew_properties['WIDTH'] = Number( width.toFixed(2) );\r\n\t\tnew_properties['SLOPE'] = Number( slope.toFixed(3) );\r\n\t\t\r\n\t\tnew_properties['WIDTH_CN'] = width_cn;\r\n\t\tnew_properties['RADIUS_CN'] = radius_cn;\r\n\t\tnew_properties['SLOPE_CN'] = slope_cn;\r\n\t\t\r\n\t\tvar locs = $.cesium_range(properties.GEOM);\r\n\t\tnew_properties['ID'] = 'line_point_' + i;\r\n\t\tnew_properties['cn_mark'] = cn_mark;\r\n\t\tnew_properties['update_time'] = update_time;\r\n\t\tnew_properties['create_time'] = create_time;\r\n\t\t\r\n\t\tnew_properties['mp_codes_0'] = mp_codes_0;\r\n\t\tnew_properties['mp_codes_1'] = mp_codes_1;\r\n\t\tnew_properties['mp_codes_2'] = mp_codes_2;\r\n\t\tnew_properties['cn_up_down'] = cn_up_down;\r\n\t\tnew_properties['center_xy'] = locs[0];\r\n\t\tnew_properties['_cn_type'] = '';\r\n\t\t\r\n\t\tfeatures[i]['new_properties'] = new_properties;\r\n\t\t\r\n\t\t// var point = $.add_billboard({\r\n\t\t// \t'show_type': true,\r\n\t\t// \t'icon_url': './Apps/Dist/Img/asset_icon/road.png',\r\n\t\t// \t'icon_active_url': './Apps/Dist/Img/asset_icon/road_active.png',\r\n\t\t// \t'properties': new_properties,\r\n\t\t// \t'geometry': locs\r\n\t\t// })\r\n\t\t// disease_road_link.point_group.push(\r\n\t\t// \tpoint\r\n\t\t// )\r\n\t\t\r\n\t}\r\n\t\r\n\tdisease_road_link.point_group =  addPrimitives({\r\n\t\t'features': features,\r\n\t\t'type': 'point',\r\n\t\t'icon_url': './Apps/Dist/Img/asset_icon/road.png',\r\n\t\t'icon_active_url': './Apps/Dist/Img/asset_icon/road_active.png',\r\n\t\t'show_type': false\r\n\t})\r\n}\r\n\r\n// \r\ndisease_road_link.handle_road_toggle = function(zoom){\r\n\tvar _type = false,\r\n\t\tpoint_type = false;\r\n\tif( zoom < 16 ){\r\n\t\t_type = true;\r\n\t}\r\n\tif(zoom > 19){\r\n\t\tpoint_type = true;\r\n\t}\r\n\t\r\n\tfor(var i=0; i<disease_road_link.line_group.length; i++){\r\n\t\tvar line = disease_road_link.line_group[i];\r\n\t\tline.show = _type;\r\n\t}\r\n\t\r\n\tvar bills = disease_road_link.point_group._billboards || [];\r\n\tfor(var i=0; i<bills.length; i++){\r\n\t\tvar line = bills[i];\r\n\t\tline.show = point_type;\r\n\t}\r\n\t\r\n}\r\n\r\n// \r\nfunction handle_road_remove(){\r\n\t\r\n\t// _viewer.scene.primitives.remove( disease_road_link.point_group );\r\n\t// for(var i=0; i<disease_road_link.line_group.length; i++){\r\n\t// \tvar line = disease_road_link.line_group[i];\r\n\t// \t_viewer.scene.primitives.remove( line );\r\n\t// }\r\n\t\r\n\t// $.cesium_refresh();\r\n\t\r\n}\r\n\r\n\r\nexport {\r\n    disease_road_link\r\n};\r\n\r\n\r\n\r\n\r\n\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_user\r\n} from './disease_user.js';\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\nimport {\r\n    disease_centre\r\n} from './disease_centre.js';\r\n\r\nvar disease_screen = {};\r\n\r\ndisease_screen.catchParam = null;\r\ndisease_screen.screen_search_param = {};\r\ndisease_screen.screen_list = [];\r\n\r\ndisease_screen.link_code_query = function(){\r\n\tlet dataVersion = disease_user.current_adcode.dataVersion,\r\n\t\t_url = config_url.pdds + 'data/road/query',\r\n\t\tmap_code_param = { 'ops': [{'k': 'DATA_VERSION','v': dataVersion,'op': 'eq','type': 'string'}] };\r\n\t\r\n\tdisease_centre.link_list = [];\r\n\treturn new Promise((resolve, reject) => {\r\n\t\t$.postAjax({\r\n\t\t\t'url': _url,\r\n\t\t\t'data': map_code_param,\r\n\t\t\t'callback': function(data){\r\n\t\t\t\tlet type_arr = (data.result && data.result.data) ? data.result.data.features : [];\r\n\t\t\t\tfor(let i=0; i<type_arr.length; i++){\r\n\t\t\t\t\tdisease_centre.link_list.push({\r\n\t\t\t\t\t\t// 'name': type_arr[i].properties.NAME || type_arr[i].properties.LINK_NAME,\r\n\t\t\t\t\t\t'name': type_arr[i].properties.LINK_CODE,\r\n\t\t\t\t\t\t'id': type_arr[i].properties.LINK_CODE\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tresolve(type_arr);\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n}\r\n\r\n/**/\r\ndisease_screen.screen_init = function() {\r\n\t\r\n\tvar _this = this,\r\n\t\tnew_link_list = disease_centre.link_list || [],\r\n\t\tlink_list = [],\r\n\t\ttype_list = Disease.TYPE_LIST.TYPES,\r\n\t\tnew_list = [];\r\n\t\r\n\tnew_link_list.forEach( d=>{\r\n\t\tlink_list.push({\r\n\t\t\t'name': d.id,\r\n\t\t\t'id': d.id\r\n\t\t})\r\n\t} )\r\n\t\r\n\t_this.screen_list = [];\r\n\t\r\n\tvar _html = '';\r\n\t\r\n\t// \r\n\tif(Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS'){\r\n\t\t\r\n\t\tnew_list = [\r\n\t\t\t{\r\n\t\t\t\t'name': '',\r\n\t\t\t\t'id': 'TYPE',\r\n\t\t\t\t'type': '1',\r\n\t\t\t\t'value': []\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'name': '',\r\n\t\t\t\t'id': 'TYPE',\r\n\t\t\t\t'type': '2',\r\n\t\t\t\t'value': []\r\n\t\t\t}\r\n\t\t]\r\n\t\t\r\n\t\tfor(let item in type_list.VALUES){\r\n\t\t\tlet materialIndex = (type_list.VALUES[item].MATERIAL == '1') ? 0 : 1;\r\n\t\t\tnew_list[materialIndex].value.push({\r\n\t\t\t\t'name': type_list.VALUES[item].NAME,\r\n\t\t\t\t'id': item\r\n\t\t\t})\r\n\t\t}\r\n\t\t\r\n\t\t_this.screen_list = [\r\n\t\t\t{\r\n\t\t\t\t'label': '',\r\n\t\t\t\t'id': 'LINK_CODE',\r\n\t\t\t\t'list': link_list\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'label': type_list.NAME,\r\n\t\t\t\t'id': type_list.KEY,\r\n\t\t\t\t'list': []\r\n\t\t\t}\r\n\t\t];\r\n\t\t\r\n\t\tvar _html = `\r\n\t\t\t<div class=\"screen_model_param\">\r\n\t\t\t\t${disease_screen.screen_list.map(f => `\r\n\t\t\t\t\t<div class=\"${f.id}\">\r\n\t\t\t\t\t\t<label>${f.label}</label>\r\n\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t${f.list.map(g => `\r\n\t\t\t\t\t\t\t\t<li class=\"${f.id}_${g.id}\">\r\n\t\t\t\t\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"${f.id}\" value=\"${g.id}\">\r\n\t\t\t\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t\t\t\t<span title=\"${g.name}\">${g.name}</span>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`).join('')}\r\n\t\t\t\t${new_list.map(f => `\r\n\t\t\t\t\t<div class=\"${f.id}\" name=\"${f.type}\" style=\"display:block;\">\r\n\t\t\t\t\t\t<label>${f.name}</label>\r\n\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t${f.value.map(g => `\r\n\t\t\t\t\t\t\t\t<li class=\"${f.id}_${g.id}\">\r\n\t\t\t\t\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"${f.id}\" value=\"${g.id}\">\r\n\t\t\t\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t\t\t\t<span title=\"${g.name}\">${g.name}</span>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t\t\t<li class=\"allCheck\">\r\n\t\t\t\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"all\" data-name=\"${f.type}\" value=\"\">\r\n\t\t\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`).join('')}\r\n\t\t\t\t<div class=\"SUBTYPE\" style=\"display:block;\">\r\n\t\t\t\t\t<label style=\"float: left;width: 50%;\"></label>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t<li style=\"width: 100%;\">\r\n\t\t\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"\" value=\"\">\r\n\t\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</li>\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"screen_submit\">\r\n\t\t\t\t<label><a href=\"#\" title=\"\"></a></label>\r\n\t\t\t\t<button class=\"btn btn-primary btn_screen_submit\" title=\"\"></button>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t\t\r\n\t}else{\r\n\t\tfor(let item in type_list.VALUES){\r\n\t\t\tnew_list.push({\r\n\t\t\t\t'name': type_list.VALUES[item].NAME,\r\n\t\t\t\t'id': item\r\n\t\t\t})\r\n\t\t}\r\n\t\t_this.screen_list = [\r\n\t\t\t{\r\n\t\t\t\t'label': '',\r\n\t\t\t\t'id': 'LINK_CODE',\r\n\t\t\t\t'list': link_list\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'label': type_list.NAME,\r\n\t\t\t\t'id': type_list.KEY,\r\n\t\t\t\t'list': new_list\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t'label': '',\r\n\t\t\t\t'id': 'SUBTYPE',\r\n\t\t\t\t'list': [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '',\r\n\t\t\t\t\t\t'id': '9'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '',\r\n\t\t\t\t\t\t'id': '3'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': ' ()',\r\n\t\t\t\t\t\t'id': '2'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'name': '',\r\n\t\t\t\t\t\t'id': '1'\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t];\r\n\t\tvar _html = `\r\n\t\t\t<div class=\"screen_model_param\">\r\n\t\t\t\t${disease_screen.screen_list.map(f => `\r\n\t\t\t\t\t<div class=\"${f.id}\">\r\n\t\t\t\t\t\t<label>${f.label}</label>\r\n\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t${f.list.map(g => `\r\n\t\t\t\t\t\t\t\t<li class=\"${f.id}_${g.id}\">\r\n\t\t\t\t\t\t\t\t\t<label class=\"checkbox_label\">\r\n\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" name=\"${f.id}\" value=\"${g.id}\">\r\n\t\t\t\t\t\t\t\t\t\t<b class=\"checkbox_b\"></b>\r\n\t\t\t\t\t\t\t\t\t\t<span title=\"${g.name}\">${g.name}</span>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<!--<span class=\"regional_label_num\">356</span>-->\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t`).join('')}\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t`).join('')}\r\n\t\t\t</div>\r\n\t\t\t<div class=\"screen_submit\">\r\n\t\t\t\t<label><a href=\"#\" title=\"\"></a></label>\r\n\t\t\t\t<button class=\"btn btn-primary btn_screen_submit\" title=\"\"></button>\r\n\t\t\t</div>\r\n\t\t`;\r\n\t}\r\n\t\r\n\t\r\n\t$('.screen_model').html(_html);\r\n\tvar _top = $('.screen_model_param').height() + 58;\r\n//\t\t$('.screen_submit').css('top', _top)\r\n};\r\n\r\n/**/\r\ndisease_screen.subtype_change = function(){\r\n\treturn;\r\n\tvar key = Disease.TYPE_LIST.TYPES.KEY,\r\n\t\tinput_check = $('.screen_model_param .' + key +  ' input'),\r\n\t\tsubtype_2 = 'none',\r\n\t\tsubtype = 'none';\r\n\tfor(var i=0; i<input_check.length; i++){\r\n\t\tvar type = input_check[i].name,\r\n\t\t\tvalue = input_check[i].value,\r\n\t\t\tsubtype_none = Disease.TYPE_LIST.TYPES.VALUES[value].SUBTYPE_NONE,\r\n\t\t\tchecked = input_check[i].checked;\r\n\t\tif(checked && subtype_none){\r\n\t\t\tsubtype_2 = 'block';\r\n\t\t\tsubtype = 'block';\r\n\t\t}else if(checked){\r\n\t\t\tsubtype = 'block';\r\n\t\t}\r\n\t}\r\n\t\r\n\t$('.screen_model_param .SUBTYPE').css('display', subtype);\r\n\t$('.screen_model_param .SUBTYPE li.SUBTYPE_2').css('display', subtype_2);\r\n\t$('.screen_model_param .SUBTYPE li.SUBTYPE_2 input')[0].checked = false;\r\n};\r\n\r\n/*icon--*/\r\ndisease_screen.screen_icon = function(type){\r\n\t$('.screen_model_param input[type=\"checkbox\"]').prop('checked', false);\r\n\tfor(var name in this.screen_search_param){\r\n\t\tif(name == 'SUBTYPE'){\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tfor(var i=0; i<this.screen_search_param[name].length; i++){\r\n\t\t\tvar values = this.screen_search_param[name][i];\r\n\t\t\t$('.screen_model_param .'+name+' input[value=\"'+values+'\"]').prop('checked', true);\r\n\t\t}\r\n\t}\r\n\t\r\n\tif(Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS'){\r\n\t\tvar subTypeCheck = (this.screen_search_param && this.screen_search_param.SUBTYPE == '2,3,9') ? true : false;\r\n\t\t$('.screen_model_param .SUBTYPE input')[0].checked = subTypeCheck;\r\n\t\t\r\n\t\tvar length_1 = $('.screen_model_param .TYPE[name=\"1\"] input').length - 1,\r\n\t\t\tlength_2 = $('.screen_model_param .TYPE[name=\"2\"] input').length - 1;\r\n\t\tif( $('.screen_model_param .TYPE[name=\"1\"] input:checked').length == length_1 ){\r\n\t\t\t$('.screen_model_param .TYPE[name=\"1\"] li.allCheck input')[0].checked = true;\r\n\t\t}\r\n\t\tif( $('.screen_model_param .TYPE[name=\"2\"] input:checked').length == length_2 ){\r\n\t\t\t$('.screen_model_param .TYPE[name=\"2\"] li.allCheck input')[0].checked = true;\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar checkboxs = $('.screen_model_param input[type=\"checkbox\"]'),\r\n\t\tcheck_num = 0,\r\n\t\tclass_name = '';\r\n\tfor(var i=0; i<checkboxs.length; i++){\r\n\t\tif(checkboxs[i].checked){\r\n\t\t\tclass_name = 'active';\r\n\t\t\tcheck_num ++;\r\n\t\t}\r\n\t}\r\n\tif(checkboxs.length == check_num){\r\n\t\tclass_name = '';\r\n\t\tfor(var i=0; i<checkboxs.length; i++){\r\n\t\t\tcheckboxs[i].checked = false;\r\n\t\t}\r\n\t}\r\n\tif(type == 'none'){\r\n\t\tclass_name = 'active';\r\n\t}\r\n\t$('.disease_list_screen a.screen_link').removeClass('active');\r\n\t$('.disease_list_screen a.screen_link').addClass(class_name);\r\n\t\r\n\t\r\n\t\r\n};\r\n\r\n/**/\r\ndisease_screen.screen_search = function(type=false){\r\n\tvar newParam = [],\r\n\t\tsubtype = $('.screen_model_param .SUBTYPE').css('display');\r\n\tthis.screen_search_param = {};\r\n\tfor(var i=0; i<this.screen_list.length; i++){\r\n\t\tvar className = this.screen_list[i].id,\r\n\t\t\tcheckBox = '.' + className + ' input[type=checkbox]',\r\n\t\t\tdoms = $(checkBox);\r\n\t\tif(subtype == 'none' && className == 'SUBTYPE'){\r\n\t\t\tcontinue;\r\n\t\t}\r\n//\t\t\tif( className != 'LINK_NAME' ){\r\n\t\t\tfor(var s=0; s<doms.length; s++){\r\n\t\t\t\tvar checked = doms[s].checked,\r\n\t\t\t\t\tvalue = doms[s].value,\r\n\t\t\t\t\tid = doms[s].name;\r\n\t\t\t\tif(checked && id != 'all'){\r\n\t\t\t\t\tif(!this.screen_search_param[id]){\r\n\t\t\t\t\t\tthis.screen_search_param[id] = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.screen_search_param[id].push(value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n//\t\t\t}\r\n\t}\r\n\tfor(var id in this.screen_search_param){\r\n\t\tvar _v = this.screen_search_param[id].join(',');\r\n\t\tnewParam.push({\r\n\t\t\t'k': id,\r\n\t\t\t'v': _v,\r\n\t\t\t'op': 'in'\r\n\t\t})\r\n\t}\r\n\t\t\r\n\tvar subTypes = {k: \"SUBTYPE\", v: \"1,2,3,9\", op: \"in\"};\r\n\t// \r\n\tif(Disease.TYPE_LIST.ID == 'PAVEMENT_DISTRESS'){\r\n\t\tlet subType = $('.SUBTYPE input[type=\"checkbox\"]').prop('checked');\r\n\t\tsubTypes.v = subType ? '2,3,9' : '1,2,3,9';\r\n\t\tnewParam.push(subTypes);\r\n\t}\r\n\tthis.screen_search_param['SUBTYPE'] = subTypes.v;\r\n\t\r\n\tdisease_list.list_init(newParam, type);\r\n};\r\n\r\nexport {\r\n    disease_screen\r\n};\r\n\r\n// module.exports = disease_screen;\r\n","/**\r\n * \r\n */\r\n\r\nimport {\r\n    disease_map\r\n} from './disease_main_map.js';\r\nimport {\r\n    disease_list\r\n} from './disease_list.js';\r\nimport {\r\n    disease_info\r\n} from './disease_info.js';\r\n\r\nvar SlideList = {};\r\n\r\nSlideList.Slideicon = function(element,options) {\r\n\tthis.element = element;\r\n\tthis.options = {\r\n\t\tcover:options.cover,\r\n\t\tindex:options.index,\r\n\t\tcallback:options.callback\r\n\t};\r\n\tthis.SlideiconInit();\r\n};\r\n\r\nSlideList.SlideiconInit = function() {\r\n\tvar _this = this;\r\n\tthis.element.on('click','li',function(){\r\n\t\t$(this).nextAll().removeClass('active');\r\n\t\t$(this).prevAll().removeClass('active');\r\n\t\tvar width = $(this).width();\r\n\t\tvar left = ($(this).index())*width;\r\n\t\t_this.options.cover.attr(\"style\",\"left:\"+left+\"px\");\r\n\t\t$(this).addClass(\"active\");\r\n\t\tparams = $(this).attr('type');\r\n\t\t_this.options.callback(params);\r\n\t});\r\n};\r\n\r\n/**/\r\nSlideList.menu_feedbacks = function(type = false){\r\n\tif(type){\r\n\t\t$('#mask_model').fadeIn(100);\r\n\t\t$('.feedback_model').fadeIn(101);\r\n\t}else{\r\n\t\t$('#mask_model').fadeOut(101);\r\n\t\t$('.feedback_model').fadeOut(100);\r\n\t}\r\n};\r\n\r\n/*-*/\r\nSlideList.menu_collects = function(type){\r\n\tlet _url = config_url.pdds + 'data/pd_label/create',\r\n\t\tpd_id = disease_info.current_info.properties.ID,\r\n\t\tuserinfo = $.getLocalStorage('userInfo') || '{}',\r\n\t\tjson_userinfo = JSON.parse(userinfo),\r\n\t\tusername = json_userinfo.userName,\r\n\t\t_json = {\r\n\t\t\t\"type\":\"FeatureCollection\",\r\n\t\t\t\"features\":[\r\n\t\t\t\t{\r\n\t\t\t\t\t\"type\":\"Feature\",\r\n\t\t\t\t\t\"properties\":{\r\n\t\t\t\t\t\t\"PD_ID\": pd_id,\r\n\t\t\t\t\t\t\"USER\": username\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t},\r\n\t\t_body = {\r\n\t\t\t\"ops\": [\r\n\t\t\t\t{\r\n\t\t\t\t\t\"k\": \"PD_ID\",\r\n\t\t\t\t\t\"type\": \"string\",\r\n\t\t\t\t\t\"v\": pd_id,\r\n\t\t\t\t\t\"op\": \"eq\"\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\t\"k\": \"USER\",\r\n\t\t\t\t\t\"type\": \"string\",\r\n\t\t\t\t\t\"v\": username,\r\n\t\t\t\t\t\"op\": \"eq\"\r\n\t\t\t\t}\r\n\t\t\t]\r\n\t\t};\r\n\tif(type){\r\n\t\t_url = config_url.pdds + 'data/pd_label/delete';\r\n\t\t$.postAjax({\r\n\t\t\turl: _url,\r\n\t\t\tdata: _body,\r\n\t\t\tcallback: function(data){\r\n\t\t\t\tlet _type = true;\r\n\t\t\t\tlet has_class = $('.menu_manage .menu_mark').hasClass('active');\r\n\t\t\t\tif(data.code != '0'){\r\n\t\t\t\t\t_type = false;\r\n\t\t\t\t}\r\n\t\t\t\t$.errorView(data.message, _type);\r\n\t\t\t\t$('.menu_list .menu_list_child .menu_collect').removeClass('active');\r\n\t\t\t\t\r\n\t\t\t\tif(!has_class){\r\n\t\t\t\t\t$('.menu_manage a.iconshenglvehao').removeClass('active');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t}else{\r\n\t\t$.postAjax({\r\n\t\t\turl: _url,\r\n\t\t\tdata: _json,\r\n\t\t\tcallback: function(data){\r\n\t\t\t\tlet _type = true;\r\n\t\t\t\tif(data.code != '0'){\r\n\t\t\t\t\t_type = false;\r\n\t\t\t\t}\r\n\t\t\t\t$.errorView(data.message, _type);\r\n\t\t\t\t$('.menu_list .menu_list_child .menu_collect').addClass('active');\r\n\t\t\t\t$('.menu_manage a.iconshenglvehao').addClass('active');\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n};\r\n\r\n\r\n/*-*/\r\nSlideList.full_screen = function(type = false){\r\n\t/*if(type){\r\n\t\t$('.info_image').toggleClass('full_screen');\r\n\t}else{\r\n\t\t$('.info_image').removeClass('full_screen');\r\n\t}*/\r\n\t\r\n\t$('.info_image').toggleClass('full_screen');\r\n\tlet has_class = $('.info_image').hasClass('full_screen'),\r\n\t\tratio_width = '100%';\r\n\tif(has_class){\r\n\t\tlet info_height = window.innerHeight - 34,\r\n\t\t\tratio_height = info_height / 2048;\r\n\t\tratio_width = ratio_height * 2448;\r\n\t}\r\n\t$('.player_video').css('width', ratio_width);\r\n\tleafletMap.invalidateSize(true);\r\n\t\r\n\t/*var ratio_width = 608 / 2448,\r\n\t\tratio_height = ratio_width * 2048,\r\n\t\t_height = Number(ratio_height);\r\n\r\n\t$('.disease_player_body .player_image').css('height', _height);\r\n\t$('.disease_player_body .player_image #canvas_three').css('height', _height);*/\r\n};\r\n\r\nexport {\r\n    SlideList\r\n};\r\n// module.exports = SlideList;\r\n\r\n","\r\n/**\r\n * \r\n */\r\n\r\nvar disease_swiper = {};\r\n\r\n\t\r\ndisease_swiper.swiper_init = function() {\r\n\t/*var _html = `\r\n\t\t<div class=\"slide_item_box\">\r\n\t\t\t<div class=\"hd\">\r\n\t\t\t\t<a href=\"javascript:;\" class=\"prev_img iconfont iconup\"></a>\r\n\t\t\t\t<a href=\"javascript:;\" class=\"next_img iconfont iconleftbutton\"></a>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"bd slide_item_body\">\r\n\t\t\t\t<ul class=\"clearfix\">\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<img src=\"./Apps/Dist/swiper/t1.png\" alt=\"\" width=\"402\" height=\"402\">\r\n\t\t\t\t\t\t<p class=\"new_body_title\">2018.04.12</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<img src=\"./Apps/Dist/swiper/t2.png\" alt=\"\" width=\"402\" height=\"402\">\r\n\t\t\t\t\t\t<p class=\"new_body_title\">2018.05.12</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<img src=\"./Apps/Dist/swiper/t3.png\" alt=\"\" width=\"402\" height=\"402\">\r\n\t\t\t\t\t\t<p class=\"new_body_title\">2018.06.12</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<img src=\"./Apps/Dist/swiper/t4.png\" alt=\"\" width=\"402\" height=\"402\">\r\n\t\t\t\t\t\t<p class=\"new_body_title\">2018.07.12</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<img src=\"./Apps/Dist/swiper/t5.png\" alt=\"\" width=\"402\" height=\"402\">\r\n\t\t\t\t\t\t<p class=\"new_body_title\">2018.08.12</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t\t<li>\r\n\t\t\t\t\t\t<img src=\"./Apps/Dist/swiper/t6.png\" alt=\"\" width=\"402\" height=\"402\">\r\n\t\t\t\t\t\t<p class=\"new_body_title\">2018.09.12</p>\r\n\t\t\t\t\t</li>\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t`;\r\n\t$(\".disease_swiper .slide_item\").html(_html);\r\n\t$(\".slide_item_box\").slide({\r\n\t\ttitCell: \".hd ul\",\r\n\t\tmainCell: \".bd ul\",\r\n\t\tprevCell: '.next_img',\r\n\t\tnextCell: '.prev_img',\r\n\t\tautoPage: true,\r\n\t\teffect: \"leftLoop\",\r\n\t\tautoPlay: false,\r\n\t\tscroll: 2,\r\n\t\tvis: 3,\r\n\t\tdelayTime: 1000,\r\n\t\ttrigger: \"click\"\r\n\t})*/\r\n};\r\n\r\nexport {\r\n    disease_swiper\r\n};\r\n// module.exports = disease_swiper;\r\n\r\n\r\n\r\n\r\n\r\n","/**\r\n * \r\n */\r\n\r\n\r\nimport {\r\n    disease_screen\r\n} from './disease_screen.js';\r\nimport {\r\n    disease_centre\r\n} from './disease_centre.js';\r\nimport {\r\n    disease_road_link\r\n} from './disease_road_link.js';\r\nimport { disease_map } from './disease_main_map.js';\r\n\r\nvar disease_user = {};\r\n\r\ndisease_user.current_adcode = null;\r\n\r\ndisease_user.adcode_param = {};\r\n\r\ndisease_user.urlCenter = '';\r\n\r\n/**/\r\ndisease_user.userSignOut = function(){\r\n\t$.removeCookie('token');\r\n\t$.errorView('');\r\n\tsetTimeout(function(){\r\n\t\tlet _url = './login.html';\r\n\t\twindow.open(_url, '_self');\r\n\t}, 500)\r\n};\r\n\r\n/**/\r\ndisease_user.userRoleInit = function(adcodes){\r\n\tlet cityname = disease_user.current_adcode.name,\r\n\t\tthis_center = disease_user.current_adcode.center.split(','),\r\n\t\tnewname = cityname.replace(/||||/ig, '');\r\n\t\r\n\tlet list = `\r\n\t\t${adcodes.map(a => `\r\n\t\t\t<li data-adcode=\"${a.adcode}\" class=\"${a.className || ''}\">${a.name}</li>\r\n\t\t`).join('')}\r\n\t`;\r\n\t$('.user_citys .citys_list').html(list);\r\n\t$('.user_citys .citys_name').html(newname);\r\n\r\n\tfunButtonActive();\r\n\tbusinessListActive();\r\n\t\r\n\t// if(window._viewer){\r\n\t// \tlet _center = this_center ? this_center.split(',') : config_url.nantong.center,\r\n\t// \t\t_zoom = config_url.nantong.zoom,\r\n\t// \t\t_height = disease_user.zoomToAltitude(_zoom);\r\n\t\t\r\n\t// \t_center = urlCenter ? urlCenter : _center;\r\n\t// \t_height = urlCenter ? 750 : _height;\r\n\t// \tlet center =  Cesium.Cartesian3.fromDegrees(_center[0], _center[1], _height);\r\n\t\t\r\n\t// \t_viewer.camera.setView({  \r\n\t// \t\tdestination: center\r\n\t// \t})\r\n\t// }\r\n};\r\n\r\ndisease_user.userRoleChange = function(){\r\n\tlet userinfo = $.getLocalStorage('userInfo') || '{}',\r\n\t\tjson_userinfo = JSON.parse(userinfo),\r\n\t\tusername = json_userinfo.cnName || '',\r\n\t\tuserimage = json_userinfo.role || 'beijing',\r\n\t\timageurl = './Apps/Dist/Img/chengshi@2x/' + userimage + '.png';\r\n\t\r\n\t$('.user_name').html(username);\r\n\t$('.button_list img.user_logo').attr('src', imageurl);\r\n};\r\n\r\n/**/\r\ndisease_user.userfindRole = function(){\r\n\t\t\r\n\tlet userinfo = $.getLocalStorage('userInfo') || '{}',\r\n\t\tjson_userinfo = JSON.parse(userinfo),\r\n\t\tusername = json_userinfo.userName,\r\n\t\t_url = config_url.pdds + 'user/district/permission/findCitiesByUsername?username=' + username;\r\n\t\r\n\tlet urlAdcode = $.getUrlParam('adcode') || $.getUrlParam('city'),\r\n\t\tcenterX = $.getUrlParam('x'),\r\n\t\tcenterY = $.getUrlParam('y');\r\n\t\tdisease_user.urlCenter =  (centerX && centerY) ? [centerX, centerY] : null;\r\n\t\r\n\treturn new Promise((resolve,reject) => {\r\n\t\t$.getAjax({\r\n\t\t'url': _url,\r\n\t\t'token': true,\r\n\t\t'callback': function(data){\r\n\t\t\tlet adcodes = data.result || [];\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView('');\r\n\t\t\t}else if(!adcodes.length){\r\n\t\t\t\t$.errorView('');\r\n\t\t\t}else{\r\n\t\t\t\t\r\n\t\t\t\tlet isDefault = '';\r\n\t\t\t\tfor(let s=0; s<adcodes.length; s++){\r\n\t\t\t\t\tlet adcode = adcodes[s].adcode;\r\n\t\t\t\t\tif( !urlAdcode && adcodes[s].isDefault ){\r\n\t\t\t\t\t\tisDefault = '';\r\n\t\t\t\t\t\tadcodes[s].className = 'active';\r\n\t\t\t\t\t\tdisease_user.current_adcode = adcodes[s];\r\n\t\t\t\t\t}else if(urlAdcode && urlAdcode == adcode){\r\n\t\t\t\t\t\tisDefault = false;\r\n\t\t\t\t\t\tadcodes[s].className = 'active';\r\n\t\t\t\t\t\tdisease_user.current_adcode = adcodes[s];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdisease_user.adcode_param[adcode] = adcodes[s];\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(!disease_user.current_adcode){\r\n\t\t\t\t\tadcodes[0].className = 'active';\r\n\t\t\t\t\tdisease_user.current_adcode = adcodes[0];\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif(isDefault){\r\n\t\t\t\t\t$.errorView(isDefault);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tdisease_user.userRoleInit(adcodes);\r\n\t\t\t\t// disease_road_link.handle_road_data();\r\n\t\t\t}\r\n\t\t\tresolve();\r\n\t\t}\r\n\t})\r\n\t})\r\n\r\n};\r\n\r\n/*  */\r\nfunction funButtonActive(type){\r\n\t\r\n\tlet rearView = disease_user.current_adcode.pdRearImageFlag,\r\n\t\trearViewClass = rearView ? '' : 'rearViewNot';\r\n\t$('body').attr('class', rearViewClass);\r\n\tif(type){\r\n\t\treturn;\r\n\t}\r\n\tfor(let i=0; i<Disease.TYPE_LIST.FUNBUTTON.length; i++){\r\n\t\tDisease.TYPE_LIST.FUNBUTTON[i].ACTIVE = '';\r\n\t\tif(Disease.TYPE_LIST.FUNBUTTON[i].ID != 'collect_map'){\r\n\t\t\tDisease.TYPE_LIST.FUNBUTTON[i].ACTIVE = 'active';\r\n\t\t}\r\n\t}\r\n\t\r\n}\r\n\r\n/*  */\r\nfunction businessListActive(type){\r\n\t\r\n\tlet pdFlag = disease_user.current_adcode.pdFlag || true,\r\n\t\troadAssetFlag = disease_user.current_adcode.roadAssetFlag || true,\r\n\t\tflag = 'ASSET_INSPECTION',\r\n\t\tflagName = '';\r\n\t\r\n\t$('.button_list ul.business_list li').removeClass('active');\r\n\tif(!pdFlag || !roadAssetFlag){\r\n\t\t$('.button_list ul.business_list li').css('display', 'none');\r\n\t\t$('.button_list ul.business_list li[data-name=\"\"]').css('display', 'block');\r\n\t}\r\n\t\r\n\tif(pdFlag && !roadAssetFlag){\r\n\t\tflag = 'PAVEMENT_DISTRESS';\r\n\t\tflagName = '';\r\n\t}else if(!pdFlag && roadAssetFlag){\r\n\t\tflag = 'ASSET_INSPECTION';\r\n\t\tflagName = '';\r\n\t}else if(!pdFlag && !roadAssetFlag){\r\n\t\tflag = '';\r\n\t\tflagName = '';\r\n\t}\r\n\t\r\n\tDisease.TYPE_LIST = Disease.business_list[flag] || null;\r\n\t\r\n\t$('.button_list ul.business_list li[data-name=\"' + flag + '\"]').css('display', 'block');\r\n\t$('.button_list ul.business_list li[data-name=\"' + flag + '\"]').addClass('active');\r\n\t$('.button_list a.business_open')[0].firstChild.data = flagName;\r\n\t\r\n}\r\n\r\n/**/\r\ndisease_user.user_city_change = function(adcode){\r\n\tdisease_user.current_adcode = disease_user.adcode_param[adcode];\r\n\t$('.disease_list_screen a.screen_link').removeClass('active');\r\n\t\r\n\tfunButtonActive();\r\n\tbusinessListActive();\r\n\t// disease_user.current_adcode = disease_user.adcode_param[adcode];\r\n\t// disease_centre.centre_search_change();\r\n\t// disease_screen.screen_search(true);\r\n\t// $('.disease_list_screen a.screen_link').removeClass('active');\r\n\t\r\n\t// let param = disease_user.adcode_param[adcode],\r\n\t// \t_center = param.center ? param.center.split(',') : null,\r\n\t// \t_zoom = config_url.nantong.zoom,\r\n\t// \t_height = disease_user.zoomToAltitude(_zoom);\r\n\t// if(!_center){\r\n\t// \t$.errorView('');\r\n\t// \treturn;\r\n\t// }\r\n\t\r\n\t// if(window.tile2d && window.tile2d.imageryProvider){\r\n\t// \twindow.tile2d.imageryProvider._resource.url = config_url.datasets2d + adcode;\r\n\t// }\r\n\t\r\n\t// let center =  Cesium.Cartesian3.fromDegrees(_center[0], _center[1], _height);\r\n\t// _viewer.camera.setView({  \r\n\t// \tdestination: center\r\n\t// })\r\n\t// // disease_road_link.handle_road_data();\r\n\t// disease_player.cesiumPlayer_init();\r\n};\r\n\r\n/*cesium3Dzoom*/\r\ndisease_user.altitudeToZoom = function(height){\r\n\tlet new_height = height;\r\n\t// if(disease_user.current_adcode && disease_user.current_adcode.adcode && disease_user.current_adcode.adcode == '441400'){\r\n\t// \tnew_height = height - 150;\r\n\t// }else if(disease_user.current_adcode && disease_user.current_adcode.adcode && disease_user.current_adcode.adcode == '522700'){\r\n\t// \tnew_height = height - 1000;\r\n\t// }\r\n\tif(new_height < 0){\r\n\t\treturn null;\r\n\t}\r\n\tvar A = 40487.57,\r\n\t\tB = 0.00007096758,\r\n\t\tC = 91610.74,\r\n\t\tD = -40467.74,\r\n\t\tzoom = D + (A - D) / (1 + Math.pow(new_height / C, B));\r\n\t\r\n\treturn zoom;\r\n};\r\n\r\n/*cesium3Dzoom*/\r\ndisease_user.zoomToAltitude = function(zoom){\r\n\tvar zoom_level = {\r\n\t\t\t/*'1': 45000000,\r\n\t\t\t'2': 26000000,\r\n\t\t\t'3': 10311040,\r\n\t\t\t'4': 5932713,\r\n\t\t\t'5': 2966357,\r\n\t\t\t'6': 1483178,\r\n\t\t\t'7': 741589,\r\n\t\t\t'8': 250000,*/\r\n\t\t\t'9': 200000,\r\n\t\t\t'10': 90000,\r\n\t\t\t'11': 37000,\r\n\t\t\t'12': 22000,\r\n\t\t\t'13': 10000,\r\n\t\t\t'14': 6000,\r\n\t\t\t'15': 2400,\r\n\t\t\t'16': 1500,\r\n\t\t\t'17': 717,\r\n\t\t\t'18': 300,\r\n\t\t\t'19': 150,\r\n\t\t\t'20': 60,\r\n\t\t\t'21': 30,\r\n\t\t\t'22': 15,\r\n\t\t\t'23': 13,\r\n\t\t\t'24': 5,\r\n\t\t\t'25': 2,\r\n\t\t\t'26': 1,\r\n\t\t\t'27': 0.5\r\n\t\t},\r\n\t\theight = zoom_level[zoom] || 0,\r\n\t\tnew_height = height + 150;\r\n\t// if(disease_user.current_adcode && disease_user.current_adcode.adcode && disease_user.current_adcode.adcode == '441400'){\r\n\t// \treturn new_height;\r\n\t// }else if(disease_user.current_adcode && disease_user.current_adcode.adcode && disease_user.current_adcode.adcode == '522700'){\r\n\t// \treturn (height + 1000);\r\n\t// }\r\n\treturn height;\r\n};\r\n\t\r\nexport {\r\n    disease_user\r\n};\r\n// export { disease_user };\r\n// module.exports = disease_user;\r\n\r\n\r\n\r\n\r\n","/*\r\n * @Author: tao.w\r\n * @Date: 2020-11-17 18:25:10\r\n * @LastEditors: tao.w\r\n * @LastEditTime: 2020-11-24 16:04:21\r\n * @Description: \r\n */\r\n\r\n// \r\nfunction eventNameCheck(eventName) {\r\n    if (typeof eventName != 'string') {\r\n        throw '';\r\n    }\r\n}\r\n// \r\nfunction handleCheck(handle) {\r\n    if (typeof handle != 'function') {\r\n        throw ' handle';\r\n    }\r\n}\r\nlet _eventNames  = {\r\n    // \"click\":[],\r\n}\r\n\r\nlet Evented = {\r\n    // \r\n    \r\n\r\n    // \r\n    on: function (eventName, handle) {\r\n        eventNameCheck(eventName);\r\n        handleCheck(handle);\r\n        this._addHandle(eventName, handle);\r\n    },\r\n    //  \r\n    once: function (eventName, handle) {\r\n        eventNameCheck(eventName);\r\n        handleCheck(handle);\r\n        let _self = this;\r\n        let _handle = function (data) {\r\n            handle(data);\r\n            _self.remove(eventName, _handle);\r\n        }\r\n        this._addHandle(eventName, _handle);\r\n    },\r\n    // \r\n    emit: function (eventName, data) {\r\n        eventNameCheck(eventName);\r\n        // eventName\r\n        if (_eventNames[eventName]) {\r\n            let _eventName = _eventNames[eventName];\r\n\r\n            _eventName.forEach((handle) => {\r\n                handle(data);\r\n            })\r\n        }\r\n    },\r\n    // \r\n    remove: function (eventName, handle) {\r\n        eventNameCheck(eventName);\r\n        handleCheck(handle);\r\n        let _eventName = _eventNames[eventName];\r\n        if (_eventName) {\r\n            let index;\r\n            _eventNames[eventName].forEach((_handle, _index) => {\r\n                if (_handle === handle) {\r\n                    index = _index;\r\n                }\r\n            })\r\n            if (index != undefined) {\r\n                _eventName.splice(index, 1);\r\n                // \r\n                if (!_eventName.length) {\r\n                    _eventNames[eventName] = null;\r\n                }\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        else {\r\n            throw `[${eventName}]`;\r\n        }\r\n    },\r\n    // \r\n    removeAll: function (eventName) {\r\n        if (eventName) {\r\n            eventNameCheck(eventName);\r\n            let _eventName = _eventNames[eventName];\r\n            if (_eventName) {\r\n                _eventNames[eventName] = null;\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        // \r\n        else {\r\n            _eventNames = {};\r\n            return true;\r\n        }\r\n    },\r\n    //  \r\n    _addHandle: function (eventName, handle) {\r\n        if (!_eventNames[eventName]) {\r\n            let _eventName = _eventNames[eventName] = [];\r\n            _eventName.push(handle);\r\n        }\r\n        else {\r\n            _eventNames[eventName].push(handle);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nexport { Evented };","\r\n\r\n/**/\r\n/*ways-\r\nK-\r\ntrackPoint*/\r\n\r\nimport {\r\n    disease_player\r\n} from './disease_player.js';\r\n\r\nvar projection = {};\r\n\r\nprojection.getShowWays = function(ways, K, trackPoint) {\r\n\tlet geometrys = [],\r\n\t\tcontext = editor.context,\r\n\t\tR = trackPoint.tags.R,\r\n\t\tT = trackPoint.tags.T,\r\n\t\twidth = trackPoint.tags.picW,\r\n\t\theight = trackPoint.tags.picH;\r\n\tlet rect = [\r\n\t\t[0, 0],\r\n\t\t[width, height]\r\n\t];\r\n\tlet lassExtend = iD.util.lassExtend,\r\n\t\tway, nodes, node, coordinate;\r\n\tlet coordinates = [],\r\n\t\tpointMappingNode = {},\r\n\t\tnodesStroe = [];\r\n\tlet _stroeNode;\r\n\tfor (let i = 0, len = ways.length; i < len; i++) {\r\n\t\tway = ways[i];\r\n\r\n\t\tnodes = way.nodes;\r\n\t\tcoordinates = [];\r\n\t\tpointMappingNode = {};\r\n\t\tnodesStroe = [];\r\n\r\n\t\tfor (let i = 0, len = nodes.length - 1; i < len; i++) {\r\n\t\t\tnode = context.entity(nodes[i]);\r\n\t\t\tlet ePoint = context.entity(nodes[i + 1]);\r\n\t\t\tvar n2 = iD.util.trackPointToPicPixe(K, trackPoint, ePoint.loc);\r\n\t\t\tcoordinate = iD.util.trackPointToPicPixe(K, trackPoint, node.loc);\r\n\r\n\t\t\tif (i == 0 && coordinate[2] < 0 && n2[2] < 0) {\r\n\t\t\t\tePoint = context.entity(nodes[nodes.length - 2]);\r\n\t\t\t\tn2 = iD.util.trackPointToPicPixe(K, trackPoint, ePoint.loc);\r\n\t\t\t}\r\n\r\n\t\t\tif (coordinate[2] > 0) {\r\n\t\t\t\tnodesStroe.push({\r\n\t\t\t\t\t'coordinate': [coordinate[0], coordinate[1], node.loc[2]],\r\n\t\t\t\t\tnodeId: node.id\r\n\t\t\t\t});\r\n\t\t\t} else if (n2[2] > 0) {\r\n\r\n\t\t\t\tif (n2[1] > height || n2[1] < 0) {\r\n\t\t\t\t\tpoint = _.flatten(iD.util.getScreenPolygonSegment(K, R, T, width, height, node.loc, ePoint.loc)[1]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpoint = _.flatten(iD.util.getScreenPolygonSegment(K, R, T, width, height, node.loc, ePoint.loc)[0]);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tnodesStroe.push({\r\n\t\t\t\t\t'coordinate': point,\r\n\t\t\t\t\tnodeId: node.id\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tnodesStroe.push({\r\n\t\t\t\t\t'coordinate': [],\r\n\t\t\t\t\tnodeId: node.id\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet lastNode = context.entity(_.last(nodes));\r\n\t\tcoordinate = iD.util.trackPointToPicPixe(K, trackPoint, lastNode.loc);\r\n\r\n\t\tif (coordinate[2] > 0) {\r\n\t\t\tnodesStroe.push({\r\n\t\t\t\t'coordinate': [coordinate[0], coordinate[1], lastNode.loc[2]],\r\n\t\t\t\tnodeId: lastNode.id\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tlet _index = 0;\r\n\t\tfor (let j = 0; j < nodesStroe.length; j++) {\r\n\t\t\t_stroeNode = nodesStroe[j];\r\n\t\t\tif (_stroeNode.coordinate.length == 0) {\r\n\t\t\t\tif (coordinates.length > 1) {\r\n\t\t\t\t\tgeometrys.push({\r\n\t\t\t\t\t\tcoordinates,\r\n\t\t\t\t\t\tentity: way,\r\n\t\t\t\t\t\tpointMappingNode,\r\n\t\t\t\t\t\ttype: 'LineString'\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\tpointMappingNode = {};\r\n\t\t\t\tcoordinates = [];\r\n\t\t\t\t_index = 0;\r\n\t\t\t} else {\r\n\t\t\t\tcoordinates.push(_stroeNode.coordinate);\r\n\t\t\t   pointMappingNode[_index] = _stroeNode.nodeId;\r\n\t\t\t\t_index++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tif (coordinates.length > 1) {\r\n\t\t\tgeometrys.push({\r\n\t\t\t\tcoordinates,\r\n\t\t\t\tentity: way,\r\n\t\t\t\tpointMappingNode,\r\n\t\t\t\ttype: 'LineString'\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\treturn geometrys;\r\n};\r\n\r\nprojection.getShowPolygon = function(ways, K, trackPoint) {\r\n\tlet geometrys = [],\r\n\t\tR = trackPoint.R,\r\n\t\tT = trackPoint.T,\r\n\t\twidth = disease_player.camera_params.imageWidth,\r\n\t\theight = disease_player.camera_params.imageHeight;\r\n\tlet rect = [\r\n\t\t[0, 0],\r\n//      \t[width, height]\r\n\t];\r\n\tlet lassExtend = iD.util.lassExtend,\r\n\t\tway, nodes, node, coordinate, loc, point;\r\n\tlet coordinates = [],\r\n\t\tpointMappingNode = {},\r\n\t\tnodesStroe = [];\r\n\tlet _stroeNode;\r\n\t\r\n\tnodes = ways._nodes;\r\n\tcoordinates = [];\r\n\tpointMappingNode = {};\r\n\tnodesStroe = [];\r\n\tvar arr = [];\r\n\r\n\tfor (let i = 0, len = nodes.length-1; i < len; i++) {\r\n\t\tnode = nodes[i];\r\n\t\tlet ePoint = {\r\n\t\t\t\tid: 'node_' + i,\r\n\t\t\t\tloc: nodes[(i + 1) % nodes.length]\r\n\t\t\t};\r\n\t\tcoordinate = iD.util.trackPointToPicPixe(K, trackPoint, node);\r\n\t\tvar n2 = iD.util.trackPointToPicPixe(K, trackPoint, ePoint.loc);\r\n\t   \r\n\t\tif (i == 0 && coordinate[2] < 0 && n2[2] < 0) {\r\n\t\t\tePoint = {\r\n\t\t\t\tid: 'node_' + (nodes.length - 2),\r\n\t\t\t\tloc: nodes[nodes.length - 2]\r\n\t\t\t};\r\n\t\t\tn2 = iD.util.trackPointToPicPixe(K, trackPoint, ePoint.loc);\r\n\t\t}\r\n\t\tif (coordinate[2] > 0) {\r\n\t\t\tarr.push({\r\n\t\t\t\tindex: i,\r\n\t\t\t\tnodeId: 'node_' + i,\r\n\t\t\t\tloc: this.get_test([coordinate[0], coordinate[1]], K),\r\n\t\t\t\tlloc:node,\r\n\t\t\t\tcoordinate: [coordinate[0], coordinate[1]]\r\n\t\t\t});\r\n\t\t}else if (n2[2] > 0) {\r\n\t\t\t// let loc = ePoint.loc;\r\n\r\n\t\t\t// arr.forEach(d => {\r\n\t\t\r\n\t\t\t//     if (d.nodeId == ePoint.id) loc = d.loc;\r\n\t\t\r\n\t\t\t// })\r\n\t\t\tvar p = iD.util.KRt(K, R, T);\r\n\t\t\tvar x1 = iD.util.UTMProjection(node);\r\n\t\t\tvar x2 = iD.util.UTMProjection(ePoint.loc);\r\n\t\t\tvar px1 = matrix.multiply(p, x1);\r\n\t\t\tvar px2 = matrix.multiply(p, x2);\r\n\t\t\tif (n2[1] > height) {\r\n\t\t\t\tpoint = _.flatten(iD.util.getScreenPolygonSegment(K, R, T, width, height, node, ePoint.loc)[1]);\r\n\t\t\t} else {\r\n\t\t\t\tpoint = _.flatten(iD.util.getScreenPolygonSegment(K, R, T, width, height, node, ePoint.loc)[0]);\r\n\t\t\t}\r\n\t\t\t// }\r\n\t\t\tarr.push({\r\n\t\t\t\tindex: i,\r\n\t\t\t\tnodeId: 'node_' + i,\r\n\t\t\t\tlloc:node,\r\n\t\t\t\tloc: this.get_test([point[0], point[1]], K),\r\n\t\t\t\tcoordinate: [point[0], point[1]]\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tvar _t = _.last(arr);\r\n\t\t\tvar endPoint = ePoint;\r\n\t\t\tif (_t && _t.index != (i - 1)) {\r\n\t\t\t\tendPoint = {\r\n\t\t\t\t\tid: 'node_' + i,\r\n\t\t\t\t\tloc: nodes[(i - 1) % nodes.length]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tloc = endPoint.loc; \r\n\t\t\tif(_t){\r\n\t\t\t\tvar _n = nodes[_t.index];\r\n\t\t\t\tloc = _t.loc ? [_t.loc.lng, _t.loc.lat, _t.loc.elevation] : _n;\r\n\t\t\t}\r\n\t\t\tarr.forEach(d => {\r\n\t\t\t\tif (d.nodeId == endPoint.id) loc = [d.loc.lng, d.loc.lat, d.loc.elevation];\r\n\t\t\t})\r\n\t\t\tvar _p = iD.util.trackPointToPicPixe(K, trackPoint, loc);\r\n\t\t\tcoordinate = iD.util.trackPointToPicPixe(K, trackPoint, node);\r\n\t\t\tif (_p[1] > height) {\r\n\t\t\t\tpoint = _.flatten(iD.util.getScreenPolygonSegment(K, R, T, width, height, node, loc)[1]);\r\n\t\t\t}else{\r\n\t\t\t\tpoint = _.flatten(iD.util.getScreenPolygonSegment(K, R, T, width, height, node, loc)[0]);\r\n\t\t\t}\r\n\t\t\tif(_.isEmpty(point)) continue;\r\n\t\t\tarr.push({\r\n\t\t\t\tindex: i,\r\n\t\t\t\tlloc:node,\r\n\t\t\t\tnodeId: 'node_' + i,\r\n\t\t\t\tloc: this.get_test([point[0], point[1]], K),\r\n\t\t\t\tcoordinate: [point[0], point[1]]\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n//  \tif (_.isEmpty(arr)) continue;\r\n\r\n\tarr.forEach((d, i) => {\r\n\t\tnodesStroe.push({\r\n\t\t\tcoordinate: d.coordinate,\r\n\t\t\tnodeId: d.nodeId,\r\n\t\t})\r\n\t})\r\n\tfor (let j = 0; j < nodesStroe.length; j++) {\r\n\t\t_stroeNode = nodesStroe[j];\r\n\t\tcoordinates.push(_stroeNode.coordinate);\r\n\t\tpointMappingNode[j] = _stroeNode.nodeId;\r\n\t}\r\n//  \tif (!pGinPic(coordinates, width, height)) continue;\r\n\tif (coordinates.length >= 2) {\r\n\t\tgeometrys.push({\r\n\t\t\tcoordinates,\r\n\t\t\tentity: ways,\r\n\t\t\tpointMappingNode,\r\n\t\t\ttype: 'Polygon'\r\n\t\t})\r\n\t}\r\n\treturn geometrys;\r\n};\r\n\r\n/*player.pic_point --  */\r\nprojection.get_test = function(xy, K) {\r\n\tlet player = disease_player.track_list[disease_player.current_num - 1],\r\n\t\tcameraHeight = disease_player.camera_params.cameraHeight,\r\n\t\tpic_point = {\r\n\t\t\tloc: [ player.x, player.y ]\r\n\t\t};\r\n\t// let plane = player.dataMZgr.planes && player.dataMgr.planes.get(player.wayInfo.trackId);\r\n\tlet geometry = null;\r\n\tlet utm = LLtoUTM(pic_point.loc[0], pic_point.loc[1]);\r\n\tlet z = player.z - cameraHeight;\r\n\tvar lonlat = iD.util.picPixelToLonLat(_.clone(K), player, utm.zoneNumber, utm.designator, xy, z);\r\n\tgeometry = {\r\n\t\tlng: lonlat[0],\r\n\t\tlat: lonlat[1],\r\n\t\televation: z\r\n\t};\r\n\treturn geometry;\r\n};\r\n\r\n/*--*/\r\nprojection.cameraParams = function(time,type=false){\r\n\tvar params = [\r\n\t\t[disease_player.camera_params.focusX, 0, disease_player.camera_params.principlePointX],\r\n\t\t[0, disease_player.camera_params.focusX, disease_player.camera_params.principlePointY],\r\n\t\t[0, 0, 1]\r\n\t];\r\n\treturn params;\r\n};\r\n\r\nexport {\r\n    projection\r\n};\r\n\r\n\r\n\r\n\r\n\r\n","\r\nimport {\r\n    disease_info\r\n} from '../disease_info.js';\r\n\r\nvar orthographAddlayer = {};\r\nvar _map = null;\r\nvar catchData = [];\r\n\r\nexport function addLayers(datas, currentId, map, callback){\r\n\tif(!datas.length){\r\n\t\treturn;\r\n\t}\r\n\t_map = map;\r\n\tcatchData = datas;\r\n\tvar geometries = {\r\n\t\t'type': 'geojson',\r\n\t\t'data': {\r\n\t\t\t'type': 'FeatureCollection',\r\n\t\t\t'features': [\r\n\t\t\t\t\r\n\t\t\t],\r\n\t\t}\r\n\t}\r\n\tcatchData.forEach( (data, index) => {\r\n\t\tlet range = data.properties.GEOM,\r\n\t\t\tclass_name = data.properties.ID,\r\n\t\t\tcenter = data.properties.center_xy,\r\n\t\t\tlayer_type = data.properties.range_type || data.properties.layer_type || 'Polygon',\r\n\t\t\tdata_type = data.properties.TYPE,\r\n\t\t\tcolor = (data_type == '11' || data_type == '41') ? '#979797' : '#EC3A4E',\r\n\t\t\tweight = (currentId == class_name) ? 4 : 2,\r\n\t\t\topacity = (currentId == class_name) ? 0.5 : 0.3,\r\n\t\t\tboldClass = (currentId == class_name) ? ' fontBold' : '';\r\n\t\t\r\n\t\tvar geoJson = $.geoJsonParam({\r\n\t\t\t'range': range,\r\n\t\t\t'id': index,\r\n\t\t\t'properties': data.properties,\r\n\t\t\t'type': layer_type,\r\n\t\t\t'color': color,\r\n\t\t\t'weight': weight,\r\n\t\t\t'opacity': opacity\r\n\t\t});\r\n\t\t\r\n\t\tlet markDiv = document.createElement(\"div\");\r\n\t\tmarkDiv.className = 'geometriesLabel' + boldClass;\r\n\t\tmarkDiv.innerHTML = data.properties._cn_type;\r\n\t\tmarkDiv.setAttribute('dataId', class_name);\r\n\r\n\t\tvar _m = new mapboxgl.Marker({\r\n\t\t\tanchor: 'bottom',\r\n\t\t\telement: markDiv\r\n\t\t})\r\n\t\t.setLngLat([center[0], center[1]])\r\n\t\t.addTo(_map);\r\n\t\t\r\n\t\tgeometries.data.features.push(geoJson);\r\n\t} )\r\n\t\r\n\tremoveLayers();\r\n\tremoveSources();\r\n\t// removeLayers(function(){\r\n\t\t// removeSources(function(){\r\n\t\t\tmap.addSource('features', geometries);\r\n\t\t\tmap.addLayer({\r\n\t\t\t\t'id': 'polygons',\r\n\t\t\t\t'type': 'fill',\r\n\t\t\t\t'source': 'features',\r\n\t\t\t\t'paint': {\r\n\t\t\t\t\t\"fill-opacity\": ['get', 'opacity'],\r\n\t\t\t\t\t// \"fill-opacity\": 0.4,\r\n\t\t\t\t\t// \"fill-color\": ['get', 'color']\r\n\t\t\t\t\t\"fill-color\": [\r\n\t\t\t\t\t\t'case',\r\n\t\t\t\t\t\t['boolean', ['feature-state', 'hover'], false],\r\n\t\t\t\t\t\t'#00F4BF',\r\n\t\t\t\t\t\t['get', 'color']\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t'filter': ['==', '$type', 'Polygon']\r\n\t\t\t});\r\n\t\t\tmap.addLayer({\r\n\t\t\t\t'id': 'polylines',\r\n\t\t\t\t// 'type': 'LineString',\r\n\t\t\t\t'type': 'line',\r\n\t\t\t\t'source': 'features',\r\n\t\t\t\t'paint': {\r\n\t\t\t\t\t'line-width': ['get', 'weight'],\r\n\t\t\t\t\t// \"line-color\": ['get', 'color']\r\n\t\t\t\t\t\"line-color\": [\r\n\t\t\t\t\t\t'case',\r\n\t\t\t\t\t\t['boolean', ['feature-state', 'hover'], false],\r\n\t\t\t\t\t\t'#00F4BF',\r\n\t\t\t\t\t\t['get', 'color']\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t'filter': ['==', '$type', 'LineString']\r\n\t\t\t});\r\n\t\t\tcallback && callback();\r\n\t\t\tinitCustomEvent();\r\n\t\t// });\r\n\t// });\r\n}\r\n\r\nvar hoveredStateId = null; //\r\nvar hoveredLayerId = null; //\r\nvar hoveredLayerColor = null; //\r\nlet sources = ['features'];\r\nlet layers = ['polylines', 'polygons'];\r\n\r\n/**\r\n * @description: \r\n * @param {*} _config\r\n * @return {*}\r\n */\r\nfunction initCustomEvent(){\r\n    removeLayerEvent();\r\n    for (let i = 0; i < layers.length; i++) {\r\n        _map.on('mousemove', layers[i], vectorMousemove);\r\n        _map.on('mouseleave', layers[i], vectormouseleave);\r\n        _map.on('click', layers[i], vectorMouseClick);\r\n    }\r\n}\r\n\r\n/**\r\n * @description:  \r\n * @param {*}\r\n * @return {*}\r\n */\r\nfunction removeLayerEvent() {\r\n    for (let i = 0; i < layers.length; i++) {\r\n        _map.off('mousemove', layers[i], vectorMousemove);\r\n        _map.off('mouseleave', layers[i], vectormouseleave);\r\n\t\t_map.off('click', layers[i], vectorMouseClick);\r\n    }\r\n}\r\n\r\nfunction vectorMousemove(e) {\r\n    if (e.features.length > 0) {\r\n\t\t\r\n        if (hoveredStateId && hoveredLayerId) {\r\n            let layer = _map.getLayer(hoveredLayerId);\r\n            _map.setFeatureState(\r\n                {\r\n                    source: layer.source,\r\n                    id: hoveredStateId\r\n                },\r\n                { hover: false }\r\n            );\r\n        }\r\n        let feature = e.features[0];\r\n\t\t\r\n        hoveredStateId = feature.id;\r\n        hoveredLayerId = feature.layer.id;\r\n\t\thoveredLayerColor = feature.properties.color;\r\n\t\t\r\n        let layer = _map.getLayer(hoveredLayerId);\r\n\t\t_map.setFeatureState(\r\n\t\t\t{\r\n\t\t\t\tsource: layer.source,\r\n\t\t\t\tid: hoveredStateId\r\n\t\t\t},\r\n\t\t\t{ hover: true }\r\n\t\t);\r\n    }\r\n}\r\n\r\nfunction vectormouseleave(e) {\r\n    if (hoveredStateId) {\r\n        let layer = _map.getLayer(hoveredLayerId);\r\n        _map.setFeatureState(\r\n            {\r\n                source: layer.source,\r\n                id: hoveredStateId\r\n            },\r\n            { hover: false }\r\n        );\r\n    }\r\n    hoveredStateId = null;\r\n}\r\n\r\n/**\r\n * @description: \r\n * @param {*}\r\n * @return {*}\r\n */\r\n//\r\nfunction vectorMouseClick(e) {\r\n    let feature = e.features[0];\r\n\tif(feature){\r\n\t\tvar properties = feature.properties,\r\n\t\t\tinfo = catchData.find( d=> { return d.properties.ID == properties.ID } );\r\n\t\tinfo && disease_info.come_to_info(info,true,true);\r\n\t}\r\n}\r\n\r\n/**\r\n * @description: mvt\r\n * @param {*} sources\r\n * @return {*}\r\n */\r\nfunction removeSources(callback) {\r\n\t\r\n    // TODO \r\n    if (_map == null) return false;\r\n    for (let i = 0; i < sources.length; i++) {\r\n        let source = sources[i];\r\n\t\tif( _map.getSource(source) ){\r\n\t\t\t_map.removeSource(source);\r\n\t\t}\r\n    }\r\n\tcallback && callback();\r\n}\r\n/**\r\n * @description: \r\n * @param {*} layers\r\n * @return {*}\r\n */\r\nfunction removeLayers(callback) {\r\n    if (_map == null) return false;\r\n    for (var i in layers) {\r\n        var layer = layers[i];\r\n\t\tif( _map.getLayer(layer) ){\r\n\t\t\t_map.removeLayer(layer);\r\n\t\t}\r\n    }\r\n\tcallback && callback();\r\n}","\r\nimport {\r\n    disease_player\r\n} from '../disease_player.js';\r\nimport {\r\n    disease_info\r\n} from '../disease_info.js';\r\n\r\nvar lastInfoId = null;\r\n// var map;\r\nvar polygons = {};\r\nvar last_polygon = null;\r\nvar bufferResults = null;\r\n\r\n/**\r\n * @description -\r\n * @param {*string} containerID domid\r\n */\r\nexport function visuaUpMapInit(containerID){\r\n\tbufferResults = disease_player.getTrackBufferResults();\r\n\t\r\n\tvar _view = disease_info.current_info;\r\n\t// let mapboxgl.accessToken = token;\r\n\tlet\tmainshootUrl = config_url.mainshoot + '&key=' + _view.properties.TRACK_ID;\t//   key disease_info.current_info.properties.TRACK_ID; \r\n\r\n\t\t/* */\r\n\tlet mpstyle = {\r\n\t\t\"version\": 8,\r\n\t\t\"sources\": {\r\n\t\t\t\"raster-mainshoot\": {\r\n\t\t\t\t\"type\": \"raster\",\r\n\t\t\t\t'tiles': [mainshootUrl],\r\n\t\t\t\t\"tileSize\": 256,\r\n\t\t\t\t\"zoom\": 23,\r\n\t\t\t\t\"minzoom\": 22,\r\n\t\t\t\t\"maxzoom\": 24,\r\n\t\t\t}\r\n\t\t},\r\n\t\t\"layers\": [\r\n\t\t\t{\r\n\t\t\t\t\"id\": \"raster-mainshoot\",\r\n\t\t\t\t \"type\": \"raster\",\r\n\t\t\t\t\"source\": \"raster-mainshoot\"\t\t\t\r\n\t\t\t}\r\n\t\t]\r\n\t};\r\n\t/*mapbox */\r\n\tif(!window.mbSideMap) {\r\n\t\tlet _opt = {\r\n\t\t\tstyle: mpstyle,\r\n\t\t\tzoom: 23,\r\n\t\t\tminZoom: 22,\r\n\t\t\tcenter: _view.center_xy, \r\n\t\t\tmaxZoom: 24,\r\n\t\t\tpitch: 0,\r\n\t\t\tbearing: 0,\r\n\t\t}\r\n\t\twindow.mbSideMap = new mapboxgl.Map({\r\n\t\t\tcontainer: containerID,\r\n\t\t\tstyle:_opt.style,\r\n\t\t\tzoom: _opt.zoom,\r\n\t\t\tminZoom: _opt.minZoom,\r\n\t\t\tmaxZoom: _opt.maxZoom,\r\n\t\t\tcenter: _opt.center,\r\n\t\t\tpitch: _opt.pitch,\r\n\t\t\tlogoPosition: \"bottom-right\",   //\r\n\t\t\tbearing: _opt.bearing\r\n\t\t});\r\n\t\tmbSideMap.on('load', function() {\r\n\t\t\t/**canvas  400*600zoom23 */\t\t\t\t\r\n\t\t\tthis.resize();\r\n\t\t\tthis.setZoom(22);\r\n\t\t\t\r\n\t\t\tthis.on('mouseenter', \"raster-mainshoot\", (e) => {\r\n\t\t\t\tmbSideMap_Mouseenter(e);\r\n\t\t\t});\r\n\t\t\tthis.on('click', \"raster-mainshoot\", (e) => {\r\n\t\t\t\tmbSideMap_Click(e);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\r\n\t} else {\r\n\t\t/*trackid */\r\n\t\tremoveData(mbSideMap, 'raster-mainshoot', 'Layer');\r\n\t\tremoveData(mbSideMap, 'raster-mainshoot', 'Source');\r\n\t\tmbSideMap.addSource('raster-mainshoot',\r\n\t\t\tmpstyle.sources['raster-mainshoot']\r\n\t\t);\r\n\t\tmbSideMap.addLayer(mpstyle.layers[0]);\r\n\t}\t\r\n};\r\n/**\r\n*@description    \r\n * @param {*} _map mapbox\r\n * @param {*} _id id\r\n * @param {*} _type SourceLayer\r\n */\r\nfunction removeData(_map, _id, _type) {\r\n\tif( _map['get' + _type](_id) ){\r\n\t\t_map['remove' + _type](_id)\r\n\t}\r\n}\r\n/*svg */\r\nfunction mbSideMap_Mouseenter(e) {\r\n\tlet target = e.originalEvent.target;\r\n\tif(last_polygon){\r\n\t\tlet my_index = polygons[last_polygon._leaflet_id];\r\n\t\tlet pathData = bufferResults.features.find(d=>{ return d.properties.ID == my_index });\r\n\t\tif(my_index && pathData){\t\t\t\t\t\r\n\t\t\tlet my_type = pathData.properties.TYPE;\r\n\t\t\tlet my_color = (my_type == '11')? '#979797' :'#EC3A4E';\r\n\t\t\tlast_polygon.style.stroke = my_color;\r\n\t\t}\r\n\t}\r\n\tif(target.tagName == 'path'){\r\n\t\ttarget.style.stroke = '#00F4BF';\r\n\t\tlast_polygon = target;\r\n\t}\r\n}\r\n/*svg */\r\nfunction mbSideMap_Click(e) {\r\n\tlet target = e.originalEvent.target,\r\n\tpath_id = target._leaflet_id;\r\n\tif(path_id && (polygons[path_id] || polygons[path_id] === 0)){\r\n\t\tlet path_index = polygons[path_id];\r\n\t\tlet pathData = bufferResults.features.find(d=>{ return d.properties.ID == path_index });\r\n\t\t\r\n\t\tif(!pathData){\r\n\t\t\t$.errorView('');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdisease_player.click_types = false;\r\n\t\tdisease_info.come_to_info(pathData, true, true, true);\r\n\t}\r\n}\r\n\r\n\r\n/*mapboxgl--*/\r\n//#region 0112\r\nfunction visua_up_map_layer() {\r\n\tlet _view = disease_info.current_info,\r\n\t\t_center = _view.center_xy,\r\n\t\t_loc = _view.locs,\r\n\t\t_layers = map.getStyle()._layers || [],\r\n\t\tthisRange = [];\r\n}\r\n\r\n\r\n","/*\r\n * @Author: tao.w\r\n * @Date: 2020-11-13 17:53:44\r\n * @LastEditors: tao.w\r\n * @LastEditTime: 2020-11-30 16:41:51\r\n * @Description: \r\n */\r\n// import { mapboxgl } from \"mapbox-gl\";\r\n\r\nlet token = 'pk.eyJ1Ijoic3BpZGVyejciLCJhIjoiY2lxYXBweWQwMDJhaWZubTFhOW1hNmJraCJ9.NUgEOOc-qxaL52ghK2ic4Q';\r\n\r\n\r\n//let line = turf.lineString([  trackLocxs\r\n//     [-76.091308, 18.427501],\r\n//     [-76.695556, 18.729501],\r\n//     [-76.552734, 19.40443],\r\n//     [-74.61914, 19.134789],\r\n//     [-73.652343, 20.07657],\r\n//     [-73.157958, 20.210656]\r\n//   ])\r\n// var buffered = turf.buffer(line, 10, {units: 'miles'});\r\n// \"http://192.168.7.26:19010/pdds/data/pd/get?queryCriteriaJson={\"bbox\":\"0,0,2,2\",\"polygon\":\"POLYGON((0 0,0 2,2 2,2 0,0 0))\",\"ops\":[{\"k\":\"properties.NAME\",\"v\":\"\",\"op\":\"eq\"}],\"sort\":[{\"k\":\"properties.TASK_ID\",\"order\":\"desc\"}]}\"\r\n//TODO  \r\n\r\n\r\nexport function mapInit(containerID, mapOption = {}, images = []) {\r\n    let map;\r\n    let _opt = {\r\n        style: 'mapbox://styles/mapbox/light-v10',\r\n        zoom: 9,\r\n        minZoom: 9,\r\n        // center: [107.26324629629052,26.363503482566767],\r\n        center:  [121.12826135311582, 32.30269121007785, 1051.466086090133],\r\n        maxZoom: 22,\r\n        pitch: 0,\r\n        bearing: 0,\r\n    }\r\n    // _main_map.setCenter({lng: 121.12826135311582, lat: 32.30269121007785})\r\n    \r\n    function addImageItem(map,fname,i) {\r\n        map.loadImage('./Apps/Dist/icon/' + fname, function (error, image) {\r\n            if (error) throw error;\r\n            //Add an image to the style\r\n            let _imageId = fname.split('.')[0];\r\n            if (!map.hasImage('_imageId')){\r\n                map.addImage(_imageId, image);\r\n            } \r\n        });\r\n    }\r\n    \r\n    mapboxgl.accessToken = token;\r\n    Object.assign(_opt,mapOption);\r\n    map = new mapboxgl.Map({\r\n        container: containerID,\r\n        style: _opt.style,\r\n        zoom: _opt.zoom,\r\n        minZoom:_opt.minZoom,\r\n        maxZoom:_opt.maxZoom,\r\n        center: _opt.center,\r\n        pitch: _opt.pitch,\r\n        logoPosition:\"bottom-right\",   //\r\n        bearing: _opt.bearing,\r\n        renderWorldCopies: false\r\n\r\n    });\r\n\r\n    for (let i = 0; i < images.length; i++) {\r\n        addImageItem(map,images[i],i);\r\n    }\r\n\r\n    // map.addControl(new mapboxgl.NavigationControl());\r\n\r\n    return map;\r\n};","/*\r\n * @Author: tao.w\r\n * @Date: 2020-09-02 14:54:09\r\n * @LastEditors: tao.w\r\n * @LastEditTime: 2020-09-05 17:40:32\r\n * @Description: \r\n */\r\n\r\nimport {\r\n    disease_player\r\n} from '../disease_player.js';\r\nimport {\r\n    disease_info\r\n} from '../disease_info.js';\r\nimport {\r\n    disease_user\r\n} from '../disease_user.js';\r\n\r\nimport {\r\n    projection\r\n} from '../get_show_polygon.js';\r\n\r\n\r\n\r\nvar cesium_player = {};\r\nvar viewer_copy;\r\nvar show_type = false;\r\ncesium_player.polygons = {};\r\ncesium_player.current_adcode = null;\r\ncesium_player.last_polygon = null;\r\ncesium_player.hdmap = null;\r\ncesium_player.id = 'threed_map';\r\ncesium_player.viewport_quad = null;\r\ncesium_player._alpha = 100;\r\nlet _viewer;\r\n// let _alpha = 1.0;\r\n\r\nfunction initCesium() {\r\n\t\r\n\tCesium.Ion.defaultAccessToken = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI1NWI5MGUzNi1mYWI3LTQzY2QtOGI0Ni0xZWYyNTAxNGM4N2MiLCJpZCI6MTI1OTgsInNjb3BlcyI6WyJhc3IiLCJnYyJdLCJpYXQiOjE1NjE0NDkyNTV9.hBH0PGSnKErc_yNhIePASUkr3QPDoo0KDX9uLpNBUns\";\r\n    \r\n\tlet clock = new Cesium.Clock({\r\n        startTime: Cesium.JulianDate.fromIso8601('2020-08-01T06:00+0800'),\r\n        currentTime: Cesium.JulianDate.fromIso8601('2020-08-01T06:00+0800'),\r\n        stopTime: Cesium.JulianDate.fromIso8601('2020-08-01T06:00+0800'),\r\n        clockRange: Cesium.ClockRange.LOOP_STOP, // loop when we hit the end time\r\n        clockStep: Cesium.ClockStep.SYSTEM_CLOCK_MULTIPLIER,\r\n        multiplier: 1, // how much time to advance each tick\r\n        shouldAnimate: false // Animation on by default\r\n    });\r\n    //\r\n    var map_proj = new Cesium.GeographicProjection();\r\n    var globe = new Cesium.Globe(map_proj.ellipsoid);\r\n    //#ADADAD\r\n    globe.baseColor = Cesium.Color.fromRgba(0x00000000);//Cesium.Color.DARKSEAGREEN;//Cesium.Color.BLACK;\r\n    globe.enableLighting = true;\r\n    //\r\n\tif(viewer_copy){\r\n\t\tviewer_copy.destroy();\r\n\t\tcesium_player.viewport_quad = null;\r\n\t}\r\n\t\r\n    let viewer = new Cesium.Viewer('threed_map', {\r\n        clockViewModel: new Cesium.ClockViewModel(clock),\r\n        imageryProvider: null,\r\n        terrainProvider: null,// terrainProvider,\r\n        globe: globe,\r\n        shadows: false,\r\n        homeButton: false,\r\n        sceneModePicker: false,\r\n        useBrowserRecommendedResolution: false,\r\n        infoBox: true,\r\n        terrainShadows: false,\r\n        baseLayerPicker: false,\r\n        geocoder: false,\r\n        timeline: false,\r\n        selectionIndicator: false,\r\n        navigationHelpButton: false,\r\n        navigationInstructionsInitiallyVisible: false,\r\n        animation: false,\r\n        requestRenderMode: true\r\n    });\r\n\r\n    viewer_copy = viewer;\r\n    let scene = viewer.scene;\r\n    scene.fog.enabled = true;\r\n\t\r\n\t// scene.screenSpaceCameraController.enableRotate = false;\r\n\t// scene.screenSpaceCameraController.enableTranslate = false;\r\n\t// scene.screenSpaceCameraController.enableZoom = false;\r\n\t// scene.screenSpaceCameraController.enableTilt = false;\r\n\t\r\n    //\r\n    //scene.debugShowFramesPerSecond = true;\r\n    globe.enableLighting = true;\r\n    let tiles = disease_user.current_adcode['3d_tiles'];\r\n    cesium_player.current_adcode = disease_user.current_adcode.dataVersion;\r\n    viewer._cesiumWidget._creditContainer.style.display = \"none\";\r\n\r\n    cesium_player.hdmap = new Cesium.Cesium3DTileset({\r\n        url: config_url.datasets_adcode + tiles + '/tileset.json',\r\n        skipLevelOfDetail: true,\r\n        maximumMemoryUsage: 1024\r\n    });\r\n    viewer.scene.primitives.add(cesium_player.hdmap);\r\n    viewer._cesiumWidget._creditContainer.style.display = \"none\";\r\n\t\r\n\t\t\r\n    if (cesium_player.viewport_quad == null) {\r\n        cesium_player.viewport_quad = new Cesium.ViewportQuad();\r\n\t\tcesium_player.viewport_quad.show = false;\r\n        viewer.scene.primitives.add(cesium_player.viewport_quad);\r\n    }\r\n\r\n    //\r\n    {\r\n        let imagery_nums = viewer.imageryLayers.length;\r\n        for (let i = 0; i < imagery_nums; i++) {\r\n            viewer.imageryLayers.get(i).show = false;\r\n        }\r\n    }\r\n\r\n    return viewer;\r\n}\r\nfunction updateViewport(K, point, camera_params) {\r\n    if (!cesium_player.viewport_quad) return;\r\n    //\r\n    var quad_width = _viewer.canvas.clientWidth * window.devicePixelRatio;\r\n    var quad_height = _viewer.canvas.clientHeight * window.devicePixelRatio;\r\n    //\r\n    let delta = { 'roll': camera_params.rollDelta, 'azimuth': camera_params.azimuthDelta, 'pitch': camera_params.pitchDelta };\r\n\r\n    let current_pos = iD.util.CreateBatchProp(K, point, delta, camera_params.imageWidth, camera_params.imageHeight, camera_params.principlePointX, camera_params.principlePointY);\r\n\r\n    if (current_pos['p2'] != undefined && current_pos['p4'] != undefined) {\r\n        let p2 = current_pos['p2'];\r\n        let p4 = current_pos['p4'];\r\n        let pixel2 = _viewer.scene.cartesianToCanvasCoordinates(Cesium.Cartesian3.fromDegrees(p2[0], p2[1], p2[2]));\r\n        let pixel4 = _viewer.scene.cartesianToCanvasCoordinates(Cesium.Cartesian3.fromDegrees(p4[0], p4[1], p4[2]));\r\n        //\r\n        let width = Math.abs((pixel4.x - pixel2.x) * window.devicePixelRatio);\r\n        let height = Math.abs((pixel4.y - pixel2.y) * window.devicePixelRatio);\r\n        let left = pixel2.x * window.devicePixelRatio;\r\n        let bottom = quad_height - pixel2.y * window.devicePixelRatio;\r\n        //\r\n        cesium_player.viewport_quad.rectangle = new Cesium.BoundingRectangle(left, bottom, width, height);\r\n    } else {\r\n        cesium_player.viewport_quad.rectangle = new Cesium.BoundingRectangle(0, 0, quad_width, quad_height);\r\n    }\r\n    let img_url = config_url.krs + 'image/get?trackPointId=' + point.trackPointId + '&type=00&seq=005&imageType=jpg&token=' + window.token;\r\n\tlet new_op = cesium_player._alpha / 100;\r\n    cesium_player.viewport_quad.material = new Cesium.Material({\r\n        fabric: {\r\n            type: 'Image',\r\n            uniforms: {\r\n                color: new Cesium.Color(1.0, 1.0, 1.0, new_op),\r\n                image: img_url\r\n            }\r\n        }\r\n    });\r\n\r\n}\r\n\r\n// \r\ncesium_player.change_toggle = function (type) {\r\n\tcesium_player.viewport_quad.show = type;\r\n\tif(type){\r\n\t\tcesium_player.update();\r\n\t}\r\n    viewer_copy.scene.requestRender();\r\n}\r\n\r\n// \r\ncesium_player.change_alpha = function (op) {\r\n\tlet new_op = op / 100;\r\n    if (cesium_player.viewport_quad) {\r\n        cesium_player.viewport_quad.material.uniforms.color.alpha = new_op;\r\n        cesium_player._alpha = op;\r\n        _viewer.scene.requestRender();\r\n    }\r\n}\r\n\r\nfunction location(xyz, roll, pitch, yaw) {\r\n    if (!_viewer) return;\r\n    let position = Cesium.Cartesian3.fromDegrees(xyz[0], xyz[1], xyz[2]);\r\n    _viewer.camera.setView({\r\n        destination: position,\r\n        orientation: {\r\n            heading: Cesium.Math.toRadians(yaw), // east, default value is 0.0 (north)\r\n            pitch: Cesium.Math.toRadians(pitch),    // default value (looking down)\r\n            roll: Cesium.Math.toRadians(roll)                            // default value\r\n        }\r\n    });\r\n}\r\n\r\ncesium_player.playerInit = function () {\r\n    window.playerCesium = _viewer = initCesium();\r\n}\r\ncesium_player.update = function () {\r\n    let _current_info = disease_info.current_info;\r\n    let _tracklist = disease_player.track_list;\r\n    let _camera_params = disease_player.camera_params;\r\n    let idx = disease_player.current_num;\r\n    if (!_tracklist || !_tracklist.length) return;\r\n    let trackPoint = _tracklist[idx - 1];\r\n    if (!trackPoint) return;\r\n    let _center = [trackPoint.x, trackPoint.y, trackPoint.z];\r\n\r\n    var K = projection.cameraParams();\r\n\r\n    if (window.playerCesium) {\r\n        location(_center, trackPoint.roll, trackPoint.pitch, trackPoint.azimuth);\r\n    } else {\r\n        window.playerCesium = _viewer = initCesium();\r\n        location(_center, trackPoint.roll, trackPoint.pitch, trackPoint.azimuth);\r\n    }\r\n    updateViewport(K, trackPoint, _camera_params);\r\n    // cesium_player.catchPotreeImage(_tracklist);\r\n    return;\r\n};\r\n\r\n/*leaflet--*/\r\ncesium_player.visua_up_map_layer = function () {\r\n\r\n};\r\n\r\n/*--*/\r\ncesium_player.road_player = function (type) {\r\n\r\n    cesium_player.disease_region();\r\n};\r\n\r\n/**/\r\ncesium_player.disease_region = function () {\r\n    $('.player_video .leaflet-marker-icon').hide();\r\n    $('.player_video svg path').hide();\r\n    if (disease_player.recog_result == '1') {\r\n        $('.player_video .leaflet-marker-icon').show();\r\n    }\r\n    if (disease_player.recog_result == '2') {\r\n        $('.player_video svg path').show();\r\n    }\r\n};\r\n/**/\r\ncesium_player.catchPotreeImage = function (alldata) {\r\n    var _this = this,\r\n        total_length = alldata.length - 1,\r\n        loadedimages = 0,\r\n        iserr = false,\r\n        init_index = _this.current_num - 1,\r\n        start_index = ((_this.current_num - _this.catch_count) > -1) ? (_this.current_num - _this.catch_count) : 0,\r\n        end_index = ((_this.current_num + _this.catch_count) < total_length) ? (_this.current_num + _this.catch_count) : total_length,\r\n        length = end_index - start_index + 1;\r\n\r\n    for (var i = start_index; i <= end_index; i++) {\r\n        var img = new Image(),\r\n            _data = alldata[i],\r\n            track_point_id = _data.trackPointId,\r\n            _src = config_url.krs + 'image/get?trackPointId=' + track_point_id + '&type=00&seq=005&imageType=jpg&token=' + window.token;\r\n\r\n        img.src = _src;\r\n        if (img.complete) {  \t\t// \r\n            imageloadpost();\r\n            continue; \t\t\t\t// onload\r\n        }\r\n        img.onload = function () {\r\n            imageloadpost();\r\n        }\r\n        img.onerror = function () {\r\n            iserr = true;\r\n            imageloadpost();\r\n        }\r\n    }\r\n\r\n    function imageloadpost() {\r\n        loadedimages++;\r\n        if (loadedimages == length) {\r\n            if (iserr) {\r\n                console.warn('');\r\n            }\r\n        }\r\n    }\r\n\r\n};\r\n\r\n\r\nexport {\r\n    cesium_player\r\n};\r\n\r\n\r\n\r\n","\r\nimport {\r\n\tdisease_user\r\n} from './disease_user.js';\r\n\r\n$('.data_header .business_name').mouseover(function(){\r\n\tvar client = this.getBoundingClientRect(),\r\n\t\tleft = client.left - 24,\r\n\t\ttop = client.top + client.height - 14;\r\n\t\r\n\t$('.data_header .business_list').css({\r\n\t\ttop: top+\"px\",\r\n\t\tleft: left+\"px\"\r\n\t})\r\n\t$('.data_header .business_list').css('display', 'block');\r\n\t$('.data_header .business_list a span').attr('class', 'iconfont iconshangsanjiao');\r\n})\r\n$('.data_header .business_name').mouseout(function(){\r\n\t$('.data_header .business_list').css('display', 'none');\r\n\t$('.data_header .business_list a span').attr('class', 'iconfont iconxiasanjiao');\r\n})\r\n$('.button_other').mouseover(function(){\r\n\t$('.user_install').css('display', 'block');\r\n})\r\n$('.button_other').mouseout(function(){\r\n\t$('.user_install').css('display', 'none');\r\n})\r\n$('.button_other .user_install .user_handle').click(function(){\r\n\tdisease_user.userSignOut();\r\n})\r\n$('#user_role .citylists').on('click', 'span', function (e) {\r\n\tlet dom = (e.target.localName == 'b') ? e.target.parentNode : e.target;\r\n\tuser_city_change(dom);\r\n});\r\n\r\n\r\n\r\nlet userinfo = $.getLocalStorage('userInfo') || '{}',\r\n\tjson_userinfo = JSON.parse(userinfo),\r\n\tename = json_userinfo.userName || '',\r\n\tusername = json_userinfo.cnName || '';\r\n\r\n$('.user_name').html(username);\r\n$('#user_role .user_name').eq(1).html(ename);\r\n\r\nlet adcode_param = {};\r\nfunction userfindRole(callback){\r\n    adcode_param = {};\r\n    let _url = config_url.pdds + 'user/district/permission/findCitiesByUsername?username=' + username;\r\n    $.getAjax({\r\n        'url': _url,\r\n        'token': true,\r\n        'callback': function(data){\r\n            let adcodes = data.result || [];\r\n            if(data.code != '0'){\r\n                $.errorView('');\r\n            }else if(!adcodes.length){\r\n                $.errorView('');\r\n            }else{\r\n                for(let s=0; s<adcodes.length; s++){\r\n                    let dataVersion = adcodes[s].dataVersion;\r\n                    adcode_param[dataVersion] = adcodes[s];\r\n                }\r\n            }\r\n            callback && callback();\r\n        }\r\n    })\r\n};\r\n\r\n/**/\r\nfunction user_city_change(dom){\r\n\t\r\n    let tagCode = dom.getAttribute('name');\r\n    if(!tagCode){\r\n        return;\r\n    }\r\n    let _url = config_url.pdds + 'user/tag/setDefault?defaultTag=' + tagCode + '&username=' + json_userinfo.userName;\r\n\t\r\n\t$.postAjax({\r\n\t\t'url': _url,\r\n\t\t'token': true,\r\n\t\t'data': {},\r\n\t\t'callback': function(data){\r\n\t\t\tlet adcodes = data.result || [];\r\n\t\t\tif(data.code != '0'){\r\n\t\t\t\t$.errorView(data.message);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t$.errorView(data.message, true);\r\n\t\t\t$('#user_role .citylists span').removeClass('active');\r\n\t\t\t$(dom).addClass('active');\r\n\t\t}\r\n\t})\r\n}\r\n\r\n/**/\r\nfunction citylists(){\r\n\tlet citys = [];\r\n\tlet city_html = '';\r\n\tfor(let item in adcode_param){\r\n\t\tlet cityname = adcode_param[item].name,\r\n\t\t\tnewname = cityname.replace(/||||/ig, ''),\r\n\t\t\tisDefault = adcode_param[item].isDefault,\r\n\t\t\tadcode = adcode_param[item].adcode,\r\n\t\t\ttagCode = adcode_param[item].tagCode,\r\n\t\t\tactive = isDefault ? 'active' : '';\r\n\t\tcitys.push({\r\n\t\t\t'name': cityname,\r\n\t\t\t'new_name': newname,\r\n\t\t\t'adcode': adcode,\r\n\t\t\t'tagCode': tagCode,\r\n\t\t\t'dataVersion': item,\r\n\t\t\t'active': active\r\n\t\t})\r\n\t}\r\n\tif(citys.length == 1){\r\n\t\tcity_html = '<span>'+citys[0].new_name+'</span>';\r\n\t}else if(citys.length > 1){\r\n\t\tcity_html = `\r\n\t${citys.map(a => `\r\n\t\t\t\t<span class='${a.active}' name='${a.tagCode}'>\r\n\t\t\t\t\t<b></b>${a.new_name}\r\n\t\t\t\t</span>\r\n\t`).join('')}\r\n\t\t`;\r\n\t}\r\n\t\r\n\t$('.citylists').append(city_html)\r\n}\r\n\r\nuserfindRole(\r\n\tcitylists\r\n);\r\n\r\n\t"],"sourceRoot":""}