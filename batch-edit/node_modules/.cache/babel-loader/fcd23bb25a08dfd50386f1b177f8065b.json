{"ast":null,"code":"/* eslint-disable prettier/prettier */\nimport jq from \"jquery\"; // 获取最新配置\n\nexport function oauth2Client(app, url) {\n  var oauth2Client = {\n    ouc: {\n      user: null,\n      oauth2User: url,\n      clientId: \"client\",\n      clientSecret: \"secret\"\n    },\n    getNoHashUrl: function () {\n      return window.location.href.split(\"#\")[0];\n    },\n    begin: function () {\n      var opts = {\n        authorizeUrl: oauth2Client.ouc.oauth2User + \"/authorize\",\n        clientId: oauth2Client.ouc.clientId,\n        redirectUri: oauth2Client.getNoHashUrl(),\n        responseType: 'code'\n      }; // opts = jq.extend({\n      //   clientId: false,\n      //   authorizeUrl: false,\n      //   redirectUri: window.location.href,\n      //   responseType: 'code'\n      // }, opts);\n\n      window.location.href = opts.authorizeUrl + '?client_id=' + opts.clientId + '&response_type=' + opts.responseType + '&redirect_uri=' + opts.redirectUri + '/';\n    },\n    user: function (url) {\n      jq.ajax({\n        type: \"get\",\n        url: url,\n        async: false,\n        data: {},\n        success: function (data) {\n          // data = { \"authorities\": [{ \"authority\": \"Operator\" }, { \"authority\": \"work\" }, { \"authority\": \"check\" }], \"details\": { \"remoteAddress\": \"10.11.5.80\", \"sessionId\": \"D588AAF1ED5633667F57AB8B4A16AEEC\" }, \"authenticated\": true, \"principal\": { \"userId\": 1080098857, \"username\": \"xiaofeili\", \"password\": \"22bcfcc40ae6ad8f4ff6a8c07c7f80f37d07ef635c379b86a58c50da\", \"showname\": \"xiaofeili\", \"officeCode\": null, \"roles\": [\"Operator\", \"work\"], \"authorities\": [{ \"authority\": \"Operator\" }, { \"authority\": \"work\" }], \"enabled\": true, \"credentialsNonExpired\": true, \"accountNonExpired\": true, \"accountNonLocked\": true }, \"credentials\": null, \"name\": \"auto_work1\" };\n          if (!data) {\n            oauth2Client.oAuthLoginPage();\n            return;\n          }\n\n          app.config.globalProperties.$user = data;\n        },\n        error: function () {\n          alert(\"当前登录用户为空，请检查当前地址是否正确\");\n          return;\n        }\n      });\n    },\n    oAuthLoginPage: function () {\n      oauth2Client.begin();\n    }\n  };\n  return oauth2Client;\n}","map":{"version":3,"sources":["D:/web_editor_hd/src/main/webapp/batch-edit/src/services/jquery.oauth2-client.js"],"names":["jq","oauth2Client","app","url","ouc","user","oauth2User","clientId","clientSecret","getNoHashUrl","window","location","href","split","begin","opts","authorizeUrl","redirectUri","responseType","ajax","type","async","data","success","oAuthLoginPage","config","globalProperties","$user","error","alert"],"mappings":"AAAA;AACA,OAAOA,EAAP,MAAe,QAAf,C,CACA;;AACA,OAAO,SAASC,YAAT,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgC;AACrC,MAAIF,YAAY,GAAG;AACjBG,IAAAA,GAAG,EAAE;AACHC,MAAAA,IAAI,EAAE,IADH;AAEHC,MAAAA,UAAU,EAAEH,GAFT;AAGHI,MAAAA,QAAQ,EAAE,QAHP;AAIHC,MAAAA,YAAY,EAAE;AAJX,KADY;AAOjBC,IAAAA,YAAY,EAAE,YAAW;AACvB,aAAOC,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAqBC,KAArB,CAA2B,GAA3B,EAAgC,CAAhC,CAAP;AACD,KATgB;AAUjBC,IAAAA,KAAK,EAAE,YAAW;AAChB,UAAIC,IAAI,GAAG;AACTC,QAAAA,YAAY,EAAEf,YAAY,CAACG,GAAb,CAAiBE,UAAjB,GAA8B,YADnC;AAETC,QAAAA,QAAQ,EAAEN,YAAY,CAACG,GAAb,CAAiBG,QAFlB;AAGTU,QAAAA,WAAW,EAAEhB,YAAY,CAACQ,YAAb,EAHJ;AAITS,QAAAA,YAAY,EAAE;AAJL,OAAX,CADgB,CAQhB;AACA;AACA;AACA;AACA;AACA;;AACAR,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuBG,IAAI,CAACC,YAAL,GAAoB,aAApB,GACrBD,IAAI,CAACR,QADgB,GACL,iBADK,GACeQ,IAAI,CAACG,YADpB,GAErB,gBAFqB,GAEFH,IAAI,CAACE,WAFH,GAEiB,GAFxC;AAGD,KA3BgB;AA4BjBZ,IAAAA,IAAI,EAAE,UAASF,GAAT,EAAc;AAClBH,MAAAA,EAAE,CAACmB,IAAH,CAAQ;AACNC,QAAAA,IAAI,EAAE,KADA;AAENjB,QAAAA,GAAG,EAAEA,GAFC;AAGNkB,QAAAA,KAAK,EAAE,KAHD;AAINC,QAAAA,IAAI,EAAE,EAJA;AAKNC,QAAAA,OAAO,EAAE,UAASD,IAAT,EAAe;AAEtB;AAEA,cAAI,CAACA,IAAL,EAAW;AACTrB,YAAAA,YAAY,CAACuB,cAAb;AACA;AACD;;AAEDtB,UAAAA,GAAG,CAACuB,MAAJ,CAAWC,gBAAX,CAA4BC,KAA5B,GAAoCL,IAApC;AAED,SAhBK;AAiBNM,QAAAA,KAAK,EAAE,YAAW;AAChBC,UAAAA,KAAK,CAAC,sBAAD,CAAL;AACA;AACD;AApBK,OAAR;AAsBD,KAnDgB;AAoDjBL,IAAAA,cAAc,EAAE,YAAW;AACzBvB,MAAAA,YAAY,CAACa,KAAb;AACD;AAtDgB,GAAnB;AA0DA,SAAOb,YAAP;AACD","sourcesContent":["/* eslint-disable prettier/prettier */\r\nimport jq from \"jquery\";\r\n// 获取最新配置\r\nexport function oauth2Client(app, url) {\r\n  var oauth2Client = {\r\n    ouc: {\r\n      user: null,\r\n      oauth2User: url,\r\n      clientId: \"client\",\r\n      clientSecret: \"secret\"\r\n    },\r\n    getNoHashUrl: function() {\r\n      return window.location.href.split(\"#\")[0];\r\n    },\r\n    begin: function() {\r\n      var opts = {\r\n        authorizeUrl: oauth2Client.ouc.oauth2User + \"/authorize\",\r\n        clientId: oauth2Client.ouc.clientId,\r\n        redirectUri: oauth2Client.getNoHashUrl(),\r\n        responseType: 'code'\r\n      }\r\n\r\n      // opts = jq.extend({\r\n      //   clientId: false,\r\n      //   authorizeUrl: false,\r\n      //   redirectUri: window.location.href,\r\n      //   responseType: 'code'\r\n      // }, opts);\r\n      window.location.href = opts.authorizeUrl + '?client_id=' +\r\n        opts.clientId + '&response_type=' + opts.responseType +\r\n        '&redirect_uri=' + opts.redirectUri + '/';\r\n    },\r\n    user: function(url) {\r\n      jq.ajax({\r\n        type: \"get\",\r\n        url: url,\r\n        async: false,\r\n        data: {},\r\n        success: function(data) {\r\n\r\n          // data = { \"authorities\": [{ \"authority\": \"Operator\" }, { \"authority\": \"work\" }, { \"authority\": \"check\" }], \"details\": { \"remoteAddress\": \"10.11.5.80\", \"sessionId\": \"D588AAF1ED5633667F57AB8B4A16AEEC\" }, \"authenticated\": true, \"principal\": { \"userId\": 1080098857, \"username\": \"xiaofeili\", \"password\": \"22bcfcc40ae6ad8f4ff6a8c07c7f80f37d07ef635c379b86a58c50da\", \"showname\": \"xiaofeili\", \"officeCode\": null, \"roles\": [\"Operator\", \"work\"], \"authorities\": [{ \"authority\": \"Operator\" }, { \"authority\": \"work\" }], \"enabled\": true, \"credentialsNonExpired\": true, \"accountNonExpired\": true, \"accountNonLocked\": true }, \"credentials\": null, \"name\": \"auto_work1\" };\r\n\r\n          if (!data) {\r\n            oauth2Client.oAuthLoginPage();\r\n            return;\r\n          }\r\n\r\n          app.config.globalProperties.$user = data;\r\n\r\n        },\r\n        error: function() {\r\n          alert(\"当前登录用户为空，请检查当前地址是否正确\");\r\n          return;\r\n        },\r\n      });\r\n    },\r\n    oAuthLoginPage: function() {\r\n      oauth2Client.begin();\r\n    }\r\n\r\n  };\r\n\r\n  return oauth2Client;\r\n}"]},"metadata":{},"sourceType":"module"}