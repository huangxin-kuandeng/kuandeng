{"ast":null,"code":"/* eslint-disable prettier/prettier */\nimport jq from \"jquery\"; // 获取最新配置\n\nexport function oauth2Client(app, url) {\n  var oauth2Client = {\n    ouc: {\n      user: null,\n      oauth2User: url,\n      clientId: \"client\",\n      clientSecret: \"secret\"\n    },\n    getNoHashUrl: function () {\n      return window.location.href.split(\"#\")[0];\n    },\n    begin: function (opts) {\n      opts = jq.extend({\n        clientId: false,\n        authorizeUrl: false,\n        redirectUri: window.location.href,\n        responseType: 'code'\n      }, opts);\n      window.location.href = opts.authorizeUrl + '?client_id=' + opts.clientId + '&response_type=' + opts.responseType + '&redirect_uri=' + opts.redirectUri;\n    },\n    user: function (url) {\n      jq.ajax({\n        type: \"get\",\n        url: url,\n        async: false,\n        data: {},\n        success: function (data) {\n          data = {\n            \"authorities\": [{\n              \"authority\": \"Operator\"\n            }, {\n              \"authority\": \"work\"\n            }, {\n              \"authority\": \"check\"\n            }],\n            \"details\": {\n              \"remoteAddress\": \"10.11.5.80\",\n              \"sessionId\": \"D588AAF1ED5633667F57AB8B4A16AEEC\"\n            },\n            \"authenticated\": true,\n            \"principal\": {\n              \"userId\": 1080098857,\n              \"username\": \"xiaofeili\",\n              \"password\": \"22bcfcc40ae6ad8f4ff6a8c07c7f80f37d07ef635c379b86a58c50da\",\n              \"showname\": \"xiaofeili\",\n              \"officeCode\": null,\n              \"roles\": [\"Operator\", \"work\"],\n              \"authorities\": [{\n                \"authority\": \"Operator\"\n              }, {\n                \"authority\": \"work\"\n              }],\n              \"enabled\": true,\n              \"credentialsNonExpired\": true,\n              \"accountNonExpired\": true,\n              \"accountNonLocked\": true\n            },\n            \"credentials\": null,\n            \"name\": \"xiaofeili\"\n          };\n\n          if (!data) {\n            oauth2Client.oAuthLoginPage();\n            return;\n          }\n\n          app.config.globalProperties.$user = data;\n        },\n        error: function () {\n          alert(\"当前登录用户为空，请检查当前地址是否正确\");\n          return;\n        }\n      });\n    },\n    signout: function () {\n      jq.ajax({\n        type: \"get\",\n        url: oauth2Client.ouc.oauth2User + \"logout\",\n        async: false,\n        data: {},\n        success: function () {\n          window.location.reload();\n        },\n        error: function () {\n          console.log(\"当前登录用户为空，请检查当前地址是否正确\");\n        }\n      });\n    },\n    oAuthLoginPage: function () {\n      oauth2Client.begin({\n        authorizeUrl: oauth2Client.ouc.oauth2User + \"/authorize\",\n        clientId: oauth2Client.ouc.clientId,\n        redirectUri: oauth2Client.getNoHashUrl()\n      });\n    }\n  };\n  return oauth2Client;\n}","map":{"version":3,"sources":["D:/web_editor_hd/src/main/webapp/batch-edit/src/services/jquery.oauth2-client.js"],"names":["jq","oauth2Client","app","url","ouc","user","oauth2User","clientId","clientSecret","getNoHashUrl","window","location","href","split","begin","opts","extend","authorizeUrl","redirectUri","responseType","ajax","type","async","data","success","oAuthLoginPage","config","globalProperties","$user","error","alert","signout","reload","console","log"],"mappings":"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","sourcesContent":["/* eslint-disable prettier/prettier */\r\nimport jq from \"jquery\";\r\n// 获取最新配置\r\nexport function oauth2Client(app, url) {\r\n  var oauth2Client = {\r\n    ouc: {\r\n      user: null,\r\n      oauth2User: url,\r\n      clientId: \"client\",\r\n      clientSecret: \"secret\"\r\n    },\r\n    getNoHashUrl: function() {\r\n      return window.location.href.split(\"#\")[0];\r\n    },\r\n    begin: function(opts) {\r\n      opts = jq.extend({\r\n        clientId: false,\r\n        authorizeUrl: false,\r\n        redirectUri: window.location.href,\r\n        responseType: 'code'\r\n      }, opts);\r\n      window.location.href = opts.authorizeUrl + '?client_id=' +\r\n        opts.clientId + '&response_type=' + opts.responseType +\r\n        '&redirect_uri=' + opts.redirectUri;\r\n    },\r\n    user: function(url) {\r\n      jq.ajax({\r\n        type: \"get\",\r\n        url: url,\r\n        async: false,\r\n        data: {},\r\n        success: function(data) {\r\n\r\n          data = { \"authorities\": [{ \"authority\": \"Operator\" }, { \"authority\": \"work\" }, { \"authority\": \"check\" }], \"details\": { \"remoteAddress\": \"10.11.5.80\", \"sessionId\": \"D588AAF1ED5633667F57AB8B4A16AEEC\" }, \"authenticated\": true, \"principal\": { \"userId\": 1080098857, \"username\": \"xiaofeili\", \"password\": \"22bcfcc40ae6ad8f4ff6a8c07c7f80f37d07ef635c379b86a58c50da\", \"showname\": \"xiaofeili\", \"officeCode\": null, \"roles\": [\"Operator\", \"work\"], \"authorities\": [{ \"authority\": \"Operator\" }, { \"authority\": \"work\" }], \"enabled\": true, \"credentialsNonExpired\": true, \"accountNonExpired\": true, \"accountNonLocked\": true }, \"credentials\": null, \"name\": \"xiaofeili\" };\r\n\r\n          if (!data) {\r\n            oauth2Client.oAuthLoginPage();\r\n            return;\r\n          }\r\n\r\n          app.config.globalProperties.$user = data;\r\n\r\n        },\r\n        error: function() {\r\n          alert(\"当前登录用户为空，请检查当前地址是否正确\");\r\n          return;\r\n        },\r\n      });\r\n    },\r\n    signout: function() {\r\n      jq.ajax({\r\n        type: \"get\",\r\n        url: oauth2Client.ouc.oauth2User + \"logout\",\r\n        async: false,\r\n        data: {},\r\n        success: function() {\r\n          window.location.reload();\r\n        },\r\n        error: function() {\r\n          console.log(\"当前登录用户为空，请检查当前地址是否正确\");\r\n        },\r\n      })\r\n    },\r\n    oAuthLoginPage: function() {\r\n      oauth2Client.begin({\r\n        authorizeUrl: oauth2Client.ouc.oauth2User + \"/authorize\",\r\n        clientId: oauth2Client.ouc.clientId,\r\n        redirectUri: oauth2Client.getNoHashUrl()\r\n      });\r\n    }\r\n\r\n  };\r\n\r\n  return oauth2Client;\r\n}"]},"metadata":{},"sourceType":"module"}