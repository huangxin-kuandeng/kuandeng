{"ast":null,"code":"import * as sysApi from \"../../services/sys\";\nimport * as util from \"../../services/util\";\nexport default {\n  name: \"contentSearch\",\n\n  data() {\n    return {\n      form: {\n        region: \"shanghai\",\n        name: \"1111\",\n        isPass: \"true\"\n      },\n      modal: false,\n      centerDialogVisible1: false,\n      centerDialogVisible2: false,\n      cities: [],\n      value: \"\",\n      finishText: \"编辑完成\"\n    };\n  },\n\n  mounted() {\n    var role = util.isRoleAuth(this.$user);\n\n    if ([1, 3].includes(role)) {\n      this.finishText = \"编辑完成\";\n    }\n\n    if ([2, 3].includes(role)) {\n      this.finishText = \"质检完成\";\n    }\n  },\n\n  methods: {\n    form() {\n      this.$emit(\"refreshForm\");\n    },\n\n    refresh() {\n      this.$emit(\"refresh\");\n    },\n\n    save() {\n      this.$emit(\"finish\");\n    },\n\n    finish() {\n      if (!window.currentTask) {\n        return;\n      }\n\n      if (this.finishText == \"编辑完成\") {\n        this.centerDialogVisible2 = true;\n      } else {\n        this.centerDialogVisible2 = true;\n      }\n    },\n\n    finishToProcess(isPass) {\n      // 0：正在启动， 1：无需启动检查服务\n      if (isPass == \"0\") {\n        this.centerDialogVisible1 = false;\n        this.centerDialogVisible2 = false;\n        this.$emit(\"remakeTask\");\n      } else if (isPass == \"1\") {\n        this.processPassStatus(true);\n      }\n    },\n\n    processPassStatus(isPass) {\n      var $this = this;\n      var _checkData = {\n        taskId: \"\" + window.currentTask.id,\n        properties: [{\n          id: \"passFlag\",\n          value: isPass + \"\"\n        }]\n      };\n      var $url = $this.$config.kts + \"form/form-data\";\n      sysApi.postAsyncDatas({\n        url: $url,\n        data: _checkData\n      }).then(res => {\n        console.log(res);\n        $this.centerDialogVisible1 = false;\n        $this.centerDialogVisible2 = false;\n        $this.$emit(\"remakeTask\");\n      });\n    },\n\n    // 完成时,先调用检查\n    autoCheckStatus() {\n      var $this = this;\n      var bodyParam = {\n        activityId: window.currentTask.formatTags.currentActivity,\n        //工作流ID (tag中的currentActivity的值）环节名称\n        taskId: window.currentTask.taskId\n      };\n      var $url = $this.$config.kts + \"dispatch/job/start\";\n      sysApi.postAsyncDatas({\n        url: $url,\n        data: bodyParam\n      }).then(res => {\n        if (res.code != \"0\") {\n          $this.$notify({\n            title: \"检查服务\",\n            message: \"启动检查服务失败: \" + res.message,\n            type: \"warning\"\n          });\n          $this.centerDialogVisible1 = false;\n          $this.centerDialogVisible2 = false;\n          return;\n        }\n\n        $this.finishToProcess(res.result);\n      });\n    }\n\n  }\n};","map":{"version":3,"sources":["D:\\web_editor_hd\\src\\main\\webapp\\batch-edit\\src\\components\\contentComponents\\contentSearch.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <el-dialog title=\"信息确认\" v-model=\"centerDialogVisible2\" width=\"300px\">\n    <el-form :model=\"form\">\n      <el-form-item label=\"活动名称\" label-width=\"100px\">\n        <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"活动区域\" label-width=\"100px\">\n        <el-select\n          v-model=\"form.region\"\n          placeholder=\"请选择活动区域\"\n          popper-class=\"isPassSelect\"\n        >\n          <el-option label=\"区域一\" value=\"shanghai\"></el-option>\n          <el-option label=\"区域二\" value=\"beijing\"></el-option>\n        </el-select>\n      </el-form-item>\n    </el-form>\n    <template #footer2>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"centerDialogVisible2 = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"centerDialogVisible2 = false\"\n          >确 定</el-button\n        >\n      </span>\n    </template>\n  </el-dialog>\n  <div class=\"contentSearch\">\n    <el-button-group>\n      <el-button class=\"btn-form\" icon=\"el-icon-search\" @click=\"form()\"\n        >报表</el-button\n      >\n      <el-button class=\"btn-refresh\" icon=\"el-icon-refresh\" @click=\"refresh()\"\n        >刷新</el-button\n      >\n      <el-button\n        class=\"btn-save\"\n        icon=\"el-icon-document-checked\"\n        @click=\"save()\"\n        >保存</el-button\n      >\n      <el-button\n        class=\"btn-finish\"\n        icon=\"el-icon-folder-checked\"\n        @click=\"finish\"\n        >{{ finishText }}</el-button\n      >\n    </el-button-group>\n  </div>\n</template>\n\n<script>\nimport * as sysApi from \"../../services/sys\";\nimport * as util from \"../../services/util\";\nexport default {\n  name: \"contentSearch\",\n  data() {\n    return {\n      form: {\n        region: \"shanghai\",\n        name: \"1111\",\n        isPass: \"true\",\n      },\n      modal: false,\n      centerDialogVisible1: false,\n      centerDialogVisible2: false,\n      cities: [],\n      value: \"\",\n      finishText: \"编辑完成\",\n    };\n  },\n  mounted() {\n    var role = util.isRoleAuth(this.$user);\n    if ([1, 3].includes(role)) {\n      this.finishText = \"编辑完成\";\n    }\n    if ([2, 3].includes(role)) {\n      this.finishText = \"质检完成\";\n    }\n  },\n  methods: {\n    form() {\n      this.$emit(\"refreshForm\");\n    },\n    refresh() {\n      this.$emit(\"refresh\");\n    },\n    save() {\n      this.$emit(\"finish\");\n    },\n    finish() {\n      if (!window.currentTask) {\n        return;\n      }\n      if (this.finishText == \"编辑完成\") {\n        this.centerDialogVisible2 = true;\n      } else {\n        this.centerDialogVisible2 = true;\n      }\n    },\n    finishToProcess(isPass) {\n      // 0：正在启动， 1：无需启动检查服务\n      if (isPass == \"0\") {\n        this.centerDialogVisible1 = false;\n        this.centerDialogVisible2 = false;\n        this.$emit(\"remakeTask\");\n      } else if (isPass == \"1\") {\n        this.processPassStatus(true);\n      }\n    },\n    processPassStatus(isPass) {\n      var $this = this;\n      var _checkData = {\n        taskId: \"\" + window.currentTask.id,\n        properties: [\n          {\n            id: \"passFlag\",\n            value: isPass + \"\",\n          },\n        ],\n      };\n      var $url = $this.$config.kts + \"form/form-data\";\n      sysApi\n        .postAsyncDatas({\n          url: $url,\n          data: _checkData,\n        })\n        .then((res) => {\n          console.log(res);\n          $this.centerDialogVisible1 = false;\n          $this.centerDialogVisible2 = false;\n          $this.$emit(\"remakeTask\");\n        });\n    },\n    // 完成时,先调用检查\n    autoCheckStatus() {\n      var $this = this;\n      var bodyParam = {\n        activityId: window.currentTask.formatTags.currentActivity, //工作流ID (tag中的currentActivity的值）环节名称\n        taskId: window.currentTask.taskId,\n      };\n      var $url = $this.$config.kts + \"dispatch/job/start\";\n      sysApi\n        .postAsyncDatas({\n          url: $url,\n          data: bodyParam,\n        })\n        .then((res) => {\n          if (res.code != \"0\") {\n            $this.$notify({\n              title: \"检查服务\",\n              message: \"启动检查服务失败: \" + res.message,\n              type: \"warning\",\n            });\n            $this.centerDialogVisible1 = false;\n            $this.centerDialogVisible2 = false;\n            return;\n          }\n          $this.finishToProcess(res.result);\n        });\n    },\n  },\n};\n</script>\n\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style lang=\"scss\">\n.contentSearch {\n  height: 40px;\n  float: left;\n  padding: 5px 10px;\n  position: absolute;\n  right: 0px;\n  z-index: 99;\n}\n.contentSearch button {\n  float: left;\n  padding: 0px 15px;\n  min-height: 30px;\n  height: 30px;\n  line-height: 30px;\n  width: auto;\n}\n.contentSearch .el-button-group {\n  float: left;\n  margin-left: 20px;\n}\n.contentSearch .el-button-group:last-child {\n  float: right;\n  margin-left: 0px;\n}\n.el-overlay {\n  z-index: 8999 !important;\n}\n.is-fullscreen {\n  z-index: 8999 !important;\n}\n.isPassSelect.el-popper {\n  z-index: 9111 !important;\n}\n</style>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}